import{b as e,h as t,d as r,c as i,u as a,g as n,a as l,i as s,e as o,r as d,t as c,S as p,s as g,F as u,j as b,f as m}from"./web.BsTFG2N9.js";import{d as f,a as x,e as v,c as h,b as y}from"./cart.Cfxr-fc8.js";import{b as S,c as w,f as C,i as $,d as z}from"./utils.CDcRrbXb.js";import{I as k}from"./Icon.4pfrFdzL.js";import{m as j,p as T,a as q}from"./phone.2x7todBY.js";import{m as _}from"./message-circle.Ds_6WdqE.js";import"./store.4IFrkIZ1.js";var E=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],P=r=>e(k,t(r,{name:"User",iconNode:E})),A=c('<p class="text-sm text-red-500 mt-1">'),O=c('<div class="grid grid-cols-1 lg:grid-cols-3 gap-8"><div class=lg:col-span-2><div class="checkout-form-wrapper bg-white rounded-xl shadow-card p-6 md:p-8"><h2 class="text-2xl font-display font-bold text-gray-900 mb-6">Informações de Contato</h2><form class=space-y-6><div><label for=name class="block text-sm font-medium text-gray-700 mb-2">Nome Completo *</label><div class=relative><input type=text id=name placeholder="João Silva"required><!$><!/></div><!$><!/></div><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label for=email class="block text-sm font-medium text-gray-700 mb-2">Email *</label><div class=relative><input type=email id=email placeholder=joao@email.com required><!$><!/></div><!$><!/></div><div><label for=phone class="block text-sm font-medium text-gray-700 mb-2">Telefone / WhatsApp *</label><div class=relative><input type=tel id=phone placeholder="(11) 98765-4321"required><!$><!/></div><!$><!/></div></div><div><label for=address class="block text-sm font-medium text-gray-700 mb-2">Endereço Completo *</label><div class=relative><input type=text id=address placeholder="Rua, número, complemento"required><!$><!/></div><!$><!/></div><div class="grid grid-cols-2 md:grid-cols-3 gap-4"><div class="col-span-2 md:col-span-1"><label for=city class="block text-sm font-medium text-gray-700 mb-2">Cidade *</label><input type=text id=city placeholder="São Paulo"required><!$><!/></div><div><label for=state class="block text-sm font-medium text-gray-700 mb-2">Estado *</label><input type=text id=state placeholder=SP maxlength=2 required><!$><!/></div><div><label for=zip class="block text-sm font-medium text-gray-700 mb-2">CEP *</label><input type=text id=zip placeholder=00000-000 required><!$><!/></div></div><div><label for=notes class="block text-sm font-medium text-gray-700 mb-2">Observações (opcional)</label><textarea id=notes rows=4 class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"placeholder="Informações adicionais sobre o pedido..."></textarea></div><button type=submit></button><p class="text-sm text-gray-600 text-center">Ao finalizar, você será redirecionado para o WhatsApp para confirmar seu pedido</p></form></div></div><div class=lg:col-span-1><div class="checkout-summary-wrapper bg-white rounded-xl shadow-card p-6 sticky top-24"><h2 class="text-xl font-display font-bold text-gray-900 mb-4">Resumo do Pedido</h2><div class="space-y-3 mb-4 max-h-64 overflow-y-auto"></div><div class="border-t border-gray-200 pt-4 space-y-2"><div class="flex items-center justify-between text-gray-600"><span>Subtotal (<!$><!/> itens)</span><span></span></div><div class="flex items-center justify-between text-lg font-bold text-gray-900 pt-2"><span>Total</span><span></span></div></div><div class="mt-4 p-3 bg-blue-50 rounded-lg"><p class="text-xs text-blue-800"><strong>Nota:</strong> O valor final e prazo de entrega serão confirmados via WhatsApp após análise do pedido.'),I=c('<p class="text-xs text-gray-600">'),N=c('<div class="flex gap-3"><img class="w-16 h-16 object-cover rounded-lg bg-gray-100"><div class="flex-1 min-w-0"><h4 class="text-sm font-medium text-gray-900 line-clamp-2"></h4><!$><!/><div class="flex items-center justify-between mt-1"><span class="text-xs text-gray-600">Qtd: <!$><!/></span><span class="text-sm font-semibold text-gray-900">');function W(){const[t,r]=i({name:"",email:"",phone:"",address:"",city:"",state:"",zip:"",notes:""}),[c,k]=i({}),[E,W]=i(!1);a(()=>{y()&&(window.location.href="/carrinho")});const D=(e,i)=>{r({...t(),[e]:i}),c()[e]&&k({...c(),[e]:""})},F=async e=>{if(e.preventDefault(),(()=>{const e={},r=t();return(!r.name||r.name.length<3)&&(e.name="Nome completo é obrigatório"),r.email&&$(r.email)||(e.email="Email válido é obrigatório"),r.phone&&z(r.phone)||(e.phone="Telefone válido é obrigatório (com DDD)"),r.address||(e.address="Endereço é obrigatório"),r.city||(e.city="Cidade é obrigatória"),r.state||(e.state="Estado é obrigatório"),r.zip||(e.zip="CEP é obrigatório"),k(e),0===Object.keys(e).length})()){W(!0);try{const e=await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customer:t(),items:f.items})});if(!e.ok)throw new Error("Erro ao criar pedido");const r=await e.json(),i="5596981247830",a=`${window.location.origin}/pedido/${r.order_number}`,n=f.items.map(e=>({name:e.product_name,quantity:e.quantity,price:e.unit_price*e.quantity})),l=S(r.order_number,t().name,n,x(),a),s=w(i,l);v(),window.open(s,"_blank"),setTimeout(()=>{window.location.href=`/pedido/${r.order_number}`},1e3)}catch(r){alert("Ocorreu um erro ao finalizar o pedido. Por favor, tente novamente ou entre em contato conosco via WhatsApp."),W(!1)}}};return(()=>{var r=n(O),i=r.firstChild,a=i.firstChild.firstChild.nextSibling,v=a.firstChild,y=v.firstChild.nextSibling,S=y.firstChild,w=S.nextSibling,[$,z]=l(w.nextSibling),k=y.nextSibling,[W,J]=l(k.nextSibling),R=v.nextSibling,G=R.firstChild,H=G.firstChild.nextSibling,L=H.firstChild,M=L.nextSibling,[Q,U]=l(M.nextSibling),B=H.nextSibling,[K,V]=l(B.nextSibling),X=G.nextSibling,Y=X.firstChild.nextSibling,Z=Y.firstChild,ee=Z.nextSibling,[te,re]=l(ee.nextSibling),ie=Y.nextSibling,[ae,ne]=l(ie.nextSibling),le=R.nextSibling,se=le.firstChild.nextSibling,oe=se.firstChild,de=oe.nextSibling,[ce,pe]=l(de.nextSibling),ge=se.nextSibling,[ue,be]=l(ge.nextSibling),me=le.nextSibling,fe=me.firstChild,xe=fe.firstChild.nextSibling,ve=xe.nextSibling,[he,ye]=l(ve.nextSibling),Se=fe.nextSibling,we=Se.firstChild.nextSibling,Ce=we.nextSibling,[$e,ze]=l(Ce.nextSibling),ke=Se.nextSibling,je=ke.firstChild.nextSibling,Te=je.nextSibling,[qe,_e]=l(Te.nextSibling),Ee=me.nextSibling,Pe=Ee.firstChild.nextSibling,Ae=Ee.nextSibling,Oe=i.nextSibling.firstChild.firstChild.nextSibling,Ie=Oe.nextSibling.firstChild,Ne=Ie.firstChild,We=Ne.firstChild.nextSibling,[De,Fe]=l(We.nextSibling);De.nextSibling;var Je=Ne.nextSibling,Re=Ie.nextSibling.firstChild.nextSibling;return a.addEventListener("submit",F),S.$$input=e=>D("name",e.currentTarget.value),s(y,e(P,{class:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),$,z),s(v,e(p,{get when(){return c().name},get children(){var e=n(A);return s(e,()=>c().name),e}}),W,J),L.$$input=e=>D("email",e.currentTarget.value),s(H,e(j,{class:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),Q,U),s(G,e(p,{get when(){return c().email},get children(){var e=n(A);return s(e,()=>c().email),e}}),K,V),Z.$$input=e=>D("phone",e.currentTarget.value),s(Y,e(T,{class:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),te,re),s(X,e(p,{get when(){return c().phone},get children(){var e=n(A);return s(e,()=>c().phone),e}}),ae,ne),oe.$$input=e=>D("address",e.currentTarget.value),s(se,e(q,{class:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),ce,pe),s(le,e(p,{get when(){return c().address},get children(){var e=n(A);return s(e,()=>c().address),e}}),ue,be),xe.$$input=e=>D("city",e.currentTarget.value),s(fe,e(p,{get when(){return c().city},get children(){var e=n(A);return s(e,()=>c().city),e}}),he,ye),we.$$input=e=>D("state",e.currentTarget.value),s(Se,e(p,{get when(){return c().state},get children(){var e=n(A);return s(e,()=>c().state),e}}),$e,ze),je.$$input=e=>D("zip",e.currentTarget.value),s(ke,e(p,{get when(){return c().zip},get children(){var e=n(A);return s(e,()=>c().zip),e}}),qe,_e),Pe.$$input=e=>D("notes",e.currentTarget.value),s(Ae,e(p,{get when(){return!E()},fallback:"Processando...",get children(){return[e(_,{size:24}),"Finalizar via WhatsApp"]}})),s(Oe,e(u,{get each(){return f.items},children:t=>(()=>{var r=n(N),i=r.firstChild,a=i.nextSibling,d=a.firstChild,c=d.nextSibling,[u,b]=l(c.nextSibling),m=u.nextSibling.firstChild,f=m.firstChild.nextSibling,[x,v]=l(f.nextSibling),h=m.nextSibling;return s(d,()=>t.product_name),s(a,e(p,{get when(){return t.variation_color},get children(){var e=n(I);return s(e,()=>t.variation_color),e}}),u,b),s(m,()=>t.quantity,x,v),s(h,()=>C(t.unit_price*t.quantity)),o(e=>{var r=t.product_image||"https://placehold.co/100x100/f3f4f6/9ca3af?text=Sem+Imagem",a=t.product_name;return r!==e.e&&g(i,"src",e.e=r),a!==e.t&&g(i,"alt",e.t=a),e},{e:void 0,t:void 0}),r})()})),s(Ne,h,De,Fe),s(Je,()=>C(x())),s(Re,()=>C(x())),o(e=>{var t="w-full pl-10 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent "+(c().name?"border-red-500":"border-gray-300"),r="w-full pl-10 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent "+(c().email?"border-red-500":"border-gray-300"),i="w-full pl-10 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent "+(c().phone?"border-red-500":"border-gray-300"),a="w-full pl-10 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent "+(c().address?"border-red-500":"border-gray-300"),n="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent "+(c().city?"border-red-500":"border-gray-300"),l="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent "+(c().state?"border-red-500":"border-gray-300"),s="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent "+(c().zip?"border-red-500":"border-gray-300"),o=E(),d="w-full btn-primary text-lg "+(E()?"opacity-50 cursor-not-allowed":"");return t!==e.e&&b(S,e.e=t),r!==e.t&&b(L,e.t=r),i!==e.a&&b(Z,e.a=i),a!==e.o&&b(oe,e.o=a),n!==e.i&&b(xe,e.i=n),l!==e.n&&b(we,e.n=l),s!==e.s&&b(je,e.s=s),o!==e.h&&m(Ae,"disabled",e.h=o),d!==e.r&&b(Ae,e.r=d),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),o(()=>m(S,"value",t().name)),o(()=>m(L,"value",t().email)),o(()=>m(Z,"value",t().phone)),o(()=>m(oe,"value",t().address)),o(()=>m(xe,"value",t().city)),o(()=>m(we,"value",t().state)),o(()=>m(je,"value",t().zip)),o(()=>m(Pe,"value",t().notes)),d(),r})()}r(["input"]);export{W as default};
