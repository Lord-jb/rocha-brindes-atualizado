import{$ as t,o as e,p as r,c as n,q as o}from"./web.BsTFG2N9.js";const l=Symbol("store-raw"),i=Symbol("store-node"),c=Symbol("store-has"),f=Symbol("store-self");function s(e){let r=e[t];if(!r&&(Object.defineProperty(e,t,{value:r=new Proxy(e,b)}),!Array.isArray(e))){const t=Object.keys(e),n=Object.getOwnPropertyDescriptors(e);for(let o=0,l=t.length;o<l;o++){const l=t[o];n[l].get&&Object.defineProperty(e,l,{enumerable:n[l].enumerable,get:n[l].get.bind(r)})}}return r}function u(e){let r;return null!=e&&"object"==typeof e&&(e[t]||!(r=Object.getPrototypeOf(e))||r===Object.prototype||Array.isArray(e))}function a(t,e=new Set){let r,n,o,i;if(r=null!=t&&t[l])return r;if(!u(t)||e.has(t))return t;if(Array.isArray(t)){Object.isFrozen(t)?t=t.slice(0):e.add(t);for(let r=0,l=t.length;r<l;r++)o=t[r],(n=a(o,e))!==o&&(t[r]=n)}else{Object.isFrozen(t)?t=Object.assign({},t):e.add(t);const r=Object.keys(t),l=Object.getOwnPropertyDescriptors(t);for(let c=0,f=r.length;c<f;c++)i=r[c],l[i].get||(o=t[i],(n=a(o,e))!==o&&(t[i]=n))}return t}function g(t,e){let r=t[e];return r||Object.defineProperty(t,e,{value:r=Object.create(null)}),r}function y(t,e,r){if(t[e])return t[e];const[o,l]=n(r,{equals:!1,internal:!0});return o.$=l,t[e]=o}function h(t){o()&&y(g(t,i),f)()}const b={get(e,n,f){if(n===l)return e;if(n===t)return f;if(n===r)return h(e),f;const a=g(e,i),b=a[n];let p=b?b():e[n];if(n===i||n===c||"__proto__"===n)return p;if(!b){const t=Object.getOwnPropertyDescriptor(e,n);!o()||"function"==typeof p&&!e.hasOwnProperty(n)||t&&t.get||(p=y(a,n,p)())}return u(p)?s(p):p},has:(e,n)=>n===l||n===t||n===r||n===i||n===c||"__proto__"===n||(o()&&y(g(e,c),n)(),n in e),set:()=>!0,deleteProperty:()=>!0,ownKeys:function(t){return h(t),Reflect.ownKeys(t)},getOwnPropertyDescriptor:function(e,r){const n=Reflect.getOwnPropertyDescriptor(e,r);return n&&!n.get&&n.configurable&&r!==t&&r!==i?(delete n.value,delete n.writable,n.get=()=>e[t][r],n):n}};function p(t,e,r,n=!1){if(!n&&t[e]===r)return;const o=t[e],l=t.length;void 0===r?(delete t[e],t[c]&&t[c][e]&&void 0!==o&&t[c][e].$()):(t[e]=r,t[c]&&t[c][e]&&void 0===o&&t[c][e].$());let s,u=g(t,i);if((s=y(u,e,o))&&s.$(()=>r),Array.isArray(t)&&t.length!==l){for(let e=t.length;e<l;e++)(s=u[e])&&s.$();(s=y(u,"length",l))&&s.$(t.length)}(s=u[f])&&s.$()}function d(t,e){const r=Object.keys(e);for(let n=0;n<r.length;n+=1){const o=r[n];p(t,o,e[o])}}function A(t,e,r=[]){let n,o=t;if(e.length>1){n=e.shift();const l=typeof n,i=Array.isArray(t);if(Array.isArray(n)){for(let o=0;o<n.length;o++)A(t,[n[o]].concat(e),r);return}if(i&&"function"===l){for(let o=0;o<t.length;o++)n(t[o],o)&&A(t,[o].concat(e),r);return}if(i&&"object"===l){const{from:o=0,to:l=t.length-1,by:i=1}=n;for(let n=o;n<=l;n+=i)A(t,[n].concat(e),r);return}if(e.length>1)return void A(t[n],e,[n].concat(r));o=t[n],r=[n].concat(r)}let l=e[0];"function"==typeof l&&(l=l(o,r),l===o)||void 0===n&&null==l||(l=a(l),void 0===n||u(o)&&u(l)&&!Array.isArray(l)?d(o,l):p(t,n,l))}function O(...[t,r]){const n=a(t||{}),o=Array.isArray(n);return[s(n),function(...t){e(()=>{o&&1===t.length?function(t,e){if("function"==typeof e&&(e=e(t)),e=a(e),Array.isArray(e)){if(t===e)return;let r=0,n=e.length;for(;r<n;r++){const n=e[r];t[r]!==n&&p(t,r,n)}p(t,"length",n)}else d(t,e)}(n,t[0]):A(n,t)})}]}const j=Symbol("store-root");function v(t,e,r,n,o){const l=e[r];if(t===l)return;const i=Array.isArray(t);if(r!==j&&(!u(t)||!u(l)||i!==Array.isArray(l)||o&&t[o]!==l[o]))return void p(e,r,t);if(i){if(t.length&&l.length&&(!n||o&&t[0]&&null!=t[0][o])){let e,r,i,c,f,s,u,a;for(i=0,c=Math.min(l.length,t.length);i<c&&(l[i]===t[i]||o&&l[i]&&t[i]&&l[i][o]&&l[i][o]===t[i][o]);i++)v(t[i],l,i,n,o);const g=new Array(t.length),y=new Map;for(c=l.length-1,f=t.length-1;c>=i&&f>=i&&(l[c]===t[f]||o&&l[c]&&t[f]&&l[c][o]&&l[c][o]===t[f][o]);c--,f--)g[f]=l[c];if(i>f||i>c){for(r=i;r<=f;r++)p(l,r,t[r]);for(;r<t.length;r++)p(l,r,g[r]),v(t[r],l,r,n,o);return void(l.length>t.length&&p(l,"length",t.length))}for(u=new Array(f+1),r=f;r>=i;r--)s=t[r],a=o&&s?s[o]:s,e=y.get(a),u[r]=void 0===e?-1:e,y.set(a,r);for(e=i;e<=c;e++)s=l[e],a=o&&s?s[o]:s,r=y.get(a),void 0!==r&&-1!==r&&(g[r]=l[e],r=u[r],y.set(a,r));for(r=i;r<t.length;r++)r in g?(p(l,r,g[r]),v(t[r],l,r,n,o)):p(l,r,t[r])}else for(let e=0,r=t.length;e<r;e++)v(t[e],l,e,n,o);return void(l.length>t.length&&p(l,"length",t.length))}const c=Object.keys(t);for(let s=0,u=c.length;s<u;s++)v(t[c[s]],l,c[s],n,o);const f=Object.keys(l);for(let s=0,u=f.length;s<u;s++)void 0===t[f[s]]&&p(l,f[s],void 0)}function w(t,e={}){const{merge:r,key:n="id"}=e,o=a(t);return t=>{if(!u(t)||!u(o))return o;const e=v(o,{[j]:t},j,r,n);return void 0===e?t:e}}export{O as c,w as r};
