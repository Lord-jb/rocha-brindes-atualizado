import{u as R,c as q,b as C,o as D}from"./chevron-right.BA9S0OXS.js";import{c as I,g as z,q as _,l as E,e as j,f as N,b,d as O,j as f}from"./Providers.BXE0NgEa.js";function F(n=6){return R({queryKey:["catalog",n],queryFn:async()=>{const[l,t,r]=await Promise.all([I(_(N(b,"produtos"),j("createdAt","desc"),E(n))),I(_(N(b,"categorias"),j("nome"))),z(O(b,"config","layout"))]),a=l.docs.map(d=>({id:d.id,...d.data()})),e=t.docs.map(d=>({id:d.id,...d.data()})),i=r.exists()?r.data():{},h={logo:i.logo||"",banners:(i.banners||[]).map(d=>({url:d,alt:"Banner Rocha Brindes"})),promotions:i.promotions||[],popups:i.popups||[],whatsapp:i.whatsapp,companyInfo:i.companyInfo};return{products:a,categories:e,layout:h}},staleTime:600*1e3,gcTime:1800*1e3,placeholderData:J()})}function J(){if(!(typeof window>"u"))try{const n=localStorage.getItem("catalog-cache");if(n){const l=JSON.parse(n);if(Date.now()-l.timestamp<600*1e3)return l.catalog}}catch{return}}function Z(n){if(!(typeof window>"u"))try{localStorage.setItem("catalog-cache",JSON.stringify({catalog:n,timestamp:Date.now()}))}catch{console.warn("Failed to cache catalog")}}const M={};function B(n,l){let t;try{t=n()}catch{return}return{getItem:a=>{var e;const i=d=>d===null?null:JSON.parse(d,void 0),h=(e=t.getItem(a))!=null?e:null;return h instanceof Promise?h.then(i):i(h)},setItem:(a,e)=>t.setItem(a,JSON.stringify(e,void 0)),removeItem:a=>t.removeItem(a)}}const x=n=>l=>{try{const t=n(l);return t instanceof Promise?t:{then(r){return x(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return x(r)(t)}}}},L=(n,l)=>(t,r,a)=>{let e={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:s=>s,version:0,merge:(s,u)=>({...u,...s}),...l},i=!1;const h=new Set,d=new Set;let m;try{m=e.getStorage()}catch{}if(!m)return n((...s)=>{console.warn(`[zustand persist middleware] Unable to update item '${e.name}', the given storage is currently unavailable.`),t(...s)},r,a);const w=x(e.serialize),S=()=>{const s=e.partialize({...r()});let u;const o=w({state:s,version:e.version}).then(g=>m.setItem(e.name,g)).catch(g=>{u=g});if(u)throw u;return o},v=a.setState;a.setState=(s,u)=>{v(s,u),S()};const p=n((...s)=>{t(...s),S()},r,a);let y;const c=()=>{var s;if(!m)return;i=!1,h.forEach(o=>o(r()));const u=((s=e.onRehydrateStorage)==null?void 0:s.call(e,r()))||void 0;return x(m.getItem.bind(m))(e.name).then(o=>{if(o)return e.deserialize(o)}).then(o=>{if(o)if(typeof o.version=="number"&&o.version!==e.version){if(e.migrate)return e.migrate(o.state,o.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return o.state}).then(o=>{var g;return y=e.merge(o,(g=r())!=null?g:p),t(y,!0),S()}).then(()=>{u?.(y,void 0),i=!0,d.forEach(o=>o(y))}).catch(o=>{u?.(void 0,o)})};return a.persist={setOptions:s=>{e={...e,...s},s.getStorage&&(m=s.getStorage())},clearStorage:()=>{m?.removeItem(e.name)},getOptions:()=>e,rehydrate:()=>c(),hasHydrated:()=>i,onHydrate:s=>(h.add(s),()=>{h.delete(s)}),onFinishHydration:s=>(d.add(s),()=>{d.delete(s)})},c(),y||p},T=(n,l)=>(t,r,a)=>{let e={storage:B(()=>localStorage),partialize:c=>c,version:0,merge:(c,s)=>({...s,...c}),...l},i=!1;const h=new Set,d=new Set;let m=e.storage;if(!m)return n((...c)=>{console.warn(`[zustand persist middleware] Unable to update item '${e.name}', the given storage is currently unavailable.`),t(...c)},r,a);const w=()=>{const c=e.partialize({...r()});return m.setItem(e.name,{state:c,version:e.version})},S=a.setState;a.setState=(c,s)=>{S(c,s),w()};const v=n((...c)=>{t(...c),w()},r,a);a.getInitialState=()=>v;let p;const y=()=>{var c,s;if(!m)return;i=!1,h.forEach(o=>{var g;return o((g=r())!=null?g:v)});const u=((s=e.onRehydrateStorage)==null?void 0:s.call(e,(c=r())!=null?c:v))||void 0;return x(m.getItem.bind(m))(e.name).then(o=>{if(o)if(typeof o.version=="number"&&o.version!==e.version){if(e.migrate)return[!0,e.migrate(o.state,o.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,o.state];return[!1,void 0]}).then(o=>{var g;const[H,k]=o;if(p=e.merge(k,(g=r())!=null?g:v),t(p,!0),H)return w()}).then(()=>{u?.(p,void 0),p=r(),i=!0,d.forEach(o=>o(p))}).catch(o=>{u?.(void 0,o)})};return a.persist={setOptions:c=>{e={...e,...c},c.storage&&(m=c.storage)},clearStorage:()=>{m?.removeItem(e.name)},getOptions:()=>e,rehydrate:()=>y(),hasHydrated:()=>i,onHydrate:c=>(h.add(c),()=>{h.delete(c)}),onFinishHydration:c=>(d.add(c),()=>{d.delete(c)})},e.skipHydration||y(),p||v},$=(n,l)=>"getStorage"in l||"serialize"in l||"deserialize"in l?((M?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),L(n,l)):T(n,l),U=$,A=q()(U((n,l)=>({items:[],isOpen:!1,count:0,category:"Todos",search:"",add:t=>{const r=l().items,e=r.find(i=>i.id===t.id&&i.cor===t.cor)?r.map(i=>i.id===t.id&&i.cor===t.cor?{...i,quantity:i.quantity+1}:i):[...r,{...t,quantity:1}];n({items:e,count:e.reduce((i,h)=>i+h.quantity,0)})},remove:t=>{const r=l().items.filter(a=>!(a.id===t||`${a.id}-${a.cor}`===t));n({items:r,count:r.reduce((a,e)=>a+e.quantity,0)})},updateQuantity:(t,r)=>{const a=l().items.map(e=>(e.cor?`${e.id}-${e.cor}`:e.id)===t||e.id===t?{...e,quantity:r}:e);n({items:a,count:a.reduce((e,i)=>e+i.quantity,0)})},clear:()=>n({items:[],count:0}),toggle:()=>{console.log("Toggle chamado, isOpen atual:",l().isOpen),n({isOpen:!l().isOpen})},setCategory:t=>n({category:t}),setSearch:t=>n({search:t})}),{name:"cart-storage"}));/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=C("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=C("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);function G(){const{count:n,toggle:l}=A(),{data:t,isLoading:r}=F(),a=t?.layout.logo,e=a?D(a,"thumbnail"):"";return f.jsx("header",{className:"sticky top-0 z-40 bg-white shadow-md border-b border-gray-100",children:f.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:f.jsxs("div",{className:"flex items-center justify-between h-16 sm:h-20",children:[f.jsx("a",{href:"/",className:"flex items-center",children:r||!e?f.jsx("div",{className:"h-10 sm:h-14 md:h-16 w-32 sm:w-48 md:w-64 bg-gray-200 animate-pulse rounded"}):f.jsx("img",{src:e,alt:"Rocha Brindes",className:"h-5 sm:h-7 md:h-9 w-auto object-contain",loading:"eager"})}),f.jsxs("button",{onClick:l,className:"relative p-2.5 sm:p-3 bg-primary hover:bg-primary-dark text-white rounded-full transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105","aria-label":"Abrir carrinho",children:[f.jsx(P,{size:20,className:"sm:w-6 sm:h-6",strokeWidth:2.5}),n>0&&f.jsx("span",{className:"absolute -top-1.5 -right-1.5 sm:-top-2 sm:-right-2 bg-accent text-dark font-bold text-[10px] sm:text-xs min-w-[20px] sm:min-w-[24px] h-[20px] sm:h-[24px] flex items-center justify-center rounded-full border-2 sm:border-3 border-white shadow-md",children:n})]})]})})})}export{G as H,W as M,A as a,Z as s,F as u};
