import{e as I,g as R,q as j,l as q,f as N,h as _,a as b,d as z,j as p}from"./Providers._219QqyE.js";import{u as D,c as k,a as E,o as O}from"./cloudflare.jZ7Z--FC.js";function F(s=6){return D({queryKey:["catalog",s],queryFn:async()=>{const[c,t,r]=await Promise.all([I(j(_(b,"produtos"),N("createdAt","desc"),q(s))),I(j(_(b,"categorias"),N("nome"))),R(z(b,"config","layout"))]),n=c.docs.map(d=>({id:d.id,...d.data()})),e=t.docs.map(d=>({id:d.id,...d.data()})),a=r.exists()?r.data():{},h={logo:a.logo||"",banners:(a.banners||[]).map(d=>({url:d,alt:"Banner Rocha Brindes"})),promotions:a.promotions||[],popups:a.popups||[],whatsapp:a.whatsapp,companyInfo:a.companyInfo};return{products:n,categories:e,layout:h}},staleTime:600*1e3,gcTime:1800*1e3,placeholderData:J()})}function J(){if(!(typeof window>"u"))try{const s=localStorage.getItem("catalog-cache");if(s){const c=JSON.parse(s);if(Date.now()-c.timestamp<600*1e3)return c.catalog}}catch{return}}function Z(s){if(!(typeof window>"u"))try{localStorage.setItem("catalog-cache",JSON.stringify({catalog:s,timestamp:Date.now()}))}catch{console.warn("Failed to cache catalog")}}/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=k("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=k("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]),T={};function A(s,c){let t;try{t=s()}catch{return}return{getItem:n=>{var e;const a=d=>d===null?null:JSON.parse(d,void 0),h=(e=t.getItem(n))!=null?e:null;return h instanceof Promise?h.then(a):a(h)},setItem:(n,e)=>t.setItem(n,JSON.stringify(e,void 0)),removeItem:n=>t.removeItem(n)}}const S=s=>c=>{try{const t=s(c);return t instanceof Promise?t:{then(r){return S(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return S(r)(t)}}}},U=(s,c)=>(t,r,n)=>{let e={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:i=>i,version:0,merge:(i,u)=>({...u,...i}),...c},a=!1;const h=new Set,d=new Set;let m;try{m=e.getStorage()}catch{}if(!m)return s((...i)=>{console.warn(`[zustand persist middleware] Unable to update item '${e.name}', the given storage is currently unavailable.`),t(...i)},r,n);const w=S(e.serialize),x=()=>{const i=e.partialize({...r()});let u;const o=w({state:i,version:e.version}).then(g=>m.setItem(e.name,g)).catch(g=>{u=g});if(u)throw u;return o},v=n.setState;n.setState=(i,u)=>{v(i,u),x()};const f=s((...i)=>{t(...i),x()},r,n);let y;const l=()=>{var i;if(!m)return;a=!1,h.forEach(o=>o(r()));const u=((i=e.onRehydrateStorage)==null?void 0:i.call(e,r()))||void 0;return S(m.getItem.bind(m))(e.name).then(o=>{if(o)return e.deserialize(o)}).then(o=>{if(o)if(typeof o.version=="number"&&o.version!==e.version){if(e.migrate)return e.migrate(o.state,o.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return o.state}).then(o=>{var g;return y=e.merge(o,(g=r())!=null?g:f),t(y,!0),x()}).then(()=>{u?.(y,void 0),a=!0,d.forEach(o=>o(y))}).catch(o=>{u?.(void 0,o)})};return n.persist={setOptions:i=>{e={...e,...i},i.getStorage&&(m=i.getStorage())},clearStorage:()=>{m?.removeItem(e.name)},getOptions:()=>e,rehydrate:()=>l(),hasHydrated:()=>a,onHydrate:i=>(h.add(i),()=>{h.delete(i)}),onFinishHydration:i=>(d.add(i),()=>{d.delete(i)})},l(),y||f},B=(s,c)=>(t,r,n)=>{let e={storage:A(()=>localStorage),partialize:l=>l,version:0,merge:(l,i)=>({...i,...l}),...c},a=!1;const h=new Set,d=new Set;let m=e.storage;if(!m)return s((...l)=>{console.warn(`[zustand persist middleware] Unable to update item '${e.name}', the given storage is currently unavailable.`),t(...l)},r,n);const w=()=>{const l=e.partialize({...r()});return m.setItem(e.name,{state:l,version:e.version})},x=n.setState;n.setState=(l,i)=>{x(l,i),w()};const v=s((...l)=>{t(...l),w()},r,n);n.getInitialState=()=>v;let f;const y=()=>{var l,i;if(!m)return;a=!1,h.forEach(o=>{var g;return o((g=r())!=null?g:v)});const u=((i=e.onRehydrateStorage)==null?void 0:i.call(e,(l=r())!=null?l:v))||void 0;return S(m.getItem.bind(m))(e.name).then(o=>{if(o)if(typeof o.version=="number"&&o.version!==e.version){if(e.migrate)return[!0,e.migrate(o.state,o.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,o.state];return[!1,void 0]}).then(o=>{var g;const[H,C]=o;if(f=e.merge(C,(g=r())!=null?g:v),t(f,!0),H)return w()}).then(()=>{u?.(f,void 0),f=r(),a=!0,d.forEach(o=>o(f))}).catch(o=>{u?.(void 0,o)})};return n.persist={setOptions:l=>{e={...e,...l},l.storage&&(m=l.storage)},clearStorage:()=>{m?.removeItem(e.name)},getOptions:()=>e,rehydrate:()=>y(),hasHydrated:()=>a,onHydrate:l=>(h.add(l),()=>{h.delete(l)}),onFinishHydration:l=>(d.add(l),()=>{d.delete(l)})},e.skipHydration||y(),f||v},M=(s,c)=>"getStorage"in c||"serialize"in c||"deserialize"in c?((T?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),U(s,c)):B(s,c),P=M,K=E()(P((s,c)=>({items:[],isOpen:!1,count:0,category:"Todos",search:"",add:t=>{const r=c().items,e=r.find(a=>a.id===t.id&&a.cor===t.cor)?r.map(a=>a.id===t.id&&a.cor===t.cor?{...a,quantity:a.quantity+1}:a):[...r,{...t,quantity:1}];s({items:e,count:e.reduce((a,h)=>a+h.quantity,0)})},remove:t=>{const r=c().items.filter(n=>!(n.id===t||`${n.id}-${n.cor}`===t));s({items:r,count:r.reduce((n,e)=>n+e.quantity,0)})},updateQuantity:(t,r)=>{const n=c().items.map(e=>(e.cor?`${e.id}-${e.cor}`:e.id)===t||e.id===t?{...e,quantity:r}:e);s({items:n,count:n.reduce((e,a)=>e+a.quantity,0)})},clear:()=>s({items:[],count:0}),toggle:()=>{console.log("Toggle chamado, isOpen atual:",c().isOpen),s({isOpen:!c().isOpen})},setCategory:t=>s({category:t}),setSearch:t=>s({search:t})}),{name:"cart-storage"}));function G({showBackButton:s=!1}){const{count:c,toggle:t}=K(),{data:r,isLoading:n}=F(),e=r?.layout.logo,a=e?O(e,"thumbnail"):"";return p.jsx("header",{className:"sticky top-0 z-40 bg-black shadow-md border-b border-gray-800",children:p.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:p.jsxs("div",{className:"relative flex items-center justify-between h-16 sm:h-20",children:[p.jsx("div",{className:"w-10 sm:w-12",children:s&&p.jsx("a",{href:"/",className:"flex items-center justify-center p-2 hover:bg-white/10 rounded-lg transition-colors","aria-label":"Voltar",children:p.jsx(L,{size:20,className:"text-white",strokeWidth:2.5})})}),p.jsx("a",{href:"/",className:`flex items-center ${s?"absolute left-1/2 -translate-x-1/2 sm:static sm:translate-x-0":""}`,children:n||!a?p.jsx("div",{className:"h-10 sm:h-14 md:h-16 w-32 sm:w-48 md:w-64 bg-gray-200 animate-pulse rounded"}):p.jsx("img",{src:a,alt:"Rocha Brindes",className:"h-5 sm:h-7 md:h-9 w-auto object-contain",loading:"eager"})}),p.jsxs("button",{onClick:t,className:"relative p-2.5 sm:p-3 bg-primary hover:bg-primary-dark text-white rounded-full transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105","aria-label":"Abrir carrinho",children:[p.jsx($,{size:20,className:"sm:w-6 sm:h-6",strokeWidth:2.5}),c>0&&p.jsx("span",{className:"absolute -top-1.5 -right-1.5 sm:-top-2 sm:-right-2 bg-accent text-dark font-bold text-[10px] sm:text-xs min-w-[20px] sm:min-w-[24px] h-[20px] sm:h-[24px] flex items-center justify-center rounded-full border-2 sm:border-3 border-white shadow-md",children:c})]})]})})})}export{G as H,$ as S,F as a,Z as s,K as u};
