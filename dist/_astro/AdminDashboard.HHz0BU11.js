import{q as He,e as $e,f as Oe,b as fe,c as rt,j as e,s as ze,d as ge,h as ft,u as Qe,i as pt,l as et,k as St,m as gt,g as Be,n as Et,a as zt}from"./Providers.BXE0NgEa.js";import{r as J,c as Me,g as At}from"./index.DgAqpSaY.js";import{b as he,u as xt,d as Ce,o as Ae,e as Re,C as It,a as Ot,f as Rt,c as Pt}from"./chevron-right.BA9S0OXS.js";import{X as ve}from"./x.Dv60QOdL.js";import{S as Tt,G as Dt}from"./search.CjkfnnHe.js";import{T as Pe}from"./trash-2.5BHxn3JL.js";import{P as tt,M as Bt,a as Ut}from"./phone.D8NvLkeU.js";import{P as st}from"./plus.DAmMKL0U.js";import{P as We}from"./package.BX58AiFD.js";/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bt=he("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lt=he("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=he("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=he("FileArchive",[["path",{d:"M4 22V4c0-.5.2-1 .6-1.4C5 2.2 5.5 2 6 2h8.5L20 7.5V20c0 .5-.2 1-.6 1.4-.4.4-.9.6-1.4.6h-2",key:"1u864v"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["circle",{cx:"10",cy:"20",r:"2",key:"1xzdoj"}],["path",{d:"M10 7V6",key:"dljcrl"}],["path",{d:"M10 12v-1",key:"v7bkov"}],["path",{d:"M10 18v-2",key:"1cjy8d"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mt=he("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=he("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yt=he("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=he("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=he("LayoutTemplate",[["rect",{width:"18",height:"7",x:"3",y:"3",rx:"1",key:"f1a2em"}],["rect",{width:"9",height:"7",x:"3",y:"14",rx:"1",key:"jqznyg"}],["rect",{width:"5",height:"7",x:"16",y:"14",rx:"1",key:"q5h2i8"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=he("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=he("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=he("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=he("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=he("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=he("MoveDown",[["path",{d:"M8 18L12 22L16 18",key:"cskvfv"}],["path",{d:"M12 2V22",key:"r89rzk"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=he("MoveUp",[["path",{d:"M8 6L12 2L16 6",key:"1yvkyx"}],["path",{d:"M12 2V22",key:"r89rzk"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=he("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=he("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=he("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wt=he("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=he("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=he("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=he("UploadCloud",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m16 16-4-4-4 4",key:"119tzi"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=he("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=he("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);function Ue(){return xt({queryKey:["categories"],queryFn:async()=>{const I=He(Oe(fe,"categorias"),$e("nome"));return(await rt(I)).docs.map(d=>({id:d.id,...d.data()}))},staleTime:300*1e3,refetchOnMount:!0,refetchOnWindowFocus:!1})}const Xt="1t7T-5mU4ET0kjqd8x_sXlEwunwogCBrlqFnYpVaoyvE",Jt="AIzaSyAWUmt2UDeXxY1my2ajGU5bAMSjuU0L14o",Qt="produtos!A:Z";function ut(I){return I.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toUpperCase().trim()}function er(I,$){if(!I||!$)return I;const d=new RegExp(`\\s+${$}$`,"i");return I.replace(d,"").trim()}async function tr(I){const $=I.trim();if(!$)return null;const d=$.split("_"),C=d.length>2?d.slice(0,d.length-1).join("_"):$,x=`https://sheets.googleapis.com/v4/spreadsheets/${Xt}/values/${encodeURIComponent(Qt)}?key=${Jt}`,l=await fetch(x);if(!l.ok)throw console.error("Erro ao buscar planilha:",await l.text()),new Error("Não foi possível acessar a planilha do Google Sheets");const s=(await l.json()).values||[];if(!s.length)return null;const[i,..._]=s;console.log("Header da planilha:",i),console.log("Primeira linha de dados:",_[0]);const k=M=>ut(M||""),w=i.findIndex(M=>{const y=k(M);return["ID","CODIGO","CÓDIGO","SKU","COD","CODE"].includes(y)}),p=i.findIndex(M=>{const y=k(M);return["NOME","PRODUTO","DESCRICAO_CURTA","NAME"].includes(y)}),a=i.findIndex(M=>{const y=k(M);return["DESCRICAO","DESCRIÇÃO","DESC","DESCRIPTION"].includes(y)}),b=i.findIndex(M=>{const y=k(M);return["COR","CORES","VARIACAO","VARIACOES","VARIAÇÃO","COLOR"].includes(y)}),n=i.findIndex(M=>{const y=k(M);return["CATEGORIA","CATEGORIAS","GRUPO","CATEGORY"].includes(y)}),f=i.findIndex(M=>{const y=k(M);return["DESTAQUE","HIGHLIGHT","FEATURED"].includes(y)});if(w===-1)throw console.error("Colunas disponíveis:",i.map((M,y)=>`${y}: ${M}`)),new Error(`Coluna de código/SKU não encontrada na planilha. Colunas disponíveis: ${i.join(", ")}`);const c=_.filter(M=>{const y=(M[w]||"").trim();return y?y===C||y.startsWith(C+"_"):!1});if(!c.length)return null;let u="",N="";const z=new Set;let j=!1;const T=[];for(const M of c){const y=p>=0?(M[p]||"").trim():"",B=a>=0?(M[a]||"").trim():"",K=b>=0?(M[b]||"").trim():"",h=n>=0?(M[n]||"").trim():"",A=f>=0?(M[f]||"").trim():"";!u&&y&&(u=K?er(y,K):y),!N&&B&&(N=B),h&&h.split(",").map(r=>r.trim()).filter(Boolean).forEach(r=>z.add(r)),typeof A=="string"&&["SIM","TRUE","1","YES","S"].includes(ut(A))&&(j=!0),K&&!T.find(r=>r.cor===K)&&T.push({cor:K})}const D=Array.from(z);return{baseSku:C,nome:u||C,descricao:N,categorias:D,destaque:j,variacoes:T}}function rr(){const[I,$]=J.useState(""),[d,C]=J.useState(""),[x,l]=J.useState(""),[o,s]=J.useState(!1),[i,_]=J.useState([]),[k,w]=J.useState(!1),[p,a]=J.useState(null),[b,n]=J.useState(""),[f,c]=J.useState([]),[u,N]=J.useState(""),[z,j]=J.useState(""),[T,D]=J.useState(!1),[M,y]=J.useState(""),[B,K]=J.useState(!1),{data:h=[]}=Ue(),A=E=>{const Z=E.target.files?.[0];Z&&(a(Z),n(URL.createObjectURL(Z)))},r=()=>{if(u.trim()){const E=u.trim(),Z=[...f,{cor:E,image:null,preview:""}];c(Z),z||j(E),N("")}},F=(E,Z)=>{const O=[...f];O[E].image=Z,O[E].preview=URL.createObjectURL(Z),c(O)},ee=E=>{const Z=f[E]?.cor,O=f.filter((m,V)=>V!==E);c(O),j(m=>m&&m===Z?O[0]?.cor??"":m)},S=async()=>{const E=d.trim();if(E){K(!0),y("");try{const Z=await tr(E);if(!Z){y("Nenhum produto encontrado na planilha com esse código.");return}if(C(Z.baseSku),Z.nome&&$(Z.nome),Z.descricao&&l(Z.descricao),Z.categorias?.length&&(_(Z.categorias),w(!1)),s(Z.destaque),Z.variacoes?.length){const O=Z.variacoes.map(V=>({cor:V.cor,image:null,preview:""}));c(O);const m=Z.variacoes.find(V=>V.cor.toLowerCase().includes("preto"));m?j(m.cor):Z.variacoes[0]?j(Z.variacoes[0].cor):j("")}else c([]),j("");y("Dados preenchidos a partir da planilha ✅")}catch(Z){console.error(Z),y("Erro ao buscar dados na planilha.")}finally{K(!1)}}},R=async E=>{if(E.preventDefault(),i.length===0){w(!0),y("Selecione pelo menos uma categoria");return}w(!1),D(!0),y("");try{if(!d.trim())throw new Error("Informe um código/SKU");const Z=[],O=[];let m=null;const V={};for(const G of f){if(!G.image)continue;const W=await Ce(G.image,{folder:`produtos/${d}/variacoes`,productId:d,variation:G.cor,type:"variation"});O.push({cor:G.cor,imagem_url:W,thumb_url:W}),Z.push(W),V[G.cor]=W}if(p)m=await Ce(p,{folder:`produtos/${d}`,productId:d,type:"main"}),Z.unshift(m);else if(z&&V[z])m=V[z];else{const G=Object.keys(V).find(W=>W.toLowerCase().includes("preto"));if(G)m=V[G];else{const W=Object.values(V)[0];W&&(m=W)}}if(!m)throw new Error("Envie pelo menos uma imagem (principal ou de alguma variação).");await ze(ge(Oe(fe,"produtos"),d),{id:d,nome:I,descricao:x,categorias:i,destaque:o,variacoes:O,imagem_url:m,thumb_url:m,imagens_urls:Z,thumbs_urls:Z,createdAt:ft()}),y("Produto salvo com sucesso!"),$(""),C(""),l(""),s(!1),_([]),w(!1),a(null),n(""),c([]),N(""),j("")}catch(Z){console.error(Z),y(Z instanceof Error?Z.message:"Erro ao salvar produto")}finally{D(!1)}};return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-title font-bold mb-6",children:"Adicionar Produto"}),e.jsxs("form",{onSubmit:R,className:"space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Nome"}),e.jsx("input",{type:"text",value:I,onChange:E=>$(E.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"SKU/Código"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:d,onChange:E=>C(E.target.value),onBlur:S,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary",required:!0}),e.jsx("button",{type:"button",onClick:S,disabled:B,className:"px-3 py-2 text-sm rounded-lg border border-gray-300 hover:bg-gray-50 disabled:opacity-50",children:B?"Buscando...":"Planilha"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Descrição"}),e.jsx("textarea",{value:x,onChange:E=>l(E.target.value),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold mb-2",children:["Categorias ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:`flex flex-wrap gap-2 p-3 rounded-lg border-2 ${k?"border-red-300 bg-red-50":"border-gray-200"}`,children:h.map(E=>e.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-50 border border-gray-200",children:[e.jsx("input",{type:"checkbox",checked:i.includes(E.nome),onChange:Z=>{w(!1),Z.target.checked?_(O=>[...O,E.nome]):_(O=>O.filter(m=>m!==E.nome))},className:"rounded"}),e.jsx("span",{className:"text-sm",children:E.nome})]},E.id))}),k&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"Selecione pelo menos uma categoria"})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:o,onChange:E=>s(E.target.checked),className:"rounded"}),e.jsx("span",{className:"text-sm font-semibold",children:"Produto em destaque"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Imagem Principal (opcional)"}),e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:b?e.jsxs("div",{className:"relative aspect-square max-w-xs mx-auto",children:[e.jsx("img",{src:b,alt:"Preview",className:"w-full h-full object-contain"}),e.jsx("button",{type:"button",onClick:()=>{a(null),n("")},className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1",children:e.jsx(ve,{size:16})})]}):e.jsxs("label",{className:"flex flex-col items-center gap-2 cursor-pointer",children:[e.jsx(Ne,{className:"text-gray-400",size:48}),e.jsx("span",{className:"text-sm text-gray-600",children:"Clique para selecionar imagem principal (opcional)"}),e.jsx("input",{type:"file",accept:"image/*",onChange:A,className:"hidden"})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Variações de Cor"}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("input",{type:"text",value:u,onChange:E=>N(E.target.value),onKeyDown:E=>{E.key==="Enter"&&(E.preventDefault(),r())},placeholder:"Nome da cor (ex: Vermelho, Preto fosco)",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary"}),e.jsx("button",{type:"button",onClick:r,className:"bg-primary hover:opacity-90 text-text-primary px-4 py-2 rounded-lg font-semibold",children:"Adicionar"})]}),f.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Cor principal"}),e.jsxs("select",{value:z,onChange:E=>j(E.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary",children:[e.jsx("option",{value:"",children:"Selecione a cor principal"}),f.map((E,Z)=>e.jsx("option",{value:E.cor,children:E.cor},E.cor+Z))]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Essa cor será usada como principal se você não enviar imagem principal do produto."})]}),e.jsx("div",{className:"space-y-3",children:f.map((E,Z)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-sm mb-2",children:E.cor}),E.preview?e.jsx("div",{className:"relative w-24 h-24",children:e.jsx("img",{src:E.preview,alt:E.cor,className:"w-full h-full object-cover rounded"})}):e.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 bg-white border border-gray-300 rounded cursor-pointer hover:bg-gray-50",children:[e.jsx(Ne,{size:16}),e.jsx("span",{className:"text-xs",children:"Adicionar imagem"}),e.jsx("input",{type:"file",accept:"image/*",onChange:O=>{const m=O.target.files?.[0];m&&F(Z,m)},className:"hidden"})]})]}),e.jsx("button",{type:"button",onClick:()=>ee(Z),className:"text-red-500 hover:bg-red-50 p-2 rounded",children:e.jsx(ve,{size:18})})]},Z))})]}),M&&e.jsx("p",{className:`text-center font-semibold ${M.includes("sucesso")||M.includes("planilha")?"text-green-600":"text-red-600"}`,children:M}),e.jsx("button",{type:"submit",disabled:T,className:"w-full bg-primary hover:opacity-90 text-text-primary font-bold py-3 rounded-lg transition-all disabled:opacity-50",children:T?"Salvando...":"Salvar Produto"})]})]})}function sr({product:I,onClose:$}){const[d,C]=J.useState(I.nome||""),[x,l]=J.useState(I.descricao||""),[o,s]=J.useState(I.destaque||!1),[i,_]=J.useState(I.categorias||[]),[k,w]=J.useState(null),[p,a]=J.useState(I.imagem_url?Ae(I.imagem_url,"thumbnail"):""),[b,n]=J.useState(I.variacoes?.map(h=>({cor:h.cor,image:null,preview:Ae(h.imagem_url,"thumbnail"),existingUrl:h.imagem_url}))||[]),[f,c]=J.useState(""),[u,N]=J.useState(!1),[z,j]=J.useState(""),{data:T=[]}=Ue(),D=h=>{const A=h.target.files?.[0];A&&(w(A),a(URL.createObjectURL(A)))},M=()=>{f.trim()&&(n([...b,{cor:f.trim(),image:null,preview:""}]),c(""))},y=(h,A)=>{const r=[...b];r[h].image=A,r[h].preview=URL.createObjectURL(A),n(r)},B=h=>{n(b.filter((A,r)=>r!==h))},K=async h=>{h.preventDefault(),N(!0),j("");try{let A=I.imagem_url;k&&(A=await Ce(k,{folder:`produtos/${I.id}`,productId:I.id,type:"main"}),I.imagem_url&&I.imagem_url!==A&&await Re(I.imagem_url));const r=[],F=[A],ee=I.variacoes?.map(S=>S.imagem_url)||[];for(const S of b)if(S.image){const R=await Ce(S.image,{folder:`produtos/${I.id}/variacoes`,productId:I.id,variation:S.cor,type:"variation"});if(r.push({cor:S.cor,imagem_url:R,thumb_url:R}),F.push(R),S.existingUrl&&S.existingUrl!==R){const E=ee.indexOf(S.existingUrl);E>-1&&ee.splice(E,1)}}else if(S.existingUrl){const R=I.variacoes?.find(E=>E.cor===S.cor);if(R){r.push(R),F.push(R.imagem_url);const E=ee.indexOf(R.imagem_url);E>-1&&ee.splice(E,1)}}for(const S of ee)await Re(S);await Qe(ge(fe,"produtos",I.id),{nome:d,descricao:x,categorias:i,destaque:o,variacoes:r,imagem_url:A,thumb_url:A,imagens_urls:F,thumbs_urls:F}),j("Produto atualizado com sucesso!"),setTimeout(()=>$(),1500)}catch(A){console.error(A),j(A instanceof Error?A.message:"Erro ao atualizar produto")}finally{N(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b px-6 py-4 flex justify-between items-center z-10",children:[e.jsx("h2",{className:"text-xl font-title font-bold",children:"Editar Produto"}),e.jsx("button",{onClick:$,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(ve,{size:20})})]}),e.jsxs("form",{onSubmit:K,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Nome"}),e.jsx("input",{type:"text",value:d,onChange:h=>C(h.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"SKU/Código"}),e.jsx("input",{type:"text",value:I.id,disabled:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Descrição"}),e.jsx("textarea",{value:x,onChange:h=>l(h.target.value),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Categorias"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:T.map(h=>e.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:i.includes(h.nome),onChange:A=>{A.target.checked?_(r=>[...r,h.nome]):_(r=>r.filter(F=>F!==h.nome))},className:"rounded"}),e.jsx("span",{className:"text-sm",children:h.nome})]},h.id))})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:o,onChange:h=>s(h.target.checked),className:"rounded"}),e.jsx("span",{className:"text-sm font-semibold",children:"Produto em destaque"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Imagem Principal"}),e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:p?e.jsxs("div",{className:"relative aspect-square max-w-xs mx-auto",children:[e.jsx("img",{src:p,alt:"Preview",className:"w-full h-full object-contain"}),e.jsxs("label",{className:"absolute bottom-2 right-2 bg-primary text-white p-2 rounded-full cursor-pointer hover:opacity-90 shadow-lg transition-opacity",children:[e.jsx(Ne,{size:16}),e.jsx("input",{type:"file",accept:"image/*",onChange:D,className:"hidden"})]})]}):e.jsxs("label",{className:"flex flex-col items-center gap-2 cursor-pointer",children:[e.jsx(Ne,{className:"text-gray-400",size:48}),e.jsx("span",{className:"text-sm text-gray-600",children:"Clique para selecionar imagem principal"}),e.jsx("input",{type:"file",accept:"image/*",onChange:D,className:"hidden"})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Variações de Cor"}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("input",{type:"text",value:f,onChange:h=>c(h.target.value),onKeyDown:h=>{h.key==="Enter"&&(h.preventDefault(),M())},placeholder:"Nome da cor (ex: Vermelho, Preto fosco)",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none"}),e.jsx("button",{type:"button",onClick:M,className:"bg-primary hover:opacity-90 text-white px-4 py-2 rounded-lg font-semibold transition-opacity",children:"Adicionar"})]}),e.jsx("div",{className:"space-y-3",children:b.map((h,A)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-sm mb-2",children:h.cor}),h.preview?e.jsxs("div",{className:"relative w-24 h-24",children:[e.jsx("img",{src:h.preview,alt:h.cor,className:"w-full h-full object-cover rounded"}),e.jsxs("label",{className:"absolute bottom-0 right-0 bg-primary text-white p-1 rounded cursor-pointer hover:opacity-90 shadow-md transition-opacity",children:[e.jsx(Ne,{size:12}),e.jsx("input",{type:"file",accept:"image/*",onChange:r=>{const F=r.target.files?.[0];F&&y(A,F)},className:"hidden"})]})]}):e.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 bg-white border border-gray-300 rounded cursor-pointer hover:bg-gray-50 transition-colors",children:[e.jsx(Ne,{size:16}),e.jsx("span",{className:"text-xs",children:"Adicionar imagem"}),e.jsx("input",{type:"file",accept:"image/*",onChange:r=>{const F=r.target.files?.[0];F&&y(A,F)},className:"hidden"})]})]}),e.jsx("button",{type:"button",onClick:()=>B(A),className:"text-red-500 hover:bg-red-50 p-2 rounded transition-colors",children:e.jsx(ve,{size:18})})]},A))})]}),z&&e.jsx("div",{className:`p-3 rounded-lg text-center font-semibold ${z.includes("sucesso")?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:z}),e.jsx("button",{type:"submit",disabled:u,className:"w-full bg-primary hover:opacity-90 text-white font-bold py-3 rounded-lg transition-opacity disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Salvando...":"Salvar Alterações"})]})]})})}function ar(){const[I,$]=J.useState(0),[d,C]=J.useState([]),[x,l]=J.useState(null),[o,s]=J.useState(null),[i,_]=J.useState(""),k=50,w=pt(),p=J.useMemo(()=>{const j=He(Oe(fe,"produtos"),$e("createdAt","desc"),et(k));return I>0&&d[I-1]?He(Oe(fe,"produtos"),$e("createdAt","desc"),St(d[I-1]),et(k)):j},[I,d,k]),{data:a=[],isLoading:b,refetch:n,isFetching:f}=xt({queryKey:["admin-products",I,k,d[I-1]?.id],queryFn:async()=>{const T=(await rt(p)).docs;return T.length>0&&C(D=>{const M=[...D];return M[I]=T[T.length-1],M}),T.map(D=>({id:D.id,...D.data()}))},placeholderData:j=>j??[],staleTime:3e4}),c=J.useMemo(()=>{if(!i.trim())return a;const j=i.toLowerCase();return a.filter(T=>T.nome.toLowerCase().includes(j)||T.id.toLowerCase().includes(j))},[a,i]),u=async j=>{if(confirm(`Tem certeza que deseja excluir "${j.nome}"?`)){s(j.id);try{const T=[];j.imagem_url&&T.push(j.imagem_url),j.thumb_url&&j.thumb_url!==j.imagem_url&&T.push(j.thumb_url),j.imagens_urls?.length&&j.imagens_urls.forEach(D=>{T.includes(D)||T.push(D)}),j.thumbs_urls?.length&&j.thumbs_urls.forEach(D=>{T.includes(D)||T.push(D)}),j.variacoes?.length&&j.variacoes.forEach(D=>{D.imagem_url&&!T.includes(D.imagem_url)&&T.push(D.imagem_url),D.thumb_url&&!T.includes(D.thumb_url)&&T.push(D.thumb_url)}),await Rt(T),await gt(ge(fe,"produtos",j.id)),await w.invalidateQueries({queryKey:["admin-products"]}),await n()}catch(T){console.error("Erro ao deletar produto:",T),alert("Erro ao deletar produto")}finally{s(null)}}},N=j=>{l(j)},z=()=>{l(null),w.invalidateQueries({queryKey:["admin-products"]}),n()};return b&&!a.length?e.jsx("div",{className:"text-center py-8",children:"Carregando produtos..."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("h2",{className:"text-xl font-title font-bold",children:["Produtos Cadastrados ",f&&e.jsx("span",{className:"text-sm text-gray-400",children:"(atualizando…)"})]}),e.jsxs("div",{className:"relative w-full sm:w-64",children:[e.jsx("input",{type:"text",value:i,onChange:j=>_(j.target.value),placeholder:"Buscar por nome ou SKU...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none text-sm"}),e.jsx(Tt,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18})]})]})}),e.jsx("div",{className:"max-h-[600px] overflow-auto divide-y",children:c.map(j=>{const T=j.thumb_url||j.imagem_url||j.imagens_urls?.[0],D=T?Ae(T,"thumbnail"):"";return e.jsxs("div",{className:"flex items-center gap-4 px-4 py-2 hover:bg-gray-50",children:[D?e.jsx("img",{src:D,alt:j.nome??"Produto",className:"w-16 h-16 object-contain rounded bg-gray-50"}):e.jsx("div",{className:"w-16 h-16 flex items-center justify-center bg-gray-100 rounded",children:e.jsx("span",{className:"text-xs text-gray-400",children:"Sem img"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold",children:j.nome}),e.jsxs("p",{className:"text-sm text-gray-500",children:["SKU: ",j.id]}),e.jsx("div",{className:"flex gap-2 mt-1 flex-wrap",children:j.categorias?.map(M=>e.jsx("span",{className:"text-xs bg-gray-200 px-2 py-1 rounded",children:M},M))}),j.variacoes&&j.variacoes.length>0&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[j.variacoes.length," variações de cor"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>N(j),className:"p-2 text-blue-600 hover:bg-blue-50 rounded",title:"Editar",disabled:o===j.id,children:e.jsx(vt,{size:18})}),e.jsx("button",{onClick:()=>u(j),className:"p-2 text-red-600 hover:bg-red-50 rounded disabled:opacity-50",title:"Excluir",disabled:o===j.id,children:o===j.id?e.jsx("div",{className:"w-[18px] h-[18px] border-2 border-red-600 border-t-transparent rounded-full animate-spin"}):e.jsx(Pe,{size:18})})]})]},j.id)})}),e.jsxs("div",{className:"p-4 border-t border-gray-200 flex justify-between items-center",children:[e.jsxs("button",{onClick:()=>$(j=>Math.max(0,j-1)),disabled:I===0,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 rounded-lg disabled:opacity-50 hover:bg-gray-200",children:[e.jsx(It,{size:18}),"Anterior"]}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Página ",I+1]}),e.jsxs("button",{onClick:()=>$(j=>j+1),disabled:a.length<k,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 rounded-lg disabled:opacity-50 hover:bg-gray-200",children:["Próximo",e.jsx(Ot,{size:18})]})]})]}),x&&e.jsx(sr,{product:x,onClose:z})]})}const nr=Pt(I=>({message:"",type:"success",isVisible:!1,showToast:($,d="success")=>I({message:$,type:d,isVisible:!0}),hideToast:()=>I({isVisible:!1})}));function ir(){const[I,$]=J.useState(""),[d,C]=J.useState(!1),[x,l]=J.useState(null),[o,s]=J.useState(""),[i,_]=J.useState(!1),{data:k=[],refetch:w}=Ue(),{showToast:p}=nr(),a=u=>{const N=u.target.files?.[0];N&&(l(N),s(URL.createObjectURL(N)))},b=async u=>{u.preventDefault(),_(!0);try{const N=I.toLowerCase().replace(/\s+/g,"-");let z="";x&&(z=await Ce(x,{folder:"categorias",productId:N,type:"category"})),await ze(ge(fe,"categorias",N),{id:N,nome:I,productCount:0,popular:d,imagePath:z}),$(""),C(!1),l(null),s(""),w(),p("Categoria criada com sucesso!","success")}catch(N){console.error(N),p("Erro ao criar categoria","error")}finally{_(!1)}},n=async u=>{if(confirm("Tem certeza? Esta ação não pode ser desfeita."))try{u.imagePath&&await Re(u.imagePath),await gt(ge(fe,"categorias",u.id)),w(),p("Categoria excluída com sucesso!","success")}catch(N){console.error(N),p("Erro ao excluir categoria","error")}},f=async u=>{try{await Qe(ge(fe,"categorias",u.id),{popular:!u.popular}),w(),p("Status atualizado!","success")}catch(N){console.error(N),p("Não foi possível atualizar","error")}},c=async(u,N)=>{try{const z=await Ce(N,{folder:"categorias",productId:u.id,type:"category"});u.imagePath&&await Re(u.imagePath),await Qe(ge(fe,"categorias",u.id),{imagePath:z}),w(),p("Imagem atualizada!","success")}catch(z){console.error(z),p("Não foi possível atualizar a imagem","error")}};return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6",children:[e.jsx("h2",{className:"text-xl font-title font-bold mb-6",children:"Gerenciar Categorias"}),e.jsxs("form",{onSubmit:b,className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Nome da categoria"}),e.jsx("input",{type:"text",value:I,onChange:u=>$(u.target.value),placeholder:"Nome da categoria",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Imagem da categoria"}),o?e.jsxs("div",{className:"relative w-full h-24",children:[e.jsx("img",{src:o,alt:"Preview",className:"w-full h-full object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:()=>{l(null),s("")},className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1",children:e.jsx(ve,{size:14})})]}):e.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx(Ne,{size:16}),e.jsx("span",{className:"text-sm",children:"Selecionar imagem"}),e.jsx("input",{type:"file",accept:"image/*",onChange:a,className:"hidden"})]})]})]}),e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:d,onChange:u=>C(u.target.checked),className:"w-4 h-4 rounded"}),e.jsx("span",{className:"text-sm font-semibold",children:"Marcar como categoria popular"})]}),e.jsx("button",{type:"submit",disabled:i,className:"w-full bg-primary hover:opacity-90 text-text-primary font-semibold px-6 py-3 rounded-lg disabled:opacity-50",children:i?"Criando...":"Criar Categoria"})]}),e.jsx("div",{className:"space-y-2",children:k.map(u=>e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between p-4 bg-gray-50 rounded-lg gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1 w-full sm:w-auto",children:[u.imagePath&&e.jsx("img",{src:Ae(u.imagePath,"thumbnail"),alt:u.nome,className:"w-16 h-16 object-cover rounded-lg flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold truncate",children:u.nome}),e.jsxs("p",{className:"text-sm text-gray-500",children:[u.productCount||0," produtos"]}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.jsx("button",{onClick:()=>void f(u),className:`px-3 py-1 rounded border text-xs sm:text-sm ${u.popular?"bg-green-600 text-white border-green-600":"bg-white text-gray-700 border-gray-300"}`,children:u.popular?"Popular ✓":"Marcar como popular"}),e.jsxs("label",{className:"flex items-center gap-2 px-3 py-1 bg-white border border-gray-300 rounded cursor-pointer hover:bg-gray-50",children:[e.jsx(Ne,{size:14}),e.jsx("span",{className:"text-xs",children:"Alterar imagem"}),e.jsx("input",{type:"file",accept:"image/*",onChange:N=>{const z=N.target.files?.[0];z&&c(u,z)},className:"hidden"})]})]})]})]}),e.jsx("button",{onClick:()=>void n(u),className:"p-2 text-red-600 hover:bg-red-50 rounded self-end sm:self-auto",children:e.jsx(Pe,{size:18})})]},u.id))})]})}function or(){const[I,$]=J.useState(!1),[d,C]=J.useState(""),[x,l]=J.useState({companyName:"Rocha Brindes",description:"",address:"",phone:"",email:"",copyright:"© 2024 Rocha Brindes. Todos os direitos reservados.",instagramUrl:"",facebookUrl:"",linkedinUrl:"",youtubeUrl:"",navigation:{title:"Navegação",links:[{label:"Início",url:"/"},{label:"Catálogo",url:"/catalogo"}]}});J.useEffect(()=>{(async()=>{try{const a=await Be(ge(fe,"config","footer"));a.exists()&&l(b=>({...b,...a.data()}))}catch(a){console.error("Erro carregar footer:",a)}})()},[]);const o=(p,a)=>{l({...x,[p]:a})},s=p=>{l({...x,navigation:{...x.navigation,title:p}})},i=(p,a,b)=>{const n=[...x.navigation.links];n[p]={...n[p],[a]:b},l({...x,navigation:{...x.navigation,links:n}})},_=()=>{l({...x,navigation:{...x.navigation,links:[...x.navigation.links,{label:"",url:""}]}})},k=p=>{l({...x,navigation:{...x.navigation,links:x.navigation.links.filter((a,b)=>b!==p)}})},w=async()=>{$(!0),C("");try{await ze(ge(fe,"config","footer"),x),C("✅ Rodapé atualizado!"),setTimeout(()=>C(""),3e3)}catch{C("❌ Erro ao salvar.")}finally{$(!1)}};return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-100 pb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-blue-50 p-2 rounded-lg text-blue-600",children:e.jsx(qt,{size:24})}),e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Configurar Rodapé"})]}),d&&e.jsx("span",{className:`px-3 py-1 rounded-md text-sm font-bold ${d.includes("✅")?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:d})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(_t,{size:18,className:"text-primary"}),"Informações da Empresa"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Nome da Empresa"}),e.jsx("input",{type:"text",value:x.companyName,onChange:p=>o("companyName",p.target.value),className:"w-full p-3 border-2 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"Rocha Brindes"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Descrição"}),e.jsx("textarea",{value:x.description,onChange:p=>o("description",p.target.value),rows:3,className:"w-full p-3 border-2 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"Transformando ideias em brindes únicos..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Copyright"}),e.jsx("input",{type:"text",value:x.copyright,onChange:p=>o("copyright",p.target.value),className:"w-full p-3 border-2 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"© 2024 Rocha Brindes"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(tt,{size:18,className:"text-primary"}),"Informações de Contato"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 mb-1",children:[e.jsx(Bt,{size:14})," Endereço"]}),e.jsx("textarea",{value:x.address,onChange:p=>o("address",p.target.value),rows:2,className:"w-full p-3 border-2 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"Rua Example, 123 - Centro"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 mb-1",children:[e.jsx(tt,{size:14})," Telefone"]}),e.jsx("input",{type:"text",value:x.phone,onChange:p=>o("phone",p.target.value),className:"w-full p-3 border-2 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"(00) 0000-0000"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 mb-1",children:[e.jsx(Ut,{size:14})," Email"]}),e.jsx("input",{type:"email",value:x.email,onChange:p=>o("email",p.target.value),className:"w-full p-3 border-2 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"contato@rochabrindes.com"})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(Mt,{size:18,className:"text-primary"}),"Redes Sociais"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Instagram"}),e.jsx("input",{type:"url",value:x.instagramUrl,onChange:p=>o("instagramUrl",p.target.value),className:"w-full p-3 border-2 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"https://instagram.com/rochabrindes"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Facebook"}),e.jsx("input",{type:"url",value:x.facebookUrl,onChange:p=>o("facebookUrl",p.target.value),className:"w-full p-3 border-2 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"https://facebook.com/rochabrindes"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"LinkedIn"}),e.jsx("input",{type:"url",value:x.linkedinUrl,onChange:p=>o("linkedinUrl",p.target.value),className:"w-full p-3 border-2 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"https://linkedin.com/company/rochabrindes"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"YouTube"}),e.jsx("input",{type:"url",value:x.youtubeUrl,onChange:p=>o("youtubeUrl",p.target.value),className:"w-full p-3 border-2 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"https://youtube.com/@rochabrindes"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-gray-800",children:"Links de Navegação"}),e.jsxs("button",{onClick:_,className:"flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-lg hover:opacity-90 text-sm font-semibold",children:[e.jsx(st,{size:16}),"Adicionar Link"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Título da Seção"}),e.jsx("input",{type:"text",value:x.navigation.title,onChange:p=>s(p.target.value),className:"w-full p-3 border-2 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"Navegação"})]}),e.jsx("div",{className:"space-y-3",children:x.navigation.links.map((p,a)=>e.jsxs("div",{className:"flex gap-3 items-start p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex-1 grid md:grid-cols-2 gap-3",children:[e.jsx("input",{type:"text",value:p.label,onChange:b=>i(a,"label",b.target.value),className:"w-full p-2 border-2 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"Texto do Link"}),e.jsx("input",{type:"text",value:p.url,onChange:b=>i(a,"url",b.target.value),className:"w-full p-2 border-2 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"/caminho ou https://..."})]}),e.jsx("button",{onClick:()=>k(a),className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors",children:e.jsx(ve,{size:20})})]},a))})]}),e.jsx("div",{className:"pt-4 border-t border-gray-100 flex justify-end",children:e.jsxs("button",{onClick:w,disabled:I,className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 rounded-lg font-bold transition-all disabled:opacity-50",children:[I?e.jsx(Wt,{className:"animate-spin",size:18}):e.jsx(Ke,{size:18}),"Salvar Rodapé"]})})]})}function lr(){const[I,$]=J.useState({}),[d,C]=J.useState(!1),[x,l]=J.useState(null),[o,s]=J.useState(""),[i,_]=J.useState(""),[k,w]=J.useState(""),[p,a]=J.useState("");J.useEffect(()=>{b(),n()},[]);const b=async()=>{try{const T=await Be(ge(fe,"config","layout"));if(T.exists()){const D=T.data();$(D),_(D.companyInfo?.title||""),w(D.companyInfo?.description||""),D.whatsapp&&a(D.whatsapp)}}catch(T){console.error("Erro ao carregar assets:",T),s("Erro ao carregar configurações")}},n=async()=>{try{const T=await Be(ge(fe,"config","general"));if(T.exists()){const D=T.data();D.whatsappNumber&&!p&&a(D.whatsappNumber)}}catch(T){console.error("Erro ao carregar WhatsApp:",T)}},f=async T=>{await ze(ge(fe,"config","layout"),T,{merge:!0})},c=async T=>{await ze(ge(fe,"config","general"),{whatsappNumber:T},{merge:!0})},u=(T,D=3e3)=>{s(T),setTimeout(()=>s(""),D)},N=async()=>{try{const T={...I,companyInfo:k?{title:i,description:k}:void 0,whatsapp:p||void 0};await f(T),p&&await c(p),$(T),u("Informações salvas com sucesso!")}catch(T){console.error(T),u("Erro ao salvar informações")}},z=async T=>{C(!0),l("logo");try{const D=await Ce(T,{folder:"layout",type:"logo"});I.logo&&await Re(I.logo);const M={...I,logo:D};await f(M),$(M),u("Logo atualizado com sucesso!")}catch(D){console.error(D),u("Erro ao fazer upload do logo")}finally{C(!1),l(null)}},j=async()=>{if(I.logo)try{await Re(I.logo);const T={...I,logo:void 0};await f(T),$(T),u("Logo removido com sucesso!")}catch(T){console.error(T),u("Erro ao remover logo")}};return e.jsxs("div",{className:"space-y-8",children:[o&&e.jsx("div",{className:`p-4 rounded-xl text-center font-semibold shadow-md animate-fade-in ${o.includes("sucesso")?"bg-green-50 text-green-700 border-2 border-green-200":"bg-red-50 text-red-700 border-2 border-red-200"}`,children:o}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center",children:e.jsx(yt,{size:20,className:"text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-title font-bold text-gray-800",children:"Logo Principal"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Logotipo exibido no cabeçalho"})]})]}),I.logo?e.jsxs("div",{className:"relative inline-block",children:[e.jsx("div",{className:"w-64 h-32 border-2 border-gray-200 rounded-xl p-4 group hover:border-primary transition-colors bg-gray-50",children:e.jsx("img",{src:Ae(I.logo,"thumbnail"),alt:"Logo",className:"w-full h-full object-contain"})}),e.jsx("button",{onClick:()=>void j(),className:"absolute -top-3 -right-3 bg-red-500 hover:bg-red-600 text-white rounded-full p-2 shadow-lg transition-all transform hover:scale-110",title:"Remover logo",children:e.jsx(ve,{size:18})})]}):e.jsxs("label",{className:"group relative inline-flex items-center justify-center gap-3 px-6 py-4 bg-gradient-to-r from-primary/10 to-primary/5 border-2 border-dashed border-primary/30 rounded-xl cursor-pointer hover:border-primary hover:from-primary/20 hover:to-primary/10 transition-all",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-white rounded-lg shadow-sm group-hover:shadow-md transition-shadow",children:x==="logo"?e.jsx(ke,{size:20,className:"animate-spin text-primary"}):e.jsx(Ne,{size:20,className:"text-primary"})}),e.jsx("span",{className:"font-semibold text-gray-800",children:"Adicionar Logo"}),e.jsx("input",{type:"file",accept:"image/*",onChange:T=>{const D=T.target.files?.[0];D&&z(D)},className:"hidden",disabled:d})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-500/10 rounded-lg flex items-center justify-center",children:e.jsx(wt,{size:20,className:"text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-title font-bold text-gray-800",children:"Configurações"}),e.jsx("p",{className:"text-sm text-gray-500",children:"WhatsApp e outros"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(tt,{size:16}),"WhatsApp"]}),e.jsx("input",{type:"text",value:p,onChange:T=>a(T.target.value),placeholder:"Ex: 5589994333316",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-primary focus:outline-none transition-colors"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Apenas números com DDI e DDD"})]})]})]}),e.jsx(or,{}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:()=>void N(),className:"px-8 py-3 bg-gradient-to-r from-primary to-primary-dark text-white rounded-xl font-semibold hover:shadow-lg transition-all",children:"Salvar Configurações"})})]})}const Ee={hero:{title:"Brindes que Impressionam",subtitle:"Transforme sua marca em experiências memoráveis",ctaText:"Explorar Catálogo"},infoSections:[{title:"Qualidade Garantida",description:"Trabalhamos apenas com fornecedores certificados e produtos de alta qualidade para garantir a satisfação dos nossos clientes.",imagePosition:"right",features:["Produtos certificados e testados","Garantia de qualidade em todos os itens","Entrega rápida e segura"]},{title:"Personalização Completa",description:"Oferecemos personalização completa para que sua marca se destaque. Do design à produção, cuidamos de cada detalhe.",imagePosition:"left",features:["Design exclusivo para sua marca","Múltiplas opções de personalização","Equipe especializada em branding"]},{title:"Atendimento Especializado",description:"Nossa equipe está pronta para ajudar você em cada etapa do processo, desde a escolha do produto até a entrega final.",imagePosition:"right",features:["Consultoria gratuita","Suporte em todo o processo","Pós-venda diferenciado"]}],videos:[],featuredProductIds:[],stats:{products:{value:"500+",label:"Produtos Disponíveis"},clients:{value:"1000+",label:"Clientes Satisfeitos"},years:{value:"15+",label:"Anos de Experiência"}},cta:{title:"Pronto para Começar?",description:"Solicite um orçamento personalizado e descubra como podemos ajudar sua marca",buttonText:"Ver Catálogo Completo"}};function cr(){const[I,$]=J.useState(Ee),[d,C]=J.useState(!1),[x,l]=J.useState(null),[o,s]=J.useState(null),[i,_]=J.useState(""),[k,w]=J.useState([]),[p,a]=J.useState([]),[b,n]=J.useState(!0),[f,c]=J.useState(!0);J.useEffect(()=>{u(),N()},[]);const u=async()=>{c(!0);try{const S=await Be(ge(fe,"config","landing"));if(S.exists()){const R=S.data();$({hero:R.hero||Ee.hero,infoSections:R.infoSections||Ee.infoSections,videos:R.videos||[],featuredProductIds:R.featuredProductIds||[],stats:{products:R.stats?.products||Ee.stats.products,clients:R.stats?.clients||Ee.stats.clients,years:R.stats?.years||Ee.stats.years},cta:R.cta||Ee.cta}),a(R.featuredProductIds||[])}}catch(S){console.error("Erro ao carregar landing:",S),j("❌ Erro ao carregar dados")}finally{c(!1)}},N=async()=>{n(!0);try{const S=He(Oe(fe,"produtos"),$e("createdAt","desc"),et(100)),E=(await rt(S)).docs.map(Z=>({id:Z.id,...Z.data()}));w(E)}catch(S){console.error("Erro ao carregar produtos:",S),j("❌ Erro ao carregar produtos")}finally{n(!1)}},z=async()=>{C(!0);try{await ze(ge(fe,"config","landing"),{...I,featuredProductIds:p}),j("✅ Landing page atualizada!")}catch(S){j("❌ Erro ao salvar"),console.error(S)}finally{C(!1)}},j=S=>{_(S),setTimeout(()=>_(""),3e3)},T=S=>{a(R=>R.includes(S)?R.filter(E=>E!==S):R.length>=10?R:[...R,S])},D=async(S,R)=>{s(R);try{const E=await Ce(S,{folder:"landing",type:"banner"});h(R,"imageUrl",E),j("✅ Imagem enviada!")}catch(E){console.error("Erro ao enviar imagem:",E),j("❌ Erro ao enviar imagem")}finally{s(null)}},M=async(S,R,E,Z)=>{l("video");try{const O={url:S,title:E,description:Z};R&&R.trim()&&(O.thumbnail=R),$(m=>({...m,videos:[...m.videos,O]})),j("✅ Vídeo adicionado!")}catch(O){console.error("Erro ao adicionar vídeo:",O),j("❌ Erro ao adicionar")}finally{l(null)}},y=S=>{$(R=>({...R,videos:R.videos.filter((E,Z)=>Z!==S)})),j("✅ Vídeo removido!")},B=()=>{const S={title:"Nova Seção",description:"Descrição da seção",imagePosition:"right",features:["Item 1","Item 2","Item 3"]};$(R=>({...R,infoSections:[...R.infoSections||[],S]})),j("✅ Seção adicionada!")},K=S=>{$(R=>({...R,infoSections:R.infoSections?.filter((E,Z)=>Z!==S)})),j("✅ Seção removida!")},h=(S,R,E)=>{$(Z=>({...Z,infoSections:Z.infoSections?.map((O,m)=>m===S?{...O,[R]:E}:O)}))},A=S=>{$(R=>({...R,infoSections:R.infoSections?.map((E,Z)=>Z===S?{...E,features:[...E.features||[],"Novo item"]}:E)}))},r=(S,R)=>{$(E=>({...E,infoSections:E.infoSections?.map((Z,O)=>O===S?{...Z,features:Z.features?.filter((m,V)=>V!==R)}:Z)}))},F=(S,R,E)=>{$(Z=>({...Z,infoSections:Z.infoSections?.map((O,m)=>m===S?{...O,features:O.features?.map((V,G)=>G===R?E:V)}:O)}))},ee=(S,R)=>{if(!I.infoSections)return;const E=R==="up"?S-1:S+1;if(E<0||E>=I.infoSections.length)return;const Z=[...I.infoSections],O=Z[S];Z[S]=Z[E],Z[E]=O,$(m=>({...m,infoSections:Z}))};return f?e.jsxs("div",{className:"flex items-center justify-center py-20",children:[e.jsx(ke,{className:"animate-spin text-primary",size:48}),e.jsx("span",{className:"ml-4 text-xl text-gray-600",children:"Carregando..."})]}):e.jsxs("div",{className:"space-y-8",children:[i&&e.jsx("div",{className:`p-4 rounded-xl text-center font-semibold ${i.includes("✅")?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:i}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-500/10 rounded-lg flex items-center justify-center",children:e.jsx($t,{size:20,className:"text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:"Seção Hero (Principal)"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Primeira impressão do site"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Título Principal"}),e.jsx("input",{type:"text",value:I.hero?.title||"",onChange:S=>$(R=>({...R,hero:{...R.hero,title:S.target.value}})),className:"w-full px-4 py-3 border-2 rounded-xl focus:border-primary outline-none",placeholder:"Ex: Brindes que Impressionam"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Subtítulo"}),e.jsx("input",{type:"text",value:I.hero?.subtitle||"",onChange:S=>$(R=>({...R,hero:{...R.hero,subtitle:S.target.value}})),className:"w-full px-4 py-3 border-2 rounded-xl focus:border-primary outline-none",placeholder:"Ex: Transforme sua marca em experiências memoráveis"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Texto do Botão Principal"}),e.jsx("input",{type:"text",value:I.hero?.ctaText||"",onChange:S=>$(R=>({...R,hero:{...R.hero,ctaText:S.target.value}})),className:"w-full px-4 py-3 border-2 rounded-xl focus:border-primary outline-none",placeholder:"Ex: Explorar Catálogo"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-indigo-500/10 rounded-lg flex items-center justify-center",children:e.jsx(ot,{size:20,className:"text-indigo-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:"Seções de Informação"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Blocos informativos ao longo da página"})]})]}),e.jsxs("button",{onClick:B,className:"flex items-center gap-2 px-4 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600",children:[e.jsx(st,{size:18}),"Adicionar Seção"]})]}),I.infoSections&&I.infoSections.length>0?e.jsx("div",{className:"space-y-6",children:I.infoSections.map((S,R)=>e.jsxs("div",{className:"border-2 rounded-xl p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"font-bold text-lg",children:["Seção ",R+1]}),e.jsxs("div",{className:"flex items-center gap-2",children:[R>0&&e.jsx("button",{onClick:()=>ee(R,"up"),className:"p-2 hover:bg-gray-100 rounded-lg",title:"Mover para cima",children:e.jsx(Ht,{size:18})}),R<I.infoSections.length-1&&e.jsx("button",{onClick:()=>ee(R,"down"),className:"p-2 hover:bg-gray-100 rounded-lg",title:"Mover para baixo",children:e.jsx(Gt,{size:18})}),e.jsx("button",{onClick:()=>K(R),className:"p-2 text-red-500 hover:bg-red-50 rounded-lg",children:e.jsx(Pe,{size:18})})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Título"}),e.jsx("input",{type:"text",value:S.title,onChange:E=>h(R,"title",E.target.value),className:"w-full px-4 py-2 border-2 rounded-lg focus:border-primary outline-none",placeholder:"Título da seção"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Posição da Imagem"}),e.jsxs("select",{value:S.imagePosition||"right",onChange:E=>h(R,"imagePosition",E.target.value),className:"w-full px-4 py-2 border-2 rounded-lg focus:border-primary outline-none",children:[e.jsx("option",{value:"left",children:"Esquerda"}),e.jsx("option",{value:"right",children:"Direita"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Descrição"}),e.jsx("textarea",{value:S.description,onChange:E=>h(R,"description",E.target.value),rows:3,className:"w-full px-4 py-2 border-2 rounded-lg focus:border-primary outline-none resize-none",placeholder:"Descrição detalhada da seção"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Imagem (opcional)"}),e.jsxs("div",{className:"flex gap-4",children:[S.imageUrl&&e.jsxs("div",{className:"relative w-32 h-32 border-2 rounded-lg overflow-hidden",children:[e.jsx("img",{src:Ae(S.imageUrl,"thumbnail"),alt:"Preview",className:"w-full h-full object-cover"}),e.jsx("button",{onClick:()=>h(R,"imageUrl",void 0),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full hover:bg-red-600",children:e.jsx(ve,{size:14})})]}),e.jsxs("label",{className:"flex-1 flex flex-col items-center justify-center border-2 border-dashed rounded-lg p-4 cursor-pointer hover:border-primary hover:bg-primary/5 transition-colors",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:E=>{const Z=E.target.files?.[0];Z&&D(Z,R)},className:"hidden",disabled:o===R}),o===R?e.jsx(ke,{className:"animate-spin text-primary mb-2",size:32}):e.jsx(yt,{className:"text-gray-400 mb-2",size:32}),e.jsx("span",{className:"text-sm text-gray-600 text-center",children:o===R?"Enviando...":"Clique para fazer upload"})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-semibold",children:"Itens em Destaque"}),e.jsx("button",{onClick:()=>A(R),className:"text-sm text-primary hover:underline",children:"+ Adicionar Item"})]}),e.jsx("div",{className:"space-y-2",children:S.features?.map((E,Z)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:E,onChange:O=>F(R,Z,O.target.value),className:"flex-1 px-4 py-2 border-2 rounded-lg focus:border-primary outline-none",placeholder:`Item ${Z+1}`}),e.jsx("button",{onClick:()=>r(R,Z),className:"px-3 text-red-500 hover:bg-red-50 rounded-lg",children:e.jsx(ve,{size:18})})]},Z))})]})]},R))}):e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-xl",children:[e.jsx(ot,{className:"mx-auto text-gray-400 mb-3",size:48}),e.jsx("p",{className:"text-gray-600 font-semibold",children:"Nenhuma seção adicionada"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:'Clique em "Adicionar Seção" para começar'})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-500/10 rounded-lg flex items-center justify-center",children:e.jsx(We,{size:20,className:"text-orange-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:"Produtos em Destaque"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Selecione até 10 produtos para o carrossel"})]})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("p",{className:"text-sm font-semibold text-gray-700",children:["Selecionados: ",e.jsx("span",{className:"text-primary",children:p.length}),"/10"]})}),b?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(ke,{className:"animate-spin text-primary",size:32}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Carregando produtos..."})]}):k.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-xl",children:[e.jsx(We,{className:"mx-auto text-gray-400 mb-3",size:48}),e.jsx("p",{className:"text-gray-600 font-semibold",children:"Nenhum produto cadastrado"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Cadastre produtos primeiro na aba Produtos"})]}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4 max-h-[600px] overflow-y-auto p-2",children:k.map(S=>{const R=p.includes(S.id),E=S.thumb_url||S.imagem_url||S.variacoes?.[0]?.thumb_url,Z=E?Ae(E,"thumbnail"):"";return e.jsxs("button",{onClick:()=>T(S.id),disabled:!R&&p.length>=10,className:`relative group border-2 rounded-xl overflow-hidden transition-all ${R?"border-primary ring-2 ring-primary/20":"border-gray-200 hover:border-gray-300"} ${!R&&p.length>=10?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx("div",{className:"aspect-square bg-gray-100",children:Z?e.jsx("img",{src:Z,alt:S.nome,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(We,{size:24,className:"text-gray-400"})})}),e.jsxs("div",{className:"p-2 bg-white",children:[e.jsx("p",{className:"text-xs font-semibold line-clamp-2 text-left",children:S.nome}),e.jsxs("p",{className:"text-[10px] text-gray-500 text-left mt-1",children:["SKU: ",S.id]})]}),R&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-2 right-2 bg-primary text-white rounded-full p-1.5 shadow-lg",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),e.jsx("div",{className:"absolute top-2 left-2 bg-white text-primary rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold shadow-lg",children:p.indexOf(S.id)+1})]})]},S.id)})}),p.length>=10&&e.jsx("p",{className:"text-sm text-orange-600 mt-4 text-center font-semibold",children:"Limite máximo de produtos atingido"})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-green-500/10 rounded-lg flex items-center justify-center",children:e.jsx(Lt,{size:20,className:"text-green-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:"Estatísticas"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Números da empresa"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Produtos - Valor"}),e.jsx("input",{type:"text",value:I.stats?.products?.value||"",onChange:S=>$(R=>({...R,stats:{...R.stats,products:{...R.stats.products,value:S.target.value}}})),className:"w-full px-4 py-2 border-2 rounded-lg focus:border-primary outline-none",placeholder:"500+"}),e.jsx("label",{className:"block text-sm font-semibold mb-2 mt-2",children:"Produtos - Texto"}),e.jsx("input",{type:"text",value:I.stats?.products?.label||"",onChange:S=>$(R=>({...R,stats:{...R.stats,products:{...R.stats.products,label:S.target.value}}})),className:"w-full px-4 py-2 border-2 rounded-lg focus:border-primary outline-none",placeholder:"Produtos Disponíveis"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Clientes - Valor"}),e.jsx("input",{type:"text",value:I.stats?.clients?.value||"",onChange:S=>$(R=>({...R,stats:{...R.stats,clients:{...R.stats.clients,value:S.target.value}}})),className:"w-full px-4 py-2 border-2 rounded-lg focus:border-primary outline-none",placeholder:"1000+"}),e.jsx("label",{className:"block text-sm font-semibold mb-2 mt-2",children:"Clientes - Texto"}),e.jsx("input",{type:"text",value:I.stats?.clients?.label||"",onChange:S=>$(R=>({...R,stats:{...R.stats,clients:{...R.stats.clients,label:S.target.value}}})),className:"w-full px-4 py-2 border-2 rounded-lg focus:border-primary outline-none",placeholder:"Clientes Satisfeitos"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Experiência - Valor"}),e.jsx("input",{type:"text",value:I.stats?.years?.value||"",onChange:S=>$(R=>({...R,stats:{...R.stats,years:{...R.stats.years,value:S.target.value}}})),className:"w-full px-4 py-2 border-2 rounded-lg focus:border-primary outline-none",placeholder:"15+"}),e.jsx("label",{className:"block text-sm font-semibold mb-2 mt-2",children:"Experiência - Texto"}),e.jsx("input",{type:"text",value:I.stats?.years?.label||"",onChange:S=>$(R=>({...R,stats:{...R.stats,years:{...R.stats.years,label:S.target.value}}})),className:"w-full px-4 py-2 border-2 rounded-lg focus:border-primary outline-none",placeholder:"Anos de Experiência"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-500/10 rounded-lg flex items-center justify-center",children:e.jsx(Yt,{size:20,className:"text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:"Vídeos de Produção"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Exibidos abaixo das estatísticas"})]})]}),e.jsx(dr,{onSubmit:M,loading:x==="video"}),I.videos.length>0&&e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4 mt-6",children:I.videos.map((S,R)=>e.jsxs("div",{className:"border-2 rounded-xl overflow-hidden group",children:[e.jsx("div",{className:"relative aspect-video bg-gray-900",children:e.jsx("video",{src:S.url,className:"w-full h-full object-cover",muted:!0})}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-bold mb-1",children:S.title}),e.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:S.description}),e.jsx("button",{onClick:()=>y(R),className:"text-red-500 text-sm hover:underline",children:"Remover"})]})]},R))})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-pink-500/10 rounded-lg flex items-center justify-center",children:e.jsx(_t,{size:20,className:"text-pink-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:"Call to Action Final"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Seção de conversão no final da página"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Título"}),e.jsx("input",{type:"text",value:I.cta.title,onChange:S=>$(R=>({...R,cta:{...R.cta,title:S.target.value}})),className:"w-full px-4 py-3 border-2 rounded-xl focus:border-primary outline-none",placeholder:"Pronto para Começar?"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Descrição"}),e.jsx("textarea",{value:I.cta.description,onChange:S=>$(R=>({...R,cta:{...R.cta,description:S.target.value}})),rows:3,className:"w-full px-4 py-3 border-2 rounded-xl focus:border-primary outline-none resize-none",placeholder:"Solicite um orçamento personalizado..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Texto do Botão"}),e.jsx("input",{type:"text",value:I.cta.buttonText,onChange:S=>$(R=>({...R,cta:{...R.cta,buttonText:S.target.value}})),className:"w-full px-4 py-3 border-2 rounded-xl focus:border-primary outline-none",placeholder:"Ver Catálogo Completo"})]})]})]}),e.jsxs("button",{onClick:z,disabled:d,className:"w-full flex items-center justify-center gap-3 bg-primary text-white py-4 rounded-xl font-bold hover:opacity-90 disabled:opacity-50",children:[d?e.jsx(ke,{className:"animate-spin",size:20}):e.jsx(Ke,{size:20}),"Salvar Landing Page"]})]})}function dr({onSubmit:I,loading:$}){const[d,C]=J.useState(""),[x,l]=J.useState(""),[o,s]=J.useState(""),[i,_]=J.useState(""),k=()=>{d&&o&&i&&(I(d,x,o,i),C(""),l(""),s(""),_(""))};return e.jsxs("div",{className:"border-2 border-dashed rounded-xl p-6 space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Título"}),e.jsx("input",{type:"text",value:o,onChange:w=>s(w.target.value),className:"w-full px-4 py-2 border-2 rounded-lg outline-none focus:border-primary",placeholder:"Ex: Processo de Personalização"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Descrição"}),e.jsx("input",{type:"text",value:i,onChange:w=>_(w.target.value),className:"w-full px-4 py-2 border-2 rounded-lg outline-none focus:border-primary",placeholder:"Breve descrição do vídeo"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"URL do Vídeo"}),e.jsx("input",{type:"url",value:d,onChange:w=>C(w.target.value),className:"w-full px-4 py-2 border-2 rounded-lg outline-none focus:border-primary",placeholder:"https://seusite.com/videos/video-producao.mp4"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Cole a URL completa do vídeo hospedado"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"URL da Thumbnail (opcional)"}),e.jsx("input",{type:"url",value:x,onChange:w=>l(w.target.value),className:"w-full px-4 py-2 border-2 rounded-lg outline-none focus:border-primary",placeholder:"https://seusite.com/videos/thumb-producao.jpg"})]})]}),e.jsx("button",{onClick:k,disabled:!d||!o||!i||$,className:"w-full bg-primary text-white py-3 rounded-lg font-semibold disabled:opacity-50",children:$?"Adicionando...":"Adicionar Vídeo"})]})}function Ze(I){throw new Error('Could not dynamically require "'+I+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Xe={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var ht;function ur(){return ht||(ht=1,(function(I,$){(function(d){I.exports=d()})(function(){return(function d(C,x,l){function o(_,k){if(!x[_]){if(!C[_]){var w=typeof Ze=="function"&&Ze;if(!k&&w)return w(_,!0);if(s)return s(_,!0);var p=new Error("Cannot find module '"+_+"'");throw p.code="MODULE_NOT_FOUND",p}var a=x[_]={exports:{}};C[_][0].call(a.exports,function(b){var n=C[_][1][b];return o(n||b)},a,a.exports,d,C,x,l)}return x[_].exports}for(var s=typeof Ze=="function"&&Ze,i=0;i<l.length;i++)o(l[i]);return o})({1:[function(d,C,x){var l=d("./utils"),o=d("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";x.encode=function(i){for(var _,k,w,p,a,b,n,f=[],c=0,u=i.length,N=u,z=l.getTypeOf(i)!=="string";c<i.length;)N=u-c,w=z?(_=i[c++],k=c<u?i[c++]:0,c<u?i[c++]:0):(_=i.charCodeAt(c++),k=c<u?i.charCodeAt(c++):0,c<u?i.charCodeAt(c++):0),p=_>>2,a=(3&_)<<4|k>>4,b=1<N?(15&k)<<2|w>>6:64,n=2<N?63&w:64,f.push(s.charAt(p)+s.charAt(a)+s.charAt(b)+s.charAt(n));return f.join("")},x.decode=function(i){var _,k,w,p,a,b,n=0,f=0,c="data:";if(i.substr(0,c.length)===c)throw new Error("Invalid base64 input, it looks like a data url.");var u,N=3*(i=i.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(i.charAt(i.length-1)===s.charAt(64)&&N--,i.charAt(i.length-2)===s.charAt(64)&&N--,N%1!=0)throw new Error("Invalid base64 input, bad content length.");for(u=o.uint8array?new Uint8Array(0|N):new Array(0|N);n<i.length;)_=s.indexOf(i.charAt(n++))<<2|(p=s.indexOf(i.charAt(n++)))>>4,k=(15&p)<<4|(a=s.indexOf(i.charAt(n++)))>>2,w=(3&a)<<6|(b=s.indexOf(i.charAt(n++))),u[f++]=_,a!==64&&(u[f++]=k),b!==64&&(u[f++]=w);return u}},{"./support":30,"./utils":32}],2:[function(d,C,x){var l=d("./external"),o=d("./stream/DataWorker"),s=d("./stream/Crc32Probe"),i=d("./stream/DataLengthProbe");function _(k,w,p,a,b){this.compressedSize=k,this.uncompressedSize=w,this.crc32=p,this.compression=a,this.compressedContent=b}_.prototype={getContentWorker:function(){var k=new o(l.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new i("data_length")),w=this;return k.on("end",function(){if(this.streamInfo.data_length!==w.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),k},getCompressedWorker:function(){return new o(l.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},_.createWorkerFrom=function(k,w,p){return k.pipe(new s).pipe(new i("uncompressedSize")).pipe(w.compressWorker(p)).pipe(new i("compressedSize")).withStreamInfo("compression",w)},C.exports=_},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(d,C,x){var l=d("./stream/GenericWorker");x.STORE={magic:"\0\0",compressWorker:function(){return new l("STORE compression")},uncompressWorker:function(){return new l("STORE decompression")}},x.DEFLATE=d("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(d,C,x){var l=d("./utils"),o=(function(){for(var s,i=[],_=0;_<256;_++){s=_;for(var k=0;k<8;k++)s=1&s?3988292384^s>>>1:s>>>1;i[_]=s}return i})();C.exports=function(s,i){return s!==void 0&&s.length?l.getTypeOf(s)!=="string"?(function(_,k,w,p){var a=o,b=p+w;_^=-1;for(var n=p;n<b;n++)_=_>>>8^a[255&(_^k[n])];return-1^_})(0|i,s,s.length,0):(function(_,k,w,p){var a=o,b=p+w;_^=-1;for(var n=p;n<b;n++)_=_>>>8^a[255&(_^k.charCodeAt(n))];return-1^_})(0|i,s,s.length,0):0}},{"./utils":32}],5:[function(d,C,x){x.base64=!1,x.binary=!1,x.dir=!1,x.createFolders=!0,x.date=null,x.compression=null,x.compressionOptions=null,x.comment=null,x.unixPermissions=null,x.dosPermissions=null},{}],6:[function(d,C,x){var l=null;l=typeof Promise<"u"?Promise:d("lie"),C.exports={Promise:l}},{lie:37}],7:[function(d,C,x){var l=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",o=d("pako"),s=d("./utils"),i=d("./stream/GenericWorker"),_=l?"uint8array":"array";function k(w,p){i.call(this,"FlateWorker/"+w),this._pako=null,this._pakoAction=w,this._pakoOptions=p,this.meta={}}x.magic="\b\0",s.inherits(k,i),k.prototype.processChunk=function(w){this.meta=w.meta,this._pako===null&&this._createPako(),this._pako.push(s.transformTo(_,w.data),!1)},k.prototype.flush=function(){i.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},k.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this._pako=null},k.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var w=this;this._pako.onData=function(p){w.push({data:p,meta:w.meta})}},x.compressWorker=function(w){return new k("Deflate",w)},x.uncompressWorker=function(){return new k("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(d,C,x){function l(a,b){var n,f="";for(n=0;n<b;n++)f+=String.fromCharCode(255&a),a>>>=8;return f}function o(a,b,n,f,c,u){var N,z,j=a.file,T=a.compression,D=u!==_.utf8encode,M=s.transformTo("string",u(j.name)),y=s.transformTo("string",_.utf8encode(j.name)),B=j.comment,K=s.transformTo("string",u(B)),h=s.transformTo("string",_.utf8encode(B)),A=y.length!==j.name.length,r=h.length!==B.length,F="",ee="",S="",R=j.dir,E=j.date,Z={crc32:0,compressedSize:0,uncompressedSize:0};b&&!n||(Z.crc32=a.crc32,Z.compressedSize=a.compressedSize,Z.uncompressedSize=a.uncompressedSize);var O=0;b&&(O|=8),D||!A&&!r||(O|=2048);var m=0,V=0;R&&(m|=16),c==="UNIX"?(V=798,m|=(function(W,ne){var se=W;return W||(se=ne?16893:33204),(65535&se)<<16})(j.unixPermissions,R)):(V=20,m|=(function(W){return 63&(W||0)})(j.dosPermissions)),N=E.getUTCHours(),N<<=6,N|=E.getUTCMinutes(),N<<=5,N|=E.getUTCSeconds()/2,z=E.getUTCFullYear()-1980,z<<=4,z|=E.getUTCMonth()+1,z<<=5,z|=E.getUTCDate(),A&&(ee=l(1,1)+l(k(M),4)+y,F+="up"+l(ee.length,2)+ee),r&&(S=l(1,1)+l(k(K),4)+h,F+="uc"+l(S.length,2)+S);var G="";return G+=`
\0`,G+=l(O,2),G+=T.magic,G+=l(N,2),G+=l(z,2),G+=l(Z.crc32,4),G+=l(Z.compressedSize,4),G+=l(Z.uncompressedSize,4),G+=l(M.length,2),G+=l(F.length,2),{fileRecord:w.LOCAL_FILE_HEADER+G+M+F,dirRecord:w.CENTRAL_FILE_HEADER+l(V,2)+G+l(K.length,2)+"\0\0\0\0"+l(m,4)+l(f,4)+M+F+K}}var s=d("../utils"),i=d("../stream/GenericWorker"),_=d("../utf8"),k=d("../crc32"),w=d("../signature");function p(a,b,n,f){i.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=b,this.zipPlatform=n,this.encodeFileName=f,this.streamFiles=a,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(p,i),p.prototype.push=function(a){var b=a.meta.percent||0,n=this.entriesCount,f=this._sources.length;this.accumulate?this.contentBuffer.push(a):(this.bytesWritten+=a.data.length,i.prototype.push.call(this,{data:a.data,meta:{currentFile:this.currentFile,percent:n?(b+100*(n-f-1))/n:100}}))},p.prototype.openedSource=function(a){this.currentSourceOffset=this.bytesWritten,this.currentFile=a.file.name;var b=this.streamFiles&&!a.file.dir;if(b){var n=o(a,b,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:n.fileRecord,meta:{percent:0}})}else this.accumulate=!0},p.prototype.closedSource=function(a){this.accumulate=!1;var b=this.streamFiles&&!a.file.dir,n=o(a,b,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(n.dirRecord),b)this.push({data:(function(f){return w.DATA_DESCRIPTOR+l(f.crc32,4)+l(f.compressedSize,4)+l(f.uncompressedSize,4)})(a),meta:{percent:100}});else for(this.push({data:n.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},p.prototype.flush=function(){for(var a=this.bytesWritten,b=0;b<this.dirRecords.length;b++)this.push({data:this.dirRecords[b],meta:{percent:100}});var n=this.bytesWritten-a,f=(function(c,u,N,z,j){var T=s.transformTo("string",j(z));return w.CENTRAL_DIRECTORY_END+"\0\0\0\0"+l(c,2)+l(c,2)+l(u,4)+l(N,4)+l(T.length,2)+T})(this.dirRecords.length,n,a,this.zipComment,this.encodeFileName);this.push({data:f,meta:{percent:100}})},p.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},p.prototype.registerPrevious=function(a){this._sources.push(a);var b=this;return a.on("data",function(n){b.processChunk(n)}),a.on("end",function(){b.closedSource(b.previous.streamInfo),b._sources.length?b.prepareNextSource():b.end()}),a.on("error",function(n){b.error(n)}),this},p.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},p.prototype.error=function(a){var b=this._sources;if(!i.prototype.error.call(this,a))return!1;for(var n=0;n<b.length;n++)try{b[n].error(a)}catch{}return!0},p.prototype.lock=function(){i.prototype.lock.call(this);for(var a=this._sources,b=0;b<a.length;b++)a[b].lock()},C.exports=p},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(d,C,x){var l=d("../compressions"),o=d("./ZipFileWorker");x.generateWorker=function(s,i,_){var k=new o(i.streamFiles,_,i.platform,i.encodeFileName),w=0;try{s.forEach(function(p,a){w++;var b=(function(u,N){var z=u||N,j=l[z];if(!j)throw new Error(z+" is not a valid compression method !");return j})(a.options.compression,i.compression),n=a.options.compressionOptions||i.compressionOptions||{},f=a.dir,c=a.date;a._compressWorker(b,n).withStreamInfo("file",{name:p,dir:f,date:c,comment:a.comment||"",unixPermissions:a.unixPermissions,dosPermissions:a.dosPermissions}).pipe(k)}),k.entriesCount=w}catch(p){k.error(p)}return k}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(d,C,x){function l(){if(!(this instanceof l))return new l;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var o=new l;for(var s in this)typeof this[s]!="function"&&(o[s]=this[s]);return o}}(l.prototype=d("./object")).loadAsync=d("./load"),l.support=d("./support"),l.defaults=d("./defaults"),l.version="3.10.1",l.loadAsync=function(o,s){return new l().loadAsync(o,s)},l.external=d("./external"),C.exports=l},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(d,C,x){var l=d("./utils"),o=d("./external"),s=d("./utf8"),i=d("./zipEntries"),_=d("./stream/Crc32Probe"),k=d("./nodejsUtils");function w(p){return new o.Promise(function(a,b){var n=p.decompressed.getContentWorker().pipe(new _);n.on("error",function(f){b(f)}).on("end",function(){n.streamInfo.crc32!==p.decompressed.crc32?b(new Error("Corrupted zip : CRC32 mismatch")):a()}).resume()})}C.exports=function(p,a){var b=this;return a=l.extend(a||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),k.isNode&&k.isStream(p)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):l.prepareContent("the loaded zip file",p,!0,a.optimizedBinaryString,a.base64).then(function(n){var f=new i(a);return f.load(n),f}).then(function(n){var f=[o.Promise.resolve(n)],c=n.files;if(a.checkCRC32)for(var u=0;u<c.length;u++)f.push(w(c[u]));return o.Promise.all(f)}).then(function(n){for(var f=n.shift(),c=f.files,u=0;u<c.length;u++){var N=c[u],z=N.fileNameStr,j=l.resolve(N.fileNameStr);b.file(j,N.decompressed,{binary:!0,optimizedBinaryString:!0,date:N.date,dir:N.dir,comment:N.fileCommentStr.length?N.fileCommentStr:null,unixPermissions:N.unixPermissions,dosPermissions:N.dosPermissions,createFolders:a.createFolders}),N.dir||(b.file(j).unsafeOriginalName=z)}return f.zipComment.length&&(b.comment=f.zipComment),b})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(d,C,x){var l=d("../utils"),o=d("../stream/GenericWorker");function s(i,_){o.call(this,"Nodejs stream input adapter for "+i),this._upstreamEnded=!1,this._bindStream(_)}l.inherits(s,o),s.prototype._bindStream=function(i){var _=this;(this._stream=i).pause(),i.on("data",function(k){_.push({data:k,meta:{percent:0}})}).on("error",function(k){_.isPaused?this.generatedError=k:_.error(k)}).on("end",function(){_.isPaused?_._upstreamEnded=!0:_.end()})},s.prototype.pause=function(){return!!o.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},C.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(d,C,x){var l=d("readable-stream").Readable;function o(s,i,_){l.call(this,i),this._helper=s;var k=this;s.on("data",function(w,p){k.push(w)||k._helper.pause(),_&&_(p)}).on("error",function(w){k.emit("error",w)}).on("end",function(){k.push(null)})}d("../utils").inherits(o,l),o.prototype._read=function(){this._helper.resume()},C.exports=o},{"../utils":32,"readable-stream":16}],14:[function(d,C,x){C.exports={isNode:typeof Buffer<"u",newBufferFrom:function(l,o){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(l,o);if(typeof l=="number")throw new Error('The "data" argument must not be a number');return new Buffer(l,o)},allocBuffer:function(l){if(Buffer.alloc)return Buffer.alloc(l);var o=new Buffer(l);return o.fill(0),o},isBuffer:function(l){return Buffer.isBuffer(l)},isStream:function(l){return l&&typeof l.on=="function"&&typeof l.pause=="function"&&typeof l.resume=="function"}}},{}],15:[function(d,C,x){function l(j,T,D){var M,y=s.getTypeOf(T),B=s.extend(D||{},k);B.date=B.date||new Date,B.compression!==null&&(B.compression=B.compression.toUpperCase()),typeof B.unixPermissions=="string"&&(B.unixPermissions=parseInt(B.unixPermissions,8)),B.unixPermissions&&16384&B.unixPermissions&&(B.dir=!0),B.dosPermissions&&16&B.dosPermissions&&(B.dir=!0),B.dir&&(j=c(j)),B.createFolders&&(M=f(j))&&u.call(this,M,!0);var K=y==="string"&&B.binary===!1&&B.base64===!1;D&&D.binary!==void 0||(B.binary=!K),(T instanceof w&&T.uncompressedSize===0||B.dir||!T||T.length===0)&&(B.base64=!1,B.binary=!0,T="",B.compression="STORE",y="string");var h=null;h=T instanceof w||T instanceof i?T:b.isNode&&b.isStream(T)?new n(j,T):s.prepareContent(j,T,B.binary,B.optimizedBinaryString,B.base64);var A=new p(j,h,B);this.files[j]=A}var o=d("./utf8"),s=d("./utils"),i=d("./stream/GenericWorker"),_=d("./stream/StreamHelper"),k=d("./defaults"),w=d("./compressedObject"),p=d("./zipObject"),a=d("./generate"),b=d("./nodejsUtils"),n=d("./nodejs/NodejsStreamInputAdapter"),f=function(j){j.slice(-1)==="/"&&(j=j.substring(0,j.length-1));var T=j.lastIndexOf("/");return 0<T?j.substring(0,T):""},c=function(j){return j.slice(-1)!=="/"&&(j+="/"),j},u=function(j,T){return T=T!==void 0?T:k.createFolders,j=c(j),this.files[j]||l.call(this,j,null,{dir:!0,createFolders:T}),this.files[j]};function N(j){return Object.prototype.toString.call(j)==="[object RegExp]"}var z={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(j){var T,D,M;for(T in this.files)M=this.files[T],(D=T.slice(this.root.length,T.length))&&T.slice(0,this.root.length)===this.root&&j(D,M)},filter:function(j){var T=[];return this.forEach(function(D,M){j(D,M)&&T.push(M)}),T},file:function(j,T,D){if(arguments.length!==1)return j=this.root+j,l.call(this,j,T,D),this;if(N(j)){var M=j;return this.filter(function(B,K){return!K.dir&&M.test(B)})}var y=this.files[this.root+j];return y&&!y.dir?y:null},folder:function(j){if(!j)return this;if(N(j))return this.filter(function(y,B){return B.dir&&j.test(y)});var T=this.root+j,D=u.call(this,T),M=this.clone();return M.root=D.name,M},remove:function(j){j=this.root+j;var T=this.files[j];if(T||(j.slice(-1)!=="/"&&(j+="/"),T=this.files[j]),T&&!T.dir)delete this.files[j];else for(var D=this.filter(function(y,B){return B.name.slice(0,j.length)===j}),M=0;M<D.length;M++)delete this.files[D[M].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(j){var T,D={};try{if((D=s.extend(j||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=D.type.toLowerCase(),D.compression=D.compression.toUpperCase(),D.type==="binarystring"&&(D.type="string"),!D.type)throw new Error("No output type specified.");s.checkSupport(D.type),D.platform!=="darwin"&&D.platform!=="freebsd"&&D.platform!=="linux"&&D.platform!=="sunos"||(D.platform="UNIX"),D.platform==="win32"&&(D.platform="DOS");var M=D.comment||this.comment||"";T=a.generateWorker(this,D,M)}catch(y){(T=new i("error")).error(y)}return new _(T,D.type||"string",D.mimeType)},generateAsync:function(j,T){return this.generateInternalStream(j).accumulate(T)},generateNodeStream:function(j,T){return(j=j||{}).type||(j.type="nodebuffer"),this.generateInternalStream(j).toNodejsStream(T)}};C.exports=z},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(d,C,x){C.exports=d("stream")},{stream:void 0}],17:[function(d,C,x){var l=d("./DataReader");function o(s){l.call(this,s);for(var i=0;i<this.data.length;i++)s[i]=255&s[i]}d("../utils").inherits(o,l),o.prototype.byteAt=function(s){return this.data[this.zero+s]},o.prototype.lastIndexOfSignature=function(s){for(var i=s.charCodeAt(0),_=s.charCodeAt(1),k=s.charCodeAt(2),w=s.charCodeAt(3),p=this.length-4;0<=p;--p)if(this.data[p]===i&&this.data[p+1]===_&&this.data[p+2]===k&&this.data[p+3]===w)return p-this.zero;return-1},o.prototype.readAndCheckSignature=function(s){var i=s.charCodeAt(0),_=s.charCodeAt(1),k=s.charCodeAt(2),w=s.charCodeAt(3),p=this.readData(4);return i===p[0]&&_===p[1]&&k===p[2]&&w===p[3]},o.prototype.readData=function(s){if(this.checkOffset(s),s===0)return[];var i=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,i},C.exports=o},{"../utils":32,"./DataReader":18}],18:[function(d,C,x){var l=d("../utils");function o(s){this.data=s,this.length=s.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(s){this.checkIndex(this.index+s)},checkIndex:function(s){if(this.length<this.zero+s||s<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+s+"). Corrupted zip ?")},setIndex:function(s){this.checkIndex(s),this.index=s},skip:function(s){this.setIndex(this.index+s)},byteAt:function(){},readInt:function(s){var i,_=0;for(this.checkOffset(s),i=this.index+s-1;i>=this.index;i--)_=(_<<8)+this.byteAt(i);return this.index+=s,_},readString:function(s){return l.transformTo("string",this.readData(s))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var s=this.readInt(4);return new Date(Date.UTC(1980+(s>>25&127),(s>>21&15)-1,s>>16&31,s>>11&31,s>>5&63,(31&s)<<1))}},C.exports=o},{"../utils":32}],19:[function(d,C,x){var l=d("./Uint8ArrayReader");function o(s){l.call(this,s)}d("../utils").inherits(o,l),o.prototype.readData=function(s){this.checkOffset(s);var i=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,i},C.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(d,C,x){var l=d("./DataReader");function o(s){l.call(this,s)}d("../utils").inherits(o,l),o.prototype.byteAt=function(s){return this.data.charCodeAt(this.zero+s)},o.prototype.lastIndexOfSignature=function(s){return this.data.lastIndexOf(s)-this.zero},o.prototype.readAndCheckSignature=function(s){return s===this.readData(4)},o.prototype.readData=function(s){this.checkOffset(s);var i=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,i},C.exports=o},{"../utils":32,"./DataReader":18}],21:[function(d,C,x){var l=d("./ArrayReader");function o(s){l.call(this,s)}d("../utils").inherits(o,l),o.prototype.readData=function(s){if(this.checkOffset(s),s===0)return new Uint8Array(0);var i=this.data.subarray(this.zero+this.index,this.zero+this.index+s);return this.index+=s,i},C.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(d,C,x){var l=d("../utils"),o=d("../support"),s=d("./ArrayReader"),i=d("./StringReader"),_=d("./NodeBufferReader"),k=d("./Uint8ArrayReader");C.exports=function(w){var p=l.getTypeOf(w);return l.checkSupport(p),p!=="string"||o.uint8array?p==="nodebuffer"?new _(w):o.uint8array?new k(l.transformTo("uint8array",w)):new s(l.transformTo("array",w)):new i(w)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(d,C,x){x.LOCAL_FILE_HEADER="PK",x.CENTRAL_FILE_HEADER="PK",x.CENTRAL_DIRECTORY_END="PK",x.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",x.ZIP64_CENTRAL_DIRECTORY_END="PK",x.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(d,C,x){var l=d("./GenericWorker"),o=d("../utils");function s(i){l.call(this,"ConvertWorker to "+i),this.destType=i}o.inherits(s,l),s.prototype.processChunk=function(i){this.push({data:o.transformTo(this.destType,i.data),meta:i.meta})},C.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(d,C,x){var l=d("./GenericWorker"),o=d("../crc32");function s(){l.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}d("../utils").inherits(s,l),s.prototype.processChunk=function(i){this.streamInfo.crc32=o(i.data,this.streamInfo.crc32||0),this.push(i)},C.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(d,C,x){var l=d("../utils"),o=d("./GenericWorker");function s(i){o.call(this,"DataLengthProbe for "+i),this.propName=i,this.withStreamInfo(i,0)}l.inherits(s,o),s.prototype.processChunk=function(i){if(i){var _=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=_+i.data.length}o.prototype.processChunk.call(this,i)},C.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(d,C,x){var l=d("../utils"),o=d("./GenericWorker");function s(i){o.call(this,"DataWorker");var _=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,i.then(function(k){_.dataIsReady=!0,_.data=k,_.max=k&&k.length||0,_.type=l.getTypeOf(k),_.isPaused||_._tickAndRepeat()},function(k){_.error(k)})}l.inherits(s,o),s.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,l.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(l.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var i=null,_=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":i=this.data.substring(this.index,_);break;case"uint8array":i=this.data.subarray(this.index,_);break;case"array":case"nodebuffer":i=this.data.slice(this.index,_)}return this.index=_,this.push({data:i,meta:{percent:this.max?this.index/this.max*100:0}})},C.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(d,C,x){function l(o){this.name=o||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}l.prototype={push:function(o){this.emit("data",o)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(o){this.emit("error",o)}return!0},error:function(o){return!this.isFinished&&(this.isPaused?this.generatedError=o:(this.isFinished=!0,this.emit("error",o),this.previous&&this.previous.error(o),this.cleanUp()),!0)},on:function(o,s){return this._listeners[o].push(s),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(o,s){if(this._listeners[o])for(var i=0;i<this._listeners[o].length;i++)this._listeners[o][i].call(this,s)},pipe:function(o){return o.registerPrevious(this)},registerPrevious:function(o){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=o.streamInfo,this.mergeStreamInfo(),this.previous=o;var s=this;return o.on("data",function(i){s.processChunk(i)}),o.on("end",function(){s.end()}),o.on("error",function(i){s.error(i)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var o=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),o=!0),this.previous&&this.previous.resume(),!o},flush:function(){},processChunk:function(o){this.push(o)},withStreamInfo:function(o,s){return this.extraStreamInfo[o]=s,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var o in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,o)&&(this.streamInfo[o]=this.extraStreamInfo[o])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var o="Worker "+this.name;return this.previous?this.previous+" -> "+o:o}},C.exports=l},{}],29:[function(d,C,x){var l=d("../utils"),o=d("./ConvertWorker"),s=d("./GenericWorker"),i=d("../base64"),_=d("../support"),k=d("../external"),w=null;if(_.nodestream)try{w=d("../nodejs/NodejsStreamOutputAdapter")}catch{}function p(b,n){return new k.Promise(function(f,c){var u=[],N=b._internalType,z=b._outputType,j=b._mimeType;b.on("data",function(T,D){u.push(T),n&&n(D)}).on("error",function(T){u=[],c(T)}).on("end",function(){try{var T=(function(D,M,y){switch(D){case"blob":return l.newBlob(l.transformTo("arraybuffer",M),y);case"base64":return i.encode(M);default:return l.transformTo(D,M)}})(z,(function(D,M){var y,B=0,K=null,h=0;for(y=0;y<M.length;y++)h+=M[y].length;switch(D){case"string":return M.join("");case"array":return Array.prototype.concat.apply([],M);case"uint8array":for(K=new Uint8Array(h),y=0;y<M.length;y++)K.set(M[y],B),B+=M[y].length;return K;case"nodebuffer":return Buffer.concat(M);default:throw new Error("concat : unsupported type '"+D+"'")}})(N,u),j);f(T)}catch(D){c(D)}u=[]}).resume()})}function a(b,n,f){var c=n;switch(n){case"blob":case"arraybuffer":c="uint8array";break;case"base64":c="string"}try{this._internalType=c,this._outputType=n,this._mimeType=f,l.checkSupport(c),this._worker=b.pipe(new o(c)),b.lock()}catch(u){this._worker=new s("error"),this._worker.error(u)}}a.prototype={accumulate:function(b){return p(this,b)},on:function(b,n){var f=this;return b==="data"?this._worker.on(b,function(c){n.call(f,c.data,c.meta)}):this._worker.on(b,function(){l.delay(n,arguments,f)}),this},resume:function(){return l.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(b){if(l.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new w(this,{objectMode:this._outputType!=="nodebuffer"},b)}},C.exports=a},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(d,C,x){if(x.base64=!0,x.array=!0,x.string=!0,x.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",x.nodebuffer=typeof Buffer<"u",x.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")x.blob=!1;else{var l=new ArrayBuffer(0);try{x.blob=new Blob([l],{type:"application/zip"}).size===0}catch{try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);o.append(l),x.blob=o.getBlob("application/zip").size===0}catch{x.blob=!1}}}try{x.nodestream=!!d("readable-stream").Readable}catch{x.nodestream=!1}},{"readable-stream":16}],31:[function(d,C,x){for(var l=d("./utils"),o=d("./support"),s=d("./nodejsUtils"),i=d("./stream/GenericWorker"),_=new Array(256),k=0;k<256;k++)_[k]=252<=k?6:248<=k?5:240<=k?4:224<=k?3:192<=k?2:1;_[254]=_[254]=1;function w(){i.call(this,"utf-8 decode"),this.leftOver=null}function p(){i.call(this,"utf-8 encode")}x.utf8encode=function(a){return o.nodebuffer?s.newBufferFrom(a,"utf-8"):(function(b){var n,f,c,u,N,z=b.length,j=0;for(u=0;u<z;u++)(64512&(f=b.charCodeAt(u)))==55296&&u+1<z&&(64512&(c=b.charCodeAt(u+1)))==56320&&(f=65536+(f-55296<<10)+(c-56320),u++),j+=f<128?1:f<2048?2:f<65536?3:4;for(n=o.uint8array?new Uint8Array(j):new Array(j),u=N=0;N<j;u++)(64512&(f=b.charCodeAt(u)))==55296&&u+1<z&&(64512&(c=b.charCodeAt(u+1)))==56320&&(f=65536+(f-55296<<10)+(c-56320),u++),f<128?n[N++]=f:(f<2048?n[N++]=192|f>>>6:(f<65536?n[N++]=224|f>>>12:(n[N++]=240|f>>>18,n[N++]=128|f>>>12&63),n[N++]=128|f>>>6&63),n[N++]=128|63&f);return n})(a)},x.utf8decode=function(a){return o.nodebuffer?l.transformTo("nodebuffer",a).toString("utf-8"):(function(b){var n,f,c,u,N=b.length,z=new Array(2*N);for(n=f=0;n<N;)if((c=b[n++])<128)z[f++]=c;else if(4<(u=_[c]))z[f++]=65533,n+=u-1;else{for(c&=u===2?31:u===3?15:7;1<u&&n<N;)c=c<<6|63&b[n++],u--;1<u?z[f++]=65533:c<65536?z[f++]=c:(c-=65536,z[f++]=55296|c>>10&1023,z[f++]=56320|1023&c)}return z.length!==f&&(z.subarray?z=z.subarray(0,f):z.length=f),l.applyFromCharCode(z)})(a=l.transformTo(o.uint8array?"uint8array":"array",a))},l.inherits(w,i),w.prototype.processChunk=function(a){var b=l.transformTo(o.uint8array?"uint8array":"array",a.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var n=b;(b=new Uint8Array(n.length+this.leftOver.length)).set(this.leftOver,0),b.set(n,this.leftOver.length)}else b=this.leftOver.concat(b);this.leftOver=null}var f=(function(u,N){var z;for((N=N||u.length)>u.length&&(N=u.length),z=N-1;0<=z&&(192&u[z])==128;)z--;return z<0||z===0?N:z+_[u[z]]>N?z:N})(b),c=b;f!==b.length&&(o.uint8array?(c=b.subarray(0,f),this.leftOver=b.subarray(f,b.length)):(c=b.slice(0,f),this.leftOver=b.slice(f,b.length))),this.push({data:x.utf8decode(c),meta:a.meta})},w.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:x.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},x.Utf8DecodeWorker=w,l.inherits(p,i),p.prototype.processChunk=function(a){this.push({data:x.utf8encode(a.data),meta:a.meta})},x.Utf8EncodeWorker=p},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(d,C,x){var l=d("./support"),o=d("./base64"),s=d("./nodejsUtils"),i=d("./external");function _(n){return n}function k(n,f){for(var c=0;c<n.length;++c)f[c]=255&n.charCodeAt(c);return f}d("setimmediate"),x.newBlob=function(n,f){x.checkSupport("blob");try{return new Blob([n],{type:f})}catch{try{var c=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return c.append(n),c.getBlob(f)}catch{throw new Error("Bug : can't construct the Blob.")}}};var w={stringifyByChunk:function(n,f,c){var u=[],N=0,z=n.length;if(z<=c)return String.fromCharCode.apply(null,n);for(;N<z;)f==="array"||f==="nodebuffer"?u.push(String.fromCharCode.apply(null,n.slice(N,Math.min(N+c,z)))):u.push(String.fromCharCode.apply(null,n.subarray(N,Math.min(N+c,z)))),N+=c;return u.join("")},stringifyByChar:function(n){for(var f="",c=0;c<n.length;c++)f+=String.fromCharCode(n[c]);return f},applyCanBeUsed:{uint8array:(function(){try{return l.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return l.nodebuffer&&String.fromCharCode.apply(null,s.allocBuffer(1)).length===1}catch{return!1}})()}};function p(n){var f=65536,c=x.getTypeOf(n),u=!0;if(c==="uint8array"?u=w.applyCanBeUsed.uint8array:c==="nodebuffer"&&(u=w.applyCanBeUsed.nodebuffer),u)for(;1<f;)try{return w.stringifyByChunk(n,c,f)}catch{f=Math.floor(f/2)}return w.stringifyByChar(n)}function a(n,f){for(var c=0;c<n.length;c++)f[c]=n[c];return f}x.applyFromCharCode=p;var b={};b.string={string:_,array:function(n){return k(n,new Array(n.length))},arraybuffer:function(n){return b.string.uint8array(n).buffer},uint8array:function(n){return k(n,new Uint8Array(n.length))},nodebuffer:function(n){return k(n,s.allocBuffer(n.length))}},b.array={string:p,array:_,arraybuffer:function(n){return new Uint8Array(n).buffer},uint8array:function(n){return new Uint8Array(n)},nodebuffer:function(n){return s.newBufferFrom(n)}},b.arraybuffer={string:function(n){return p(new Uint8Array(n))},array:function(n){return a(new Uint8Array(n),new Array(n.byteLength))},arraybuffer:_,uint8array:function(n){return new Uint8Array(n)},nodebuffer:function(n){return s.newBufferFrom(new Uint8Array(n))}},b.uint8array={string:p,array:function(n){return a(n,new Array(n.length))},arraybuffer:function(n){return n.buffer},uint8array:_,nodebuffer:function(n){return s.newBufferFrom(n)}},b.nodebuffer={string:p,array:function(n){return a(n,new Array(n.length))},arraybuffer:function(n){return b.nodebuffer.uint8array(n).buffer},uint8array:function(n){return a(n,new Uint8Array(n.length))},nodebuffer:_},x.transformTo=function(n,f){if(f=f||"",!n)return f;x.checkSupport(n);var c=x.getTypeOf(f);return b[c][n](f)},x.resolve=function(n){for(var f=n.split("/"),c=[],u=0;u<f.length;u++){var N=f[u];N==="."||N===""&&u!==0&&u!==f.length-1||(N===".."?c.pop():c.push(N))}return c.join("/")},x.getTypeOf=function(n){return typeof n=="string"?"string":Object.prototype.toString.call(n)==="[object Array]"?"array":l.nodebuffer&&s.isBuffer(n)?"nodebuffer":l.uint8array&&n instanceof Uint8Array?"uint8array":l.arraybuffer&&n instanceof ArrayBuffer?"arraybuffer":void 0},x.checkSupport=function(n){if(!l[n.toLowerCase()])throw new Error(n+" is not supported by this platform")},x.MAX_VALUE_16BITS=65535,x.MAX_VALUE_32BITS=-1,x.pretty=function(n){var f,c,u="";for(c=0;c<(n||"").length;c++)u+="\\x"+((f=n.charCodeAt(c))<16?"0":"")+f.toString(16).toUpperCase();return u},x.delay=function(n,f,c){setImmediate(function(){n.apply(c||null,f||[])})},x.inherits=function(n,f){function c(){}c.prototype=f.prototype,n.prototype=new c},x.extend=function(){var n,f,c={};for(n=0;n<arguments.length;n++)for(f in arguments[n])Object.prototype.hasOwnProperty.call(arguments[n],f)&&c[f]===void 0&&(c[f]=arguments[n][f]);return c},x.prepareContent=function(n,f,c,u,N){return i.Promise.resolve(f).then(function(z){return l.blob&&(z instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(z))!==-1)&&typeof FileReader<"u"?new i.Promise(function(j,T){var D=new FileReader;D.onload=function(M){j(M.target.result)},D.onerror=function(M){T(M.target.error)},D.readAsArrayBuffer(z)}):z}).then(function(z){var j=x.getTypeOf(z);return j?(j==="arraybuffer"?z=x.transformTo("uint8array",z):j==="string"&&(N?z=o.decode(z):c&&u!==!0&&(z=(function(T){return k(T,l.uint8array?new Uint8Array(T.length):new Array(T.length))})(z))),z):i.Promise.reject(new Error("Can't read the data of '"+n+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(d,C,x){var l=d("./reader/readerFor"),o=d("./utils"),s=d("./signature"),i=d("./zipEntry"),_=d("./support");function k(w){this.files=[],this.loadOptions=w}k.prototype={checkSignature:function(w){if(!this.reader.readAndCheckSignature(w)){this.reader.index-=4;var p=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(p)+", expected "+o.pretty(w)+")")}},isSignature:function(w,p){var a=this.reader.index;this.reader.setIndex(w);var b=this.reader.readString(4)===p;return this.reader.setIndex(a),b},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var w=this.reader.readData(this.zipCommentLength),p=_.uint8array?"uint8array":"array",a=o.transformTo(p,w);this.zipComment=this.loadOptions.decodeFileName(a)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var w,p,a,b=this.zip64EndOfCentralSize-44;0<b;)w=this.reader.readInt(2),p=this.reader.readInt(4),a=this.reader.readData(p),this.zip64ExtensibleData[w]={id:w,length:p,value:a}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var w,p;for(w=0;w<this.files.length;w++)p=this.files[w],this.reader.setIndex(p.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),p.readLocalPart(this.reader),p.handleUTF8(),p.processAttributes()},readCentralDir:function(){var w;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(w=new i({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(w);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var w=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(w<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(w);var p=w;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,(w=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(w),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var a=this.centralDirOffset+this.centralDirSize;this.zip64&&(a+=20,a+=12+this.zip64EndOfCentralSize);var b=p-a;if(0<b)this.isSignature(p,s.CENTRAL_FILE_HEADER)||(this.reader.zero=b);else if(b<0)throw new Error("Corrupted zip: missing "+Math.abs(b)+" bytes.")},prepareReader:function(w){this.reader=l(w)},load:function(w){this.prepareReader(w),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},C.exports=k},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(d,C,x){var l=d("./reader/readerFor"),o=d("./utils"),s=d("./compressedObject"),i=d("./crc32"),_=d("./utf8"),k=d("./compressions"),w=d("./support");function p(a,b){this.options=a,this.loadOptions=b}p.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(a){var b,n;if(a.skip(22),this.fileNameLength=a.readInt(2),n=a.readInt(2),this.fileName=a.readData(this.fileNameLength),a.skip(n),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((b=(function(f){for(var c in k)if(Object.prototype.hasOwnProperty.call(k,c)&&k[c].magic===f)return k[c];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,b,a.readData(this.compressedSize))},readCentralPart:function(a){this.versionMadeBy=a.readInt(2),a.skip(2),this.bitFlag=a.readInt(2),this.compressionMethod=a.readString(2),this.date=a.readDate(),this.crc32=a.readInt(4),this.compressedSize=a.readInt(4),this.uncompressedSize=a.readInt(4);var b=a.readInt(2);if(this.extraFieldsLength=a.readInt(2),this.fileCommentLength=a.readInt(2),this.diskNumberStart=a.readInt(2),this.internalFileAttributes=a.readInt(2),this.externalFileAttributes=a.readInt(4),this.localHeaderOffset=a.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");a.skip(b),this.readExtraFields(a),this.parseZIP64ExtraField(a),this.fileComment=a.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var a=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),a==0&&(this.dosPermissions=63&this.externalFileAttributes),a==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var a=l(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=a.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=a.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=a.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=a.readInt(4))}},readExtraFields:function(a){var b,n,f,c=a.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});a.index+4<c;)b=a.readInt(2),n=a.readInt(2),f=a.readData(n),this.extraFields[b]={id:b,length:n,value:f};a.setIndex(c)},handleUTF8:function(){var a=w.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=_.utf8decode(this.fileName),this.fileCommentStr=_.utf8decode(this.fileComment);else{var b=this.findExtraFieldUnicodePath();if(b!==null)this.fileNameStr=b;else{var n=o.transformTo(a,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(n)}var f=this.findExtraFieldUnicodeComment();if(f!==null)this.fileCommentStr=f;else{var c=o.transformTo(a,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(c)}}},findExtraFieldUnicodePath:function(){var a=this.extraFields[28789];if(a){var b=l(a.value);return b.readInt(1)!==1||i(this.fileName)!==b.readInt(4)?null:_.utf8decode(b.readData(a.length-5))}return null},findExtraFieldUnicodeComment:function(){var a=this.extraFields[25461];if(a){var b=l(a.value);return b.readInt(1)!==1||i(this.fileComment)!==b.readInt(4)?null:_.utf8decode(b.readData(a.length-5))}return null}},C.exports=p},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(d,C,x){function l(b,n,f){this.name=b,this.dir=f.dir,this.date=f.date,this.comment=f.comment,this.unixPermissions=f.unixPermissions,this.dosPermissions=f.dosPermissions,this._data=n,this._dataBinary=f.binary,this.options={compression:f.compression,compressionOptions:f.compressionOptions}}var o=d("./stream/StreamHelper"),s=d("./stream/DataWorker"),i=d("./utf8"),_=d("./compressedObject"),k=d("./stream/GenericWorker");l.prototype={internalStream:function(b){var n=null,f="string";try{if(!b)throw new Error("No output type specified.");var c=(f=b.toLowerCase())==="string"||f==="text";f!=="binarystring"&&f!=="text"||(f="string"),n=this._decompressWorker();var u=!this._dataBinary;u&&!c&&(n=n.pipe(new i.Utf8EncodeWorker)),!u&&c&&(n=n.pipe(new i.Utf8DecodeWorker))}catch(N){(n=new k("error")).error(N)}return new o(n,f,"")},async:function(b,n){return this.internalStream(b).accumulate(n)},nodeStream:function(b,n){return this.internalStream(b||"nodebuffer").toNodejsStream(n)},_compressWorker:function(b,n){if(this._data instanceof _&&this._data.compression.magic===b.magic)return this._data.getCompressedWorker();var f=this._decompressWorker();return this._dataBinary||(f=f.pipe(new i.Utf8EncodeWorker)),_.createWorkerFrom(f,b,n)},_decompressWorker:function(){return this._data instanceof _?this._data.getContentWorker():this._data instanceof k?this._data:new s(this._data)}};for(var w=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],p=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},a=0;a<w.length;a++)l.prototype[w[a]]=p;C.exports=l},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(d,C,x){(function(l){var o,s,i=l.MutationObserver||l.WebKitMutationObserver;if(i){var _=0,k=new i(b),w=l.document.createTextNode("");k.observe(w,{characterData:!0}),o=function(){w.data=_=++_%2}}else if(l.setImmediate||l.MessageChannel===void 0)o="document"in l&&"onreadystatechange"in l.document.createElement("script")?function(){var n=l.document.createElement("script");n.onreadystatechange=function(){b(),n.onreadystatechange=null,n.parentNode.removeChild(n),n=null},l.document.documentElement.appendChild(n)}:function(){setTimeout(b,0)};else{var p=new l.MessageChannel;p.port1.onmessage=b,o=function(){p.port2.postMessage(0)}}var a=[];function b(){var n,f;s=!0;for(var c=a.length;c;){for(f=a,a=[],n=-1;++n<c;)f[n]();c=a.length}s=!1}C.exports=function(n){a.push(n)!==1||s||o()}}).call(this,typeof Me<"u"?Me:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(d,C,x){var l=d("immediate");function o(){}var s={},i=["REJECTED"],_=["FULFILLED"],k=["PENDING"];function w(c){if(typeof c!="function")throw new TypeError("resolver must be a function");this.state=k,this.queue=[],this.outcome=void 0,c!==o&&n(this,c)}function p(c,u,N){this.promise=c,typeof u=="function"&&(this.onFulfilled=u,this.callFulfilled=this.otherCallFulfilled),typeof N=="function"&&(this.onRejected=N,this.callRejected=this.otherCallRejected)}function a(c,u,N){l(function(){var z;try{z=u(N)}catch(j){return s.reject(c,j)}z===c?s.reject(c,new TypeError("Cannot resolve promise with itself")):s.resolve(c,z)})}function b(c){var u=c&&c.then;if(c&&(typeof c=="object"||typeof c=="function")&&typeof u=="function")return function(){u.apply(c,arguments)}}function n(c,u){var N=!1;function z(D){N||(N=!0,s.reject(c,D))}function j(D){N||(N=!0,s.resolve(c,D))}var T=f(function(){u(j,z)});T.status==="error"&&z(T.value)}function f(c,u){var N={};try{N.value=c(u),N.status="success"}catch(z){N.status="error",N.value=z}return N}(C.exports=w).prototype.finally=function(c){if(typeof c!="function")return this;var u=this.constructor;return this.then(function(N){return u.resolve(c()).then(function(){return N})},function(N){return u.resolve(c()).then(function(){throw N})})},w.prototype.catch=function(c){return this.then(null,c)},w.prototype.then=function(c,u){if(typeof c!="function"&&this.state===_||typeof u!="function"&&this.state===i)return this;var N=new this.constructor(o);return this.state!==k?a(N,this.state===_?c:u,this.outcome):this.queue.push(new p(N,c,u)),N},p.prototype.callFulfilled=function(c){s.resolve(this.promise,c)},p.prototype.otherCallFulfilled=function(c){a(this.promise,this.onFulfilled,c)},p.prototype.callRejected=function(c){s.reject(this.promise,c)},p.prototype.otherCallRejected=function(c){a(this.promise,this.onRejected,c)},s.resolve=function(c,u){var N=f(b,u);if(N.status==="error")return s.reject(c,N.value);var z=N.value;if(z)n(c,z);else{c.state=_,c.outcome=u;for(var j=-1,T=c.queue.length;++j<T;)c.queue[j].callFulfilled(u)}return c},s.reject=function(c,u){c.state=i,c.outcome=u;for(var N=-1,z=c.queue.length;++N<z;)c.queue[N].callRejected(u);return c},w.resolve=function(c){return c instanceof this?c:s.resolve(new this(o),c)},w.reject=function(c){var u=new this(o);return s.reject(u,c)},w.all=function(c){var u=this;if(Object.prototype.toString.call(c)!=="[object Array]")return this.reject(new TypeError("must be an array"));var N=c.length,z=!1;if(!N)return this.resolve([]);for(var j=new Array(N),T=0,D=-1,M=new this(o);++D<N;)y(c[D],D);return M;function y(B,K){u.resolve(B).then(function(h){j[K]=h,++T!==N||z||(z=!0,s.resolve(M,j))},function(h){z||(z=!0,s.reject(M,h))})}},w.race=function(c){var u=this;if(Object.prototype.toString.call(c)!=="[object Array]")return this.reject(new TypeError("must be an array"));var N=c.length,z=!1;if(!N)return this.resolve([]);for(var j=-1,T=new this(o);++j<N;)D=c[j],u.resolve(D).then(function(M){z||(z=!0,s.resolve(T,M))},function(M){z||(z=!0,s.reject(T,M))});var D;return T}},{immediate:36}],38:[function(d,C,x){var l={};(0,d("./lib/utils/common").assign)(l,d("./lib/deflate"),d("./lib/inflate"),d("./lib/zlib/constants")),C.exports=l},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(d,C,x){var l=d("./zlib/deflate"),o=d("./utils/common"),s=d("./utils/strings"),i=d("./zlib/messages"),_=d("./zlib/zstream"),k=Object.prototype.toString,w=0,p=-1,a=0,b=8;function n(c){if(!(this instanceof n))return new n(c);this.options=o.assign({level:p,method:b,chunkSize:16384,windowBits:15,memLevel:8,strategy:a,to:""},c||{});var u=this.options;u.raw&&0<u.windowBits?u.windowBits=-u.windowBits:u.gzip&&0<u.windowBits&&u.windowBits<16&&(u.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new _,this.strm.avail_out=0;var N=l.deflateInit2(this.strm,u.level,u.method,u.windowBits,u.memLevel,u.strategy);if(N!==w)throw new Error(i[N]);if(u.header&&l.deflateSetHeader(this.strm,u.header),u.dictionary){var z;if(z=typeof u.dictionary=="string"?s.string2buf(u.dictionary):k.call(u.dictionary)==="[object ArrayBuffer]"?new Uint8Array(u.dictionary):u.dictionary,(N=l.deflateSetDictionary(this.strm,z))!==w)throw new Error(i[N]);this._dict_set=!0}}function f(c,u){var N=new n(u);if(N.push(c,!0),N.err)throw N.msg||i[N.err];return N.result}n.prototype.push=function(c,u){var N,z,j=this.strm,T=this.options.chunkSize;if(this.ended)return!1;z=u===~~u?u:u===!0?4:0,typeof c=="string"?j.input=s.string2buf(c):k.call(c)==="[object ArrayBuffer]"?j.input=new Uint8Array(c):j.input=c,j.next_in=0,j.avail_in=j.input.length;do{if(j.avail_out===0&&(j.output=new o.Buf8(T),j.next_out=0,j.avail_out=T),(N=l.deflate(j,z))!==1&&N!==w)return this.onEnd(N),!(this.ended=!0);j.avail_out!==0&&(j.avail_in!==0||z!==4&&z!==2)||(this.options.to==="string"?this.onData(s.buf2binstring(o.shrinkBuf(j.output,j.next_out))):this.onData(o.shrinkBuf(j.output,j.next_out)))}while((0<j.avail_in||j.avail_out===0)&&N!==1);return z===4?(N=l.deflateEnd(this.strm),this.onEnd(N),this.ended=!0,N===w):z!==2||(this.onEnd(w),!(j.avail_out=0))},n.prototype.onData=function(c){this.chunks.push(c)},n.prototype.onEnd=function(c){c===w&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=c,this.msg=this.strm.msg},x.Deflate=n,x.deflate=f,x.deflateRaw=function(c,u){return(u=u||{}).raw=!0,f(c,u)},x.gzip=function(c,u){return(u=u||{}).gzip=!0,f(c,u)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(d,C,x){var l=d("./zlib/inflate"),o=d("./utils/common"),s=d("./utils/strings"),i=d("./zlib/constants"),_=d("./zlib/messages"),k=d("./zlib/zstream"),w=d("./zlib/gzheader"),p=Object.prototype.toString;function a(n){if(!(this instanceof a))return new a(n);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},n||{});var f=this.options;f.raw&&0<=f.windowBits&&f.windowBits<16&&(f.windowBits=-f.windowBits,f.windowBits===0&&(f.windowBits=-15)),!(0<=f.windowBits&&f.windowBits<16)||n&&n.windowBits||(f.windowBits+=32),15<f.windowBits&&f.windowBits<48&&(15&f.windowBits)==0&&(f.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new k,this.strm.avail_out=0;var c=l.inflateInit2(this.strm,f.windowBits);if(c!==i.Z_OK)throw new Error(_[c]);this.header=new w,l.inflateGetHeader(this.strm,this.header)}function b(n,f){var c=new a(f);if(c.push(n,!0),c.err)throw c.msg||_[c.err];return c.result}a.prototype.push=function(n,f){var c,u,N,z,j,T,D=this.strm,M=this.options.chunkSize,y=this.options.dictionary,B=!1;if(this.ended)return!1;u=f===~~f?f:f===!0?i.Z_FINISH:i.Z_NO_FLUSH,typeof n=="string"?D.input=s.binstring2buf(n):p.call(n)==="[object ArrayBuffer]"?D.input=new Uint8Array(n):D.input=n,D.next_in=0,D.avail_in=D.input.length;do{if(D.avail_out===0&&(D.output=new o.Buf8(M),D.next_out=0,D.avail_out=M),(c=l.inflate(D,i.Z_NO_FLUSH))===i.Z_NEED_DICT&&y&&(T=typeof y=="string"?s.string2buf(y):p.call(y)==="[object ArrayBuffer]"?new Uint8Array(y):y,c=l.inflateSetDictionary(this.strm,T)),c===i.Z_BUF_ERROR&&B===!0&&(c=i.Z_OK,B=!1),c!==i.Z_STREAM_END&&c!==i.Z_OK)return this.onEnd(c),!(this.ended=!0);D.next_out&&(D.avail_out!==0&&c!==i.Z_STREAM_END&&(D.avail_in!==0||u!==i.Z_FINISH&&u!==i.Z_SYNC_FLUSH)||(this.options.to==="string"?(N=s.utf8border(D.output,D.next_out),z=D.next_out-N,j=s.buf2string(D.output,N),D.next_out=z,D.avail_out=M-z,z&&o.arraySet(D.output,D.output,N,z,0),this.onData(j)):this.onData(o.shrinkBuf(D.output,D.next_out)))),D.avail_in===0&&D.avail_out===0&&(B=!0)}while((0<D.avail_in||D.avail_out===0)&&c!==i.Z_STREAM_END);return c===i.Z_STREAM_END&&(u=i.Z_FINISH),u===i.Z_FINISH?(c=l.inflateEnd(this.strm),this.onEnd(c),this.ended=!0,c===i.Z_OK):u!==i.Z_SYNC_FLUSH||(this.onEnd(i.Z_OK),!(D.avail_out=0))},a.prototype.onData=function(n){this.chunks.push(n)},a.prototype.onEnd=function(n){n===i.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg},x.Inflate=a,x.inflate=b,x.inflateRaw=function(n,f){return(f=f||{}).raw=!0,b(n,f)},x.ungzip=b},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(d,C,x){var l=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";x.assign=function(i){for(var _=Array.prototype.slice.call(arguments,1);_.length;){var k=_.shift();if(k){if(typeof k!="object")throw new TypeError(k+"must be non-object");for(var w in k)k.hasOwnProperty(w)&&(i[w]=k[w])}}return i},x.shrinkBuf=function(i,_){return i.length===_?i:i.subarray?i.subarray(0,_):(i.length=_,i)};var o={arraySet:function(i,_,k,w,p){if(_.subarray&&i.subarray)i.set(_.subarray(k,k+w),p);else for(var a=0;a<w;a++)i[p+a]=_[k+a]},flattenChunks:function(i){var _,k,w,p,a,b;for(_=w=0,k=i.length;_<k;_++)w+=i[_].length;for(b=new Uint8Array(w),_=p=0,k=i.length;_<k;_++)a=i[_],b.set(a,p),p+=a.length;return b}},s={arraySet:function(i,_,k,w,p){for(var a=0;a<w;a++)i[p+a]=_[k+a]},flattenChunks:function(i){return[].concat.apply([],i)}};x.setTyped=function(i){i?(x.Buf8=Uint8Array,x.Buf16=Uint16Array,x.Buf32=Int32Array,x.assign(x,o)):(x.Buf8=Array,x.Buf16=Array,x.Buf32=Array,x.assign(x,s))},x.setTyped(l)},{}],42:[function(d,C,x){var l=d("./common"),o=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{s=!1}for(var i=new l.Buf8(256),_=0;_<256;_++)i[_]=252<=_?6:248<=_?5:240<=_?4:224<=_?3:192<=_?2:1;function k(w,p){if(p<65537&&(w.subarray&&s||!w.subarray&&o))return String.fromCharCode.apply(null,l.shrinkBuf(w,p));for(var a="",b=0;b<p;b++)a+=String.fromCharCode(w[b]);return a}i[254]=i[254]=1,x.string2buf=function(w){var p,a,b,n,f,c=w.length,u=0;for(n=0;n<c;n++)(64512&(a=w.charCodeAt(n)))==55296&&n+1<c&&(64512&(b=w.charCodeAt(n+1)))==56320&&(a=65536+(a-55296<<10)+(b-56320),n++),u+=a<128?1:a<2048?2:a<65536?3:4;for(p=new l.Buf8(u),n=f=0;f<u;n++)(64512&(a=w.charCodeAt(n)))==55296&&n+1<c&&(64512&(b=w.charCodeAt(n+1)))==56320&&(a=65536+(a-55296<<10)+(b-56320),n++),a<128?p[f++]=a:(a<2048?p[f++]=192|a>>>6:(a<65536?p[f++]=224|a>>>12:(p[f++]=240|a>>>18,p[f++]=128|a>>>12&63),p[f++]=128|a>>>6&63),p[f++]=128|63&a);return p},x.buf2binstring=function(w){return k(w,w.length)},x.binstring2buf=function(w){for(var p=new l.Buf8(w.length),a=0,b=p.length;a<b;a++)p[a]=w.charCodeAt(a);return p},x.buf2string=function(w,p){var a,b,n,f,c=p||w.length,u=new Array(2*c);for(a=b=0;a<c;)if((n=w[a++])<128)u[b++]=n;else if(4<(f=i[n]))u[b++]=65533,a+=f-1;else{for(n&=f===2?31:f===3?15:7;1<f&&a<c;)n=n<<6|63&w[a++],f--;1<f?u[b++]=65533:n<65536?u[b++]=n:(n-=65536,u[b++]=55296|n>>10&1023,u[b++]=56320|1023&n)}return k(u,b)},x.utf8border=function(w,p){var a;for((p=p||w.length)>w.length&&(p=w.length),a=p-1;0<=a&&(192&w[a])==128;)a--;return a<0||a===0?p:a+i[w[a]]>p?a:p}},{"./common":41}],43:[function(d,C,x){C.exports=function(l,o,s,i){for(var _=65535&l|0,k=l>>>16&65535|0,w=0;s!==0;){for(s-=w=2e3<s?2e3:s;k=k+(_=_+o[i++]|0)|0,--w;);_%=65521,k%=65521}return _|k<<16|0}},{}],44:[function(d,C,x){C.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(d,C,x){var l=(function(){for(var o,s=[],i=0;i<256;i++){o=i;for(var _=0;_<8;_++)o=1&o?3988292384^o>>>1:o>>>1;s[i]=o}return s})();C.exports=function(o,s,i,_){var k=l,w=_+i;o^=-1;for(var p=_;p<w;p++)o=o>>>8^k[255&(o^s[p])];return-1^o}},{}],46:[function(d,C,x){var l,o=d("../utils/common"),s=d("./trees"),i=d("./adler32"),_=d("./crc32"),k=d("./messages"),w=0,p=4,a=0,b=-2,n=-1,f=4,c=2,u=8,N=9,z=286,j=30,T=19,D=2*z+1,M=15,y=3,B=258,K=B+y+1,h=42,A=113,r=1,F=2,ee=3,S=4;function R(t,q){return t.msg=k[q],q}function E(t){return(t<<1)-(4<t?9:0)}function Z(t){for(var q=t.length;0<=--q;)t[q]=0}function O(t){var q=t.state,L=q.pending;L>t.avail_out&&(L=t.avail_out),L!==0&&(o.arraySet(t.output,q.pending_buf,q.pending_out,L,t.next_out),t.next_out+=L,q.pending_out+=L,t.total_out+=L,t.avail_out-=L,q.pending-=L,q.pending===0&&(q.pending_out=0))}function m(t,q){s._tr_flush_block(t,0<=t.block_start?t.block_start:-1,t.strstart-t.block_start,q),t.block_start=t.strstart,O(t.strm)}function V(t,q){t.pending_buf[t.pending++]=q}function G(t,q){t.pending_buf[t.pending++]=q>>>8&255,t.pending_buf[t.pending++]=255&q}function W(t,q){var L,v,g=t.max_chain_length,P=t.strstart,H=t.prev_length,Y=t.nice_match,U=t.strstart>t.w_size-K?t.strstart-(t.w_size-K):0,X=t.window,te=t.w_mask,Q=t.prev,re=t.strstart+B,le=X[P+H-1],ie=X[P+H];t.prev_length>=t.good_match&&(g>>=2),Y>t.lookahead&&(Y=t.lookahead);do if(X[(L=q)+H]===ie&&X[L+H-1]===le&&X[L]===X[P]&&X[++L]===X[P+1]){P+=2,L++;do;while(X[++P]===X[++L]&&X[++P]===X[++L]&&X[++P]===X[++L]&&X[++P]===X[++L]&&X[++P]===X[++L]&&X[++P]===X[++L]&&X[++P]===X[++L]&&X[++P]===X[++L]&&P<re);if(v=B-(re-P),P=re-B,H<v){if(t.match_start=q,Y<=(H=v))break;le=X[P+H-1],ie=X[P+H]}}while((q=Q[q&te])>U&&--g!=0);return H<=t.lookahead?H:t.lookahead}function ne(t){var q,L,v,g,P,H,Y,U,X,te,Q=t.w_size;do{if(g=t.window_size-t.lookahead-t.strstart,t.strstart>=Q+(Q-K)){for(o.arraySet(t.window,t.window,Q,Q,0),t.match_start-=Q,t.strstart-=Q,t.block_start-=Q,q=L=t.hash_size;v=t.head[--q],t.head[q]=Q<=v?v-Q:0,--L;);for(q=L=Q;v=t.prev[--q],t.prev[q]=Q<=v?v-Q:0,--L;);g+=Q}if(t.strm.avail_in===0)break;if(H=t.strm,Y=t.window,U=t.strstart+t.lookahead,X=g,te=void 0,te=H.avail_in,X<te&&(te=X),L=te===0?0:(H.avail_in-=te,o.arraySet(Y,H.input,H.next_in,te,U),H.state.wrap===1?H.adler=i(H.adler,Y,te,U):H.state.wrap===2&&(H.adler=_(H.adler,Y,te,U)),H.next_in+=te,H.total_in+=te,te),t.lookahead+=L,t.lookahead+t.insert>=y)for(P=t.strstart-t.insert,t.ins_h=t.window[P],t.ins_h=(t.ins_h<<t.hash_shift^t.window[P+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[P+y-1])&t.hash_mask,t.prev[P&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=P,P++,t.insert--,!(t.lookahead+t.insert<y)););}while(t.lookahead<K&&t.strm.avail_in!==0)}function se(t,q){for(var L,v;;){if(t.lookahead<K){if(ne(t),t.lookahead<K&&q===w)return r;if(t.lookahead===0)break}if(L=0,t.lookahead>=y&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+y-1])&t.hash_mask,L=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),L!==0&&t.strstart-L<=t.w_size-K&&(t.match_length=W(t,L)),t.match_length>=y)if(v=s._tr_tally(t,t.strstart-t.match_start,t.match_length-y),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=y){for(t.match_length--;t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+y-1])&t.hash_mask,L=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart,--t.match_length!=0;);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else v=s._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(v&&(m(t,!1),t.strm.avail_out===0))return r}return t.insert=t.strstart<y-1?t.strstart:y-1,q===p?(m(t,!0),t.strm.avail_out===0?ee:S):t.last_lit&&(m(t,!1),t.strm.avail_out===0)?r:F}function ae(t,q){for(var L,v,g;;){if(t.lookahead<K){if(ne(t),t.lookahead<K&&q===w)return r;if(t.lookahead===0)break}if(L=0,t.lookahead>=y&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+y-1])&t.hash_mask,L=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=y-1,L!==0&&t.prev_length<t.max_lazy_match&&t.strstart-L<=t.w_size-K&&(t.match_length=W(t,L),t.match_length<=5&&(t.strategy===1||t.match_length===y&&4096<t.strstart-t.match_start)&&(t.match_length=y-1)),t.prev_length>=y&&t.match_length<=t.prev_length){for(g=t.strstart+t.lookahead-y,v=s._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-y),t.lookahead-=t.prev_length-1,t.prev_length-=2;++t.strstart<=g&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+y-1])&t.hash_mask,L=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),--t.prev_length!=0;);if(t.match_available=0,t.match_length=y-1,t.strstart++,v&&(m(t,!1),t.strm.avail_out===0))return r}else if(t.match_available){if((v=s._tr_tally(t,0,t.window[t.strstart-1]))&&m(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return r}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(v=s._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<y-1?t.strstart:y-1,q===p?(m(t,!0),t.strm.avail_out===0?ee:S):t.last_lit&&(m(t,!1),t.strm.avail_out===0)?r:F}function oe(t,q,L,v,g){this.good_length=t,this.max_lazy=q,this.nice_length=L,this.max_chain=v,this.func=g}function ue(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=u,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(2*D),this.dyn_dtree=new o.Buf16(2*(2*j+1)),this.bl_tree=new o.Buf16(2*(2*T+1)),Z(this.dyn_ltree),Z(this.dyn_dtree),Z(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(M+1),this.heap=new o.Buf16(2*z+1),Z(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*z+1),Z(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function de(t){var q;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=c,(q=t.state).pending=0,q.pending_out=0,q.wrap<0&&(q.wrap=-q.wrap),q.status=q.wrap?h:A,t.adler=q.wrap===2?0:1,q.last_flush=w,s._tr_init(q),a):R(t,b)}function pe(t){var q=de(t);return q===a&&(function(L){L.window_size=2*L.w_size,Z(L.head),L.max_lazy_match=l[L.level].max_lazy,L.good_match=l[L.level].good_length,L.nice_match=l[L.level].nice_length,L.max_chain_length=l[L.level].max_chain,L.strstart=0,L.block_start=0,L.lookahead=0,L.insert=0,L.match_length=L.prev_length=y-1,L.match_available=0,L.ins_h=0})(t.state),q}function ce(t,q,L,v,g,P){if(!t)return b;var H=1;if(q===n&&(q=6),v<0?(H=0,v=-v):15<v&&(H=2,v-=16),g<1||N<g||L!==u||v<8||15<v||q<0||9<q||P<0||f<P)return R(t,b);v===8&&(v=9);var Y=new ue;return(t.state=Y).strm=t,Y.wrap=H,Y.gzhead=null,Y.w_bits=v,Y.w_size=1<<Y.w_bits,Y.w_mask=Y.w_size-1,Y.hash_bits=g+7,Y.hash_size=1<<Y.hash_bits,Y.hash_mask=Y.hash_size-1,Y.hash_shift=~~((Y.hash_bits+y-1)/y),Y.window=new o.Buf8(2*Y.w_size),Y.head=new o.Buf16(Y.hash_size),Y.prev=new o.Buf16(Y.w_size),Y.lit_bufsize=1<<g+6,Y.pending_buf_size=4*Y.lit_bufsize,Y.pending_buf=new o.Buf8(Y.pending_buf_size),Y.d_buf=1*Y.lit_bufsize,Y.l_buf=3*Y.lit_bufsize,Y.level=q,Y.strategy=P,Y.method=L,pe(t)}l=[new oe(0,0,0,0,function(t,q){var L=65535;for(L>t.pending_buf_size-5&&(L=t.pending_buf_size-5);;){if(t.lookahead<=1){if(ne(t),t.lookahead===0&&q===w)return r;if(t.lookahead===0)break}t.strstart+=t.lookahead,t.lookahead=0;var v=t.block_start+L;if((t.strstart===0||t.strstart>=v)&&(t.lookahead=t.strstart-v,t.strstart=v,m(t,!1),t.strm.avail_out===0)||t.strstart-t.block_start>=t.w_size-K&&(m(t,!1),t.strm.avail_out===0))return r}return t.insert=0,q===p?(m(t,!0),t.strm.avail_out===0?ee:S):(t.strstart>t.block_start&&(m(t,!1),t.strm.avail_out),r)}),new oe(4,4,8,4,se),new oe(4,5,16,8,se),new oe(4,6,32,32,se),new oe(4,4,16,16,ae),new oe(8,16,32,32,ae),new oe(8,16,128,128,ae),new oe(8,32,128,256,ae),new oe(32,128,258,1024,ae),new oe(32,258,258,4096,ae)],x.deflateInit=function(t,q){return ce(t,q,u,15,8,0)},x.deflateInit2=ce,x.deflateReset=pe,x.deflateResetKeep=de,x.deflateSetHeader=function(t,q){return t&&t.state?t.state.wrap!==2?b:(t.state.gzhead=q,a):b},x.deflate=function(t,q){var L,v,g,P;if(!t||!t.state||5<q||q<0)return t?R(t,b):b;if(v=t.state,!t.output||!t.input&&t.avail_in!==0||v.status===666&&q!==p)return R(t,t.avail_out===0?-5:b);if(v.strm=t,L=v.last_flush,v.last_flush=q,v.status===h)if(v.wrap===2)t.adler=0,V(v,31),V(v,139),V(v,8),v.gzhead?(V(v,(v.gzhead.text?1:0)+(v.gzhead.hcrc?2:0)+(v.gzhead.extra?4:0)+(v.gzhead.name?8:0)+(v.gzhead.comment?16:0)),V(v,255&v.gzhead.time),V(v,v.gzhead.time>>8&255),V(v,v.gzhead.time>>16&255),V(v,v.gzhead.time>>24&255),V(v,v.level===9?2:2<=v.strategy||v.level<2?4:0),V(v,255&v.gzhead.os),v.gzhead.extra&&v.gzhead.extra.length&&(V(v,255&v.gzhead.extra.length),V(v,v.gzhead.extra.length>>8&255)),v.gzhead.hcrc&&(t.adler=_(t.adler,v.pending_buf,v.pending,0)),v.gzindex=0,v.status=69):(V(v,0),V(v,0),V(v,0),V(v,0),V(v,0),V(v,v.level===9?2:2<=v.strategy||v.level<2?4:0),V(v,3),v.status=A);else{var H=u+(v.w_bits-8<<4)<<8;H|=(2<=v.strategy||v.level<2?0:v.level<6?1:v.level===6?2:3)<<6,v.strstart!==0&&(H|=32),H+=31-H%31,v.status=A,G(v,H),v.strstart!==0&&(G(v,t.adler>>>16),G(v,65535&t.adler)),t.adler=1}if(v.status===69)if(v.gzhead.extra){for(g=v.pending;v.gzindex<(65535&v.gzhead.extra.length)&&(v.pending!==v.pending_buf_size||(v.gzhead.hcrc&&v.pending>g&&(t.adler=_(t.adler,v.pending_buf,v.pending-g,g)),O(t),g=v.pending,v.pending!==v.pending_buf_size));)V(v,255&v.gzhead.extra[v.gzindex]),v.gzindex++;v.gzhead.hcrc&&v.pending>g&&(t.adler=_(t.adler,v.pending_buf,v.pending-g,g)),v.gzindex===v.gzhead.extra.length&&(v.gzindex=0,v.status=73)}else v.status=73;if(v.status===73)if(v.gzhead.name){g=v.pending;do{if(v.pending===v.pending_buf_size&&(v.gzhead.hcrc&&v.pending>g&&(t.adler=_(t.adler,v.pending_buf,v.pending-g,g)),O(t),g=v.pending,v.pending===v.pending_buf_size)){P=1;break}P=v.gzindex<v.gzhead.name.length?255&v.gzhead.name.charCodeAt(v.gzindex++):0,V(v,P)}while(P!==0);v.gzhead.hcrc&&v.pending>g&&(t.adler=_(t.adler,v.pending_buf,v.pending-g,g)),P===0&&(v.gzindex=0,v.status=91)}else v.status=91;if(v.status===91)if(v.gzhead.comment){g=v.pending;do{if(v.pending===v.pending_buf_size&&(v.gzhead.hcrc&&v.pending>g&&(t.adler=_(t.adler,v.pending_buf,v.pending-g,g)),O(t),g=v.pending,v.pending===v.pending_buf_size)){P=1;break}P=v.gzindex<v.gzhead.comment.length?255&v.gzhead.comment.charCodeAt(v.gzindex++):0,V(v,P)}while(P!==0);v.gzhead.hcrc&&v.pending>g&&(t.adler=_(t.adler,v.pending_buf,v.pending-g,g)),P===0&&(v.status=103)}else v.status=103;if(v.status===103&&(v.gzhead.hcrc?(v.pending+2>v.pending_buf_size&&O(t),v.pending+2<=v.pending_buf_size&&(V(v,255&t.adler),V(v,t.adler>>8&255),t.adler=0,v.status=A)):v.status=A),v.pending!==0){if(O(t),t.avail_out===0)return v.last_flush=-1,a}else if(t.avail_in===0&&E(q)<=E(L)&&q!==p)return R(t,-5);if(v.status===666&&t.avail_in!==0)return R(t,-5);if(t.avail_in!==0||v.lookahead!==0||q!==w&&v.status!==666){var Y=v.strategy===2?(function(U,X){for(var te;;){if(U.lookahead===0&&(ne(U),U.lookahead===0)){if(X===w)return r;break}if(U.match_length=0,te=s._tr_tally(U,0,U.window[U.strstart]),U.lookahead--,U.strstart++,te&&(m(U,!1),U.strm.avail_out===0))return r}return U.insert=0,X===p?(m(U,!0),U.strm.avail_out===0?ee:S):U.last_lit&&(m(U,!1),U.strm.avail_out===0)?r:F})(v,q):v.strategy===3?(function(U,X){for(var te,Q,re,le,ie=U.window;;){if(U.lookahead<=B){if(ne(U),U.lookahead<=B&&X===w)return r;if(U.lookahead===0)break}if(U.match_length=0,U.lookahead>=y&&0<U.strstart&&(Q=ie[re=U.strstart-1])===ie[++re]&&Q===ie[++re]&&Q===ie[++re]){le=U.strstart+B;do;while(Q===ie[++re]&&Q===ie[++re]&&Q===ie[++re]&&Q===ie[++re]&&Q===ie[++re]&&Q===ie[++re]&&Q===ie[++re]&&Q===ie[++re]&&re<le);U.match_length=B-(le-re),U.match_length>U.lookahead&&(U.match_length=U.lookahead)}if(U.match_length>=y?(te=s._tr_tally(U,1,U.match_length-y),U.lookahead-=U.match_length,U.strstart+=U.match_length,U.match_length=0):(te=s._tr_tally(U,0,U.window[U.strstart]),U.lookahead--,U.strstart++),te&&(m(U,!1),U.strm.avail_out===0))return r}return U.insert=0,X===p?(m(U,!0),U.strm.avail_out===0?ee:S):U.last_lit&&(m(U,!1),U.strm.avail_out===0)?r:F})(v,q):l[v.level].func(v,q);if(Y!==ee&&Y!==S||(v.status=666),Y===r||Y===ee)return t.avail_out===0&&(v.last_flush=-1),a;if(Y===F&&(q===1?s._tr_align(v):q!==5&&(s._tr_stored_block(v,0,0,!1),q===3&&(Z(v.head),v.lookahead===0&&(v.strstart=0,v.block_start=0,v.insert=0))),O(t),t.avail_out===0))return v.last_flush=-1,a}return q!==p?a:v.wrap<=0?1:(v.wrap===2?(V(v,255&t.adler),V(v,t.adler>>8&255),V(v,t.adler>>16&255),V(v,t.adler>>24&255),V(v,255&t.total_in),V(v,t.total_in>>8&255),V(v,t.total_in>>16&255),V(v,t.total_in>>24&255)):(G(v,t.adler>>>16),G(v,65535&t.adler)),O(t),0<v.wrap&&(v.wrap=-v.wrap),v.pending!==0?a:1)},x.deflateEnd=function(t){var q;return t&&t.state?(q=t.state.status)!==h&&q!==69&&q!==73&&q!==91&&q!==103&&q!==A&&q!==666?R(t,b):(t.state=null,q===A?R(t,-3):a):b},x.deflateSetDictionary=function(t,q){var L,v,g,P,H,Y,U,X,te=q.length;if(!t||!t.state||(P=(L=t.state).wrap)===2||P===1&&L.status!==h||L.lookahead)return b;for(P===1&&(t.adler=i(t.adler,q,te,0)),L.wrap=0,te>=L.w_size&&(P===0&&(Z(L.head),L.strstart=0,L.block_start=0,L.insert=0),X=new o.Buf8(L.w_size),o.arraySet(X,q,te-L.w_size,L.w_size,0),q=X,te=L.w_size),H=t.avail_in,Y=t.next_in,U=t.input,t.avail_in=te,t.next_in=0,t.input=q,ne(L);L.lookahead>=y;){for(v=L.strstart,g=L.lookahead-(y-1);L.ins_h=(L.ins_h<<L.hash_shift^L.window[v+y-1])&L.hash_mask,L.prev[v&L.w_mask]=L.head[L.ins_h],L.head[L.ins_h]=v,v++,--g;);L.strstart=v,L.lookahead=y-1,ne(L)}return L.strstart+=L.lookahead,L.block_start=L.strstart,L.insert=L.lookahead,L.lookahead=0,L.match_length=L.prev_length=y-1,L.match_available=0,t.next_in=Y,t.input=U,t.avail_in=H,L.wrap=P,a},x.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(d,C,x){C.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(d,C,x){C.exports=function(l,o){var s,i,_,k,w,p,a,b,n,f,c,u,N,z,j,T,D,M,y,B,K,h,A,r,F;s=l.state,i=l.next_in,r=l.input,_=i+(l.avail_in-5),k=l.next_out,F=l.output,w=k-(o-l.avail_out),p=k+(l.avail_out-257),a=s.dmax,b=s.wsize,n=s.whave,f=s.wnext,c=s.window,u=s.hold,N=s.bits,z=s.lencode,j=s.distcode,T=(1<<s.lenbits)-1,D=(1<<s.distbits)-1;e:do{N<15&&(u+=r[i++]<<N,N+=8,u+=r[i++]<<N,N+=8),M=z[u&T];t:for(;;){if(u>>>=y=M>>>24,N-=y,(y=M>>>16&255)===0)F[k++]=65535&M;else{if(!(16&y)){if((64&y)==0){M=z[(65535&M)+(u&(1<<y)-1)];continue t}if(32&y){s.mode=12;break e}l.msg="invalid literal/length code",s.mode=30;break e}B=65535&M,(y&=15)&&(N<y&&(u+=r[i++]<<N,N+=8),B+=u&(1<<y)-1,u>>>=y,N-=y),N<15&&(u+=r[i++]<<N,N+=8,u+=r[i++]<<N,N+=8),M=j[u&D];r:for(;;){if(u>>>=y=M>>>24,N-=y,!(16&(y=M>>>16&255))){if((64&y)==0){M=j[(65535&M)+(u&(1<<y)-1)];continue r}l.msg="invalid distance code",s.mode=30;break e}if(K=65535&M,N<(y&=15)&&(u+=r[i++]<<N,(N+=8)<y&&(u+=r[i++]<<N,N+=8)),a<(K+=u&(1<<y)-1)){l.msg="invalid distance too far back",s.mode=30;break e}if(u>>>=y,N-=y,(y=k-w)<K){if(n<(y=K-y)&&s.sane){l.msg="invalid distance too far back",s.mode=30;break e}if(A=c,(h=0)===f){if(h+=b-y,y<B){for(B-=y;F[k++]=c[h++],--y;);h=k-K,A=F}}else if(f<y){if(h+=b+f-y,(y-=f)<B){for(B-=y;F[k++]=c[h++],--y;);if(h=0,f<B){for(B-=y=f;F[k++]=c[h++],--y;);h=k-K,A=F}}}else if(h+=f-y,y<B){for(B-=y;F[k++]=c[h++],--y;);h=k-K,A=F}for(;2<B;)F[k++]=A[h++],F[k++]=A[h++],F[k++]=A[h++],B-=3;B&&(F[k++]=A[h++],1<B&&(F[k++]=A[h++]))}else{for(h=k-K;F[k++]=F[h++],F[k++]=F[h++],F[k++]=F[h++],2<(B-=3););B&&(F[k++]=F[h++],1<B&&(F[k++]=F[h++]))}break}}break}}while(i<_&&k<p);i-=B=N>>3,u&=(1<<(N-=B<<3))-1,l.next_in=i,l.next_out=k,l.avail_in=i<_?_-i+5:5-(i-_),l.avail_out=k<p?p-k+257:257-(k-p),s.hold=u,s.bits=N}},{}],49:[function(d,C,x){var l=d("../utils/common"),o=d("./adler32"),s=d("./crc32"),i=d("./inffast"),_=d("./inftrees"),k=1,w=2,p=0,a=-2,b=1,n=852,f=592;function c(h){return(h>>>24&255)+(h>>>8&65280)+((65280&h)<<8)+((255&h)<<24)}function u(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new l.Buf16(320),this.work=new l.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function N(h){var A;return h&&h.state?(A=h.state,h.total_in=h.total_out=A.total=0,h.msg="",A.wrap&&(h.adler=1&A.wrap),A.mode=b,A.last=0,A.havedict=0,A.dmax=32768,A.head=null,A.hold=0,A.bits=0,A.lencode=A.lendyn=new l.Buf32(n),A.distcode=A.distdyn=new l.Buf32(f),A.sane=1,A.back=-1,p):a}function z(h){var A;return h&&h.state?((A=h.state).wsize=0,A.whave=0,A.wnext=0,N(h)):a}function j(h,A){var r,F;return h&&h.state?(F=h.state,A<0?(r=0,A=-A):(r=1+(A>>4),A<48&&(A&=15)),A&&(A<8||15<A)?a:(F.window!==null&&F.wbits!==A&&(F.window=null),F.wrap=r,F.wbits=A,z(h))):a}function T(h,A){var r,F;return h?(F=new u,(h.state=F).window=null,(r=j(h,A))!==p&&(h.state=null),r):a}var D,M,y=!0;function B(h){if(y){var A;for(D=new l.Buf32(512),M=new l.Buf32(32),A=0;A<144;)h.lens[A++]=8;for(;A<256;)h.lens[A++]=9;for(;A<280;)h.lens[A++]=7;for(;A<288;)h.lens[A++]=8;for(_(k,h.lens,0,288,D,0,h.work,{bits:9}),A=0;A<32;)h.lens[A++]=5;_(w,h.lens,0,32,M,0,h.work,{bits:5}),y=!1}h.lencode=D,h.lenbits=9,h.distcode=M,h.distbits=5}function K(h,A,r,F){var ee,S=h.state;return S.window===null&&(S.wsize=1<<S.wbits,S.wnext=0,S.whave=0,S.window=new l.Buf8(S.wsize)),F>=S.wsize?(l.arraySet(S.window,A,r-S.wsize,S.wsize,0),S.wnext=0,S.whave=S.wsize):(F<(ee=S.wsize-S.wnext)&&(ee=F),l.arraySet(S.window,A,r-F,ee,S.wnext),(F-=ee)?(l.arraySet(S.window,A,r-F,F,0),S.wnext=F,S.whave=S.wsize):(S.wnext+=ee,S.wnext===S.wsize&&(S.wnext=0),S.whave<S.wsize&&(S.whave+=ee))),0}x.inflateReset=z,x.inflateReset2=j,x.inflateResetKeep=N,x.inflateInit=function(h){return T(h,15)},x.inflateInit2=T,x.inflate=function(h,A){var r,F,ee,S,R,E,Z,O,m,V,G,W,ne,se,ae,oe,ue,de,pe,ce,t,q,L,v,g=0,P=new l.Buf8(4),H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!h||!h.state||!h.output||!h.input&&h.avail_in!==0)return a;(r=h.state).mode===12&&(r.mode=13),R=h.next_out,ee=h.output,Z=h.avail_out,S=h.next_in,F=h.input,E=h.avail_in,O=r.hold,m=r.bits,V=E,G=Z,q=p;e:for(;;)switch(r.mode){case b:if(r.wrap===0){r.mode=13;break}for(;m<16;){if(E===0)break e;E--,O+=F[S++]<<m,m+=8}if(2&r.wrap&&O===35615){P[r.check=0]=255&O,P[1]=O>>>8&255,r.check=s(r.check,P,2,0),m=O=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&O)<<8)+(O>>8))%31){h.msg="incorrect header check",r.mode=30;break}if((15&O)!=8){h.msg="unknown compression method",r.mode=30;break}if(m-=4,t=8+(15&(O>>>=4)),r.wbits===0)r.wbits=t;else if(t>r.wbits){h.msg="invalid window size",r.mode=30;break}r.dmax=1<<t,h.adler=r.check=1,r.mode=512&O?10:12,m=O=0;break;case 2:for(;m<16;){if(E===0)break e;E--,O+=F[S++]<<m,m+=8}if(r.flags=O,(255&r.flags)!=8){h.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){h.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=O>>8&1),512&r.flags&&(P[0]=255&O,P[1]=O>>>8&255,r.check=s(r.check,P,2,0)),m=O=0,r.mode=3;case 3:for(;m<32;){if(E===0)break e;E--,O+=F[S++]<<m,m+=8}r.head&&(r.head.time=O),512&r.flags&&(P[0]=255&O,P[1]=O>>>8&255,P[2]=O>>>16&255,P[3]=O>>>24&255,r.check=s(r.check,P,4,0)),m=O=0,r.mode=4;case 4:for(;m<16;){if(E===0)break e;E--,O+=F[S++]<<m,m+=8}r.head&&(r.head.xflags=255&O,r.head.os=O>>8),512&r.flags&&(P[0]=255&O,P[1]=O>>>8&255,r.check=s(r.check,P,2,0)),m=O=0,r.mode=5;case 5:if(1024&r.flags){for(;m<16;){if(E===0)break e;E--,O+=F[S++]<<m,m+=8}r.length=O,r.head&&(r.head.extra_len=O),512&r.flags&&(P[0]=255&O,P[1]=O>>>8&255,r.check=s(r.check,P,2,0)),m=O=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&(E<(W=r.length)&&(W=E),W&&(r.head&&(t=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),l.arraySet(r.head.extra,F,S,W,t)),512&r.flags&&(r.check=s(r.check,F,W,S)),E-=W,S+=W,r.length-=W),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(E===0)break e;for(W=0;t=F[S+W++],r.head&&t&&r.length<65536&&(r.head.name+=String.fromCharCode(t)),t&&W<E;);if(512&r.flags&&(r.check=s(r.check,F,W,S)),E-=W,S+=W,t)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(E===0)break e;for(W=0;t=F[S+W++],r.head&&t&&r.length<65536&&(r.head.comment+=String.fromCharCode(t)),t&&W<E;);if(512&r.flags&&(r.check=s(r.check,F,W,S)),E-=W,S+=W,t)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;m<16;){if(E===0)break e;E--,O+=F[S++]<<m,m+=8}if(O!==(65535&r.check)){h.msg="header crc mismatch",r.mode=30;break}m=O=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),h.adler=r.check=0,r.mode=12;break;case 10:for(;m<32;){if(E===0)break e;E--,O+=F[S++]<<m,m+=8}h.adler=r.check=c(O),m=O=0,r.mode=11;case 11:if(r.havedict===0)return h.next_out=R,h.avail_out=Z,h.next_in=S,h.avail_in=E,r.hold=O,r.bits=m,2;h.adler=r.check=1,r.mode=12;case 12:if(A===5||A===6)break e;case 13:if(r.last){O>>>=7&m,m-=7&m,r.mode=27;break}for(;m<3;){if(E===0)break e;E--,O+=F[S++]<<m,m+=8}switch(r.last=1&O,m-=1,3&(O>>>=1)){case 0:r.mode=14;break;case 1:if(B(r),r.mode=20,A!==6)break;O>>>=2,m-=2;break e;case 2:r.mode=17;break;case 3:h.msg="invalid block type",r.mode=30}O>>>=2,m-=2;break;case 14:for(O>>>=7&m,m-=7&m;m<32;){if(E===0)break e;E--,O+=F[S++]<<m,m+=8}if((65535&O)!=(O>>>16^65535)){h.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&O,m=O=0,r.mode=15,A===6)break e;case 15:r.mode=16;case 16:if(W=r.length){if(E<W&&(W=E),Z<W&&(W=Z),W===0)break e;l.arraySet(ee,F,S,W,R),E-=W,S+=W,Z-=W,R+=W,r.length-=W;break}r.mode=12;break;case 17:for(;m<14;){if(E===0)break e;E--,O+=F[S++]<<m,m+=8}if(r.nlen=257+(31&O),O>>>=5,m-=5,r.ndist=1+(31&O),O>>>=5,m-=5,r.ncode=4+(15&O),O>>>=4,m-=4,286<r.nlen||30<r.ndist){h.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;m<3;){if(E===0)break e;E--,O+=F[S++]<<m,m+=8}r.lens[H[r.have++]]=7&O,O>>>=3,m-=3}for(;r.have<19;)r.lens[H[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,L={bits:r.lenbits},q=_(0,r.lens,0,19,r.lencode,0,r.work,L),r.lenbits=L.bits,q){h.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;oe=(g=r.lencode[O&(1<<r.lenbits)-1])>>>16&255,ue=65535&g,!((ae=g>>>24)<=m);){if(E===0)break e;E--,O+=F[S++]<<m,m+=8}if(ue<16)O>>>=ae,m-=ae,r.lens[r.have++]=ue;else{if(ue===16){for(v=ae+2;m<v;){if(E===0)break e;E--,O+=F[S++]<<m,m+=8}if(O>>>=ae,m-=ae,r.have===0){h.msg="invalid bit length repeat",r.mode=30;break}t=r.lens[r.have-1],W=3+(3&O),O>>>=2,m-=2}else if(ue===17){for(v=ae+3;m<v;){if(E===0)break e;E--,O+=F[S++]<<m,m+=8}m-=ae,t=0,W=3+(7&(O>>>=ae)),O>>>=3,m-=3}else{for(v=ae+7;m<v;){if(E===0)break e;E--,O+=F[S++]<<m,m+=8}m-=ae,t=0,W=11+(127&(O>>>=ae)),O>>>=7,m-=7}if(r.have+W>r.nlen+r.ndist){h.msg="invalid bit length repeat",r.mode=30;break}for(;W--;)r.lens[r.have++]=t}}if(r.mode===30)break;if(r.lens[256]===0){h.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,L={bits:r.lenbits},q=_(k,r.lens,0,r.nlen,r.lencode,0,r.work,L),r.lenbits=L.bits,q){h.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,L={bits:r.distbits},q=_(w,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,L),r.distbits=L.bits,q){h.msg="invalid distances set",r.mode=30;break}if(r.mode=20,A===6)break e;case 20:r.mode=21;case 21:if(6<=E&&258<=Z){h.next_out=R,h.avail_out=Z,h.next_in=S,h.avail_in=E,r.hold=O,r.bits=m,i(h,G),R=h.next_out,ee=h.output,Z=h.avail_out,S=h.next_in,F=h.input,E=h.avail_in,O=r.hold,m=r.bits,r.mode===12&&(r.back=-1);break}for(r.back=0;oe=(g=r.lencode[O&(1<<r.lenbits)-1])>>>16&255,ue=65535&g,!((ae=g>>>24)<=m);){if(E===0)break e;E--,O+=F[S++]<<m,m+=8}if(oe&&(240&oe)==0){for(de=ae,pe=oe,ce=ue;oe=(g=r.lencode[ce+((O&(1<<de+pe)-1)>>de)])>>>16&255,ue=65535&g,!(de+(ae=g>>>24)<=m);){if(E===0)break e;E--,O+=F[S++]<<m,m+=8}O>>>=de,m-=de,r.back+=de}if(O>>>=ae,m-=ae,r.back+=ae,r.length=ue,oe===0){r.mode=26;break}if(32&oe){r.back=-1,r.mode=12;break}if(64&oe){h.msg="invalid literal/length code",r.mode=30;break}r.extra=15&oe,r.mode=22;case 22:if(r.extra){for(v=r.extra;m<v;){if(E===0)break e;E--,O+=F[S++]<<m,m+=8}r.length+=O&(1<<r.extra)-1,O>>>=r.extra,m-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;oe=(g=r.distcode[O&(1<<r.distbits)-1])>>>16&255,ue=65535&g,!((ae=g>>>24)<=m);){if(E===0)break e;E--,O+=F[S++]<<m,m+=8}if((240&oe)==0){for(de=ae,pe=oe,ce=ue;oe=(g=r.distcode[ce+((O&(1<<de+pe)-1)>>de)])>>>16&255,ue=65535&g,!(de+(ae=g>>>24)<=m);){if(E===0)break e;E--,O+=F[S++]<<m,m+=8}O>>>=de,m-=de,r.back+=de}if(O>>>=ae,m-=ae,r.back+=ae,64&oe){h.msg="invalid distance code",r.mode=30;break}r.offset=ue,r.extra=15&oe,r.mode=24;case 24:if(r.extra){for(v=r.extra;m<v;){if(E===0)break e;E--,O+=F[S++]<<m,m+=8}r.offset+=O&(1<<r.extra)-1,O>>>=r.extra,m-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){h.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(Z===0)break e;if(W=G-Z,r.offset>W){if((W=r.offset-W)>r.whave&&r.sane){h.msg="invalid distance too far back",r.mode=30;break}ne=W>r.wnext?(W-=r.wnext,r.wsize-W):r.wnext-W,W>r.length&&(W=r.length),se=r.window}else se=ee,ne=R-r.offset,W=r.length;for(Z<W&&(W=Z),Z-=W,r.length-=W;ee[R++]=se[ne++],--W;);r.length===0&&(r.mode=21);break;case 26:if(Z===0)break e;ee[R++]=r.length,Z--,r.mode=21;break;case 27:if(r.wrap){for(;m<32;){if(E===0)break e;E--,O|=F[S++]<<m,m+=8}if(G-=Z,h.total_out+=G,r.total+=G,G&&(h.adler=r.check=r.flags?s(r.check,ee,G,R-G):o(r.check,ee,G,R-G)),G=Z,(r.flags?O:c(O))!==r.check){h.msg="incorrect data check",r.mode=30;break}m=O=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;m<32;){if(E===0)break e;E--,O+=F[S++]<<m,m+=8}if(O!==(4294967295&r.total)){h.msg="incorrect length check",r.mode=30;break}m=O=0}r.mode=29;case 29:q=1;break e;case 30:q=-3;break e;case 31:return-4;case 32:default:return a}return h.next_out=R,h.avail_out=Z,h.next_in=S,h.avail_in=E,r.hold=O,r.bits=m,(r.wsize||G!==h.avail_out&&r.mode<30&&(r.mode<27||A!==4))&&K(h,h.output,h.next_out,G-h.avail_out)?(r.mode=31,-4):(V-=h.avail_in,G-=h.avail_out,h.total_in+=V,h.total_out+=G,r.total+=G,r.wrap&&G&&(h.adler=r.check=r.flags?s(r.check,ee,G,h.next_out-G):o(r.check,ee,G,h.next_out-G)),h.data_type=r.bits+(r.last?64:0)+(r.mode===12?128:0)+(r.mode===20||r.mode===15?256:0),(V==0&&G===0||A===4)&&q===p&&(q=-5),q)},x.inflateEnd=function(h){if(!h||!h.state)return a;var A=h.state;return A.window&&(A.window=null),h.state=null,p},x.inflateGetHeader=function(h,A){var r;return h&&h.state?(2&(r=h.state).wrap)==0?a:((r.head=A).done=!1,p):a},x.inflateSetDictionary=function(h,A){var r,F=A.length;return h&&h.state?(r=h.state).wrap!==0&&r.mode!==11?a:r.mode===11&&o(1,A,F,0)!==r.check?-3:K(h,A,F,F)?(r.mode=31,-4):(r.havedict=1,p):a},x.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(d,C,x){var l=d("../utils/common"),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],i=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],_=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];C.exports=function(k,w,p,a,b,n,f,c){var u,N,z,j,T,D,M,y,B,K=c.bits,h=0,A=0,r=0,F=0,ee=0,S=0,R=0,E=0,Z=0,O=0,m=null,V=0,G=new l.Buf16(16),W=new l.Buf16(16),ne=null,se=0;for(h=0;h<=15;h++)G[h]=0;for(A=0;A<a;A++)G[w[p+A]]++;for(ee=K,F=15;1<=F&&G[F]===0;F--);if(F<ee&&(ee=F),F===0)return b[n++]=20971520,b[n++]=20971520,c.bits=1,0;for(r=1;r<F&&G[r]===0;r++);for(ee<r&&(ee=r),h=E=1;h<=15;h++)if(E<<=1,(E-=G[h])<0)return-1;if(0<E&&(k===0||F!==1))return-1;for(W[1]=0,h=1;h<15;h++)W[h+1]=W[h]+G[h];for(A=0;A<a;A++)w[p+A]!==0&&(f[W[w[p+A]]++]=A);if(D=k===0?(m=ne=f,19):k===1?(m=o,V-=257,ne=s,se-=257,256):(m=i,ne=_,-1),h=r,T=n,R=A=O=0,z=-1,j=(Z=1<<(S=ee))-1,k===1&&852<Z||k===2&&592<Z)return 1;for(;;){for(M=h-R,B=f[A]<D?(y=0,f[A]):f[A]>D?(y=ne[se+f[A]],m[V+f[A]]):(y=96,0),u=1<<h-R,r=N=1<<S;b[T+(O>>R)+(N-=u)]=M<<24|y<<16|B|0,N!==0;);for(u=1<<h-1;O&u;)u>>=1;if(u!==0?(O&=u-1,O+=u):O=0,A++,--G[h]==0){if(h===F)break;h=w[p+f[A]]}if(ee<h&&(O&j)!==z){for(R===0&&(R=ee),T+=r,E=1<<(S=h-R);S+R<F&&!((E-=G[S+R])<=0);)S++,E<<=1;if(Z+=1<<S,k===1&&852<Z||k===2&&592<Z)return 1;b[z=O&j]=ee<<24|S<<16|T-n|0}}return O!==0&&(b[T+O]=h-R<<24|64<<16|0),c.bits=ee,0}},{"../utils/common":41}],51:[function(d,C,x){C.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(d,C,x){var l=d("../utils/common"),o=0,s=1;function i(g){for(var P=g.length;0<=--P;)g[P]=0}var _=0,k=29,w=256,p=w+1+k,a=30,b=19,n=2*p+1,f=15,c=16,u=7,N=256,z=16,j=17,T=18,D=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],M=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=new Array(2*(p+2));i(K);var h=new Array(2*a);i(h);var A=new Array(512);i(A);var r=new Array(256);i(r);var F=new Array(k);i(F);var ee,S,R,E=new Array(a);function Z(g,P,H,Y,U){this.static_tree=g,this.extra_bits=P,this.extra_base=H,this.elems=Y,this.max_length=U,this.has_stree=g&&g.length}function O(g,P){this.dyn_tree=g,this.max_code=0,this.stat_desc=P}function m(g){return g<256?A[g]:A[256+(g>>>7)]}function V(g,P){g.pending_buf[g.pending++]=255&P,g.pending_buf[g.pending++]=P>>>8&255}function G(g,P,H){g.bi_valid>c-H?(g.bi_buf|=P<<g.bi_valid&65535,V(g,g.bi_buf),g.bi_buf=P>>c-g.bi_valid,g.bi_valid+=H-c):(g.bi_buf|=P<<g.bi_valid&65535,g.bi_valid+=H)}function W(g,P,H){G(g,H[2*P],H[2*P+1])}function ne(g,P){for(var H=0;H|=1&g,g>>>=1,H<<=1,0<--P;);return H>>>1}function se(g,P,H){var Y,U,X=new Array(f+1),te=0;for(Y=1;Y<=f;Y++)X[Y]=te=te+H[Y-1]<<1;for(U=0;U<=P;U++){var Q=g[2*U+1];Q!==0&&(g[2*U]=ne(X[Q]++,Q))}}function ae(g){var P;for(P=0;P<p;P++)g.dyn_ltree[2*P]=0;for(P=0;P<a;P++)g.dyn_dtree[2*P]=0;for(P=0;P<b;P++)g.bl_tree[2*P]=0;g.dyn_ltree[2*N]=1,g.opt_len=g.static_len=0,g.last_lit=g.matches=0}function oe(g){8<g.bi_valid?V(g,g.bi_buf):0<g.bi_valid&&(g.pending_buf[g.pending++]=g.bi_buf),g.bi_buf=0,g.bi_valid=0}function ue(g,P,H,Y){var U=2*P,X=2*H;return g[U]<g[X]||g[U]===g[X]&&Y[P]<=Y[H]}function de(g,P,H){for(var Y=g.heap[H],U=H<<1;U<=g.heap_len&&(U<g.heap_len&&ue(P,g.heap[U+1],g.heap[U],g.depth)&&U++,!ue(P,Y,g.heap[U],g.depth));)g.heap[H]=g.heap[U],H=U,U<<=1;g.heap[H]=Y}function pe(g,P,H){var Y,U,X,te,Q=0;if(g.last_lit!==0)for(;Y=g.pending_buf[g.d_buf+2*Q]<<8|g.pending_buf[g.d_buf+2*Q+1],U=g.pending_buf[g.l_buf+Q],Q++,Y===0?W(g,U,P):(W(g,(X=r[U])+w+1,P),(te=D[X])!==0&&G(g,U-=F[X],te),W(g,X=m(--Y),H),(te=M[X])!==0&&G(g,Y-=E[X],te)),Q<g.last_lit;);W(g,N,P)}function ce(g,P){var H,Y,U,X=P.dyn_tree,te=P.stat_desc.static_tree,Q=P.stat_desc.has_stree,re=P.stat_desc.elems,le=-1;for(g.heap_len=0,g.heap_max=n,H=0;H<re;H++)X[2*H]!==0?(g.heap[++g.heap_len]=le=H,g.depth[H]=0):X[2*H+1]=0;for(;g.heap_len<2;)X[2*(U=g.heap[++g.heap_len]=le<2?++le:0)]=1,g.depth[U]=0,g.opt_len--,Q&&(g.static_len-=te[2*U+1]);for(P.max_code=le,H=g.heap_len>>1;1<=H;H--)de(g,X,H);for(U=re;H=g.heap[1],g.heap[1]=g.heap[g.heap_len--],de(g,X,1),Y=g.heap[1],g.heap[--g.heap_max]=H,g.heap[--g.heap_max]=Y,X[2*U]=X[2*H]+X[2*Y],g.depth[U]=(g.depth[H]>=g.depth[Y]?g.depth[H]:g.depth[Y])+1,X[2*H+1]=X[2*Y+1]=U,g.heap[1]=U++,de(g,X,1),2<=g.heap_len;);g.heap[--g.heap_max]=g.heap[1],(function(ie,xe){var Se,be,_e,me,Le,Ye,je=xe.dyn_tree,at=xe.max_code,kt=xe.stat_desc.static_tree,Nt=xe.stat_desc.has_stree,Ct=xe.stat_desc.extra_bits,nt=xe.stat_desc.extra_base,Te=xe.stat_desc.max_length,Fe=0;for(me=0;me<=f;me++)ie.bl_count[me]=0;for(je[2*ie.heap[ie.heap_max]+1]=0,Se=ie.heap_max+1;Se<n;Se++)Te<(me=je[2*je[2*(be=ie.heap[Se])+1]+1]+1)&&(me=Te,Fe++),je[2*be+1]=me,at<be||(ie.bl_count[me]++,Le=0,nt<=be&&(Le=Ct[be-nt]),Ye=je[2*be],ie.opt_len+=Ye*(me+Le),Nt&&(ie.static_len+=Ye*(kt[2*be+1]+Le)));if(Fe!==0){do{for(me=Te-1;ie.bl_count[me]===0;)me--;ie.bl_count[me]--,ie.bl_count[me+1]+=2,ie.bl_count[Te]--,Fe-=2}while(0<Fe);for(me=Te;me!==0;me--)for(be=ie.bl_count[me];be!==0;)at<(_e=ie.heap[--Se])||(je[2*_e+1]!==me&&(ie.opt_len+=(me-je[2*_e+1])*je[2*_e],je[2*_e+1]=me),be--)}})(g,P),se(X,le,g.bl_count)}function t(g,P,H){var Y,U,X=-1,te=P[1],Q=0,re=7,le=4;for(te===0&&(re=138,le=3),P[2*(H+1)+1]=65535,Y=0;Y<=H;Y++)U=te,te=P[2*(Y+1)+1],++Q<re&&U===te||(Q<le?g.bl_tree[2*U]+=Q:U!==0?(U!==X&&g.bl_tree[2*U]++,g.bl_tree[2*z]++):Q<=10?g.bl_tree[2*j]++:g.bl_tree[2*T]++,X=U,le=(Q=0)===te?(re=138,3):U===te?(re=6,3):(re=7,4))}function q(g,P,H){var Y,U,X=-1,te=P[1],Q=0,re=7,le=4;for(te===0&&(re=138,le=3),Y=0;Y<=H;Y++)if(U=te,te=P[2*(Y+1)+1],!(++Q<re&&U===te)){if(Q<le)for(;W(g,U,g.bl_tree),--Q!=0;);else U!==0?(U!==X&&(W(g,U,g.bl_tree),Q--),W(g,z,g.bl_tree),G(g,Q-3,2)):Q<=10?(W(g,j,g.bl_tree),G(g,Q-3,3)):(W(g,T,g.bl_tree),G(g,Q-11,7));X=U,le=(Q=0)===te?(re=138,3):U===te?(re=6,3):(re=7,4)}}i(E);var L=!1;function v(g,P,H,Y){G(g,(_<<1)+(Y?1:0),3),(function(U,X,te,Q){oe(U),V(U,te),V(U,~te),l.arraySet(U.pending_buf,U.window,X,te,U.pending),U.pending+=te})(g,P,H)}x._tr_init=function(g){L||((function(){var P,H,Y,U,X,te=new Array(f+1);for(U=Y=0;U<k-1;U++)for(F[U]=Y,P=0;P<1<<D[U];P++)r[Y++]=U;for(r[Y-1]=U,U=X=0;U<16;U++)for(E[U]=X,P=0;P<1<<M[U];P++)A[X++]=U;for(X>>=7;U<a;U++)for(E[U]=X<<7,P=0;P<1<<M[U]-7;P++)A[256+X++]=U;for(H=0;H<=f;H++)te[H]=0;for(P=0;P<=143;)K[2*P+1]=8,P++,te[8]++;for(;P<=255;)K[2*P+1]=9,P++,te[9]++;for(;P<=279;)K[2*P+1]=7,P++,te[7]++;for(;P<=287;)K[2*P+1]=8,P++,te[8]++;for(se(K,p+1,te),P=0;P<a;P++)h[2*P+1]=5,h[2*P]=ne(P,5);ee=new Z(K,D,w+1,p,f),S=new Z(h,M,0,a,f),R=new Z(new Array(0),y,0,b,u)})(),L=!0),g.l_desc=new O(g.dyn_ltree,ee),g.d_desc=new O(g.dyn_dtree,S),g.bl_desc=new O(g.bl_tree,R),g.bi_buf=0,g.bi_valid=0,ae(g)},x._tr_stored_block=v,x._tr_flush_block=function(g,P,H,Y){var U,X,te=0;0<g.level?(g.strm.data_type===2&&(g.strm.data_type=(function(Q){var re,le=4093624447;for(re=0;re<=31;re++,le>>>=1)if(1&le&&Q.dyn_ltree[2*re]!==0)return o;if(Q.dyn_ltree[18]!==0||Q.dyn_ltree[20]!==0||Q.dyn_ltree[26]!==0)return s;for(re=32;re<w;re++)if(Q.dyn_ltree[2*re]!==0)return s;return o})(g)),ce(g,g.l_desc),ce(g,g.d_desc),te=(function(Q){var re;for(t(Q,Q.dyn_ltree,Q.l_desc.max_code),t(Q,Q.dyn_dtree,Q.d_desc.max_code),ce(Q,Q.bl_desc),re=b-1;3<=re&&Q.bl_tree[2*B[re]+1]===0;re--);return Q.opt_len+=3*(re+1)+5+5+4,re})(g),U=g.opt_len+3+7>>>3,(X=g.static_len+3+7>>>3)<=U&&(U=X)):U=X=H+5,H+4<=U&&P!==-1?v(g,P,H,Y):g.strategy===4||X===U?(G(g,2+(Y?1:0),3),pe(g,K,h)):(G(g,4+(Y?1:0),3),(function(Q,re,le,ie){var xe;for(G(Q,re-257,5),G(Q,le-1,5),G(Q,ie-4,4),xe=0;xe<ie;xe++)G(Q,Q.bl_tree[2*B[xe]+1],3);q(Q,Q.dyn_ltree,re-1),q(Q,Q.dyn_dtree,le-1)})(g,g.l_desc.max_code+1,g.d_desc.max_code+1,te+1),pe(g,g.dyn_ltree,g.dyn_dtree)),ae(g),Y&&oe(g)},x._tr_tally=function(g,P,H){return g.pending_buf[g.d_buf+2*g.last_lit]=P>>>8&255,g.pending_buf[g.d_buf+2*g.last_lit+1]=255&P,g.pending_buf[g.l_buf+g.last_lit]=255&H,g.last_lit++,P===0?g.dyn_ltree[2*H]++:(g.matches++,P--,g.dyn_ltree[2*(r[H]+w+1)]++,g.dyn_dtree[2*m(P)]++),g.last_lit===g.lit_bufsize-1},x._tr_align=function(g){G(g,2,3),W(g,N,K),(function(P){P.bi_valid===16?(V(P,P.bi_buf),P.bi_buf=0,P.bi_valid=0):8<=P.bi_valid&&(P.pending_buf[P.pending++]=255&P.bi_buf,P.bi_buf>>=8,P.bi_valid-=8)})(g)}},{"../utils/common":41}],53:[function(d,C,x){C.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(d,C,x){(function(l){(function(o,s){if(!o.setImmediate){var i,_,k,w,p=1,a={},b=!1,n=o.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(o);f=f&&f.setTimeout?f:o,i={}.toString.call(o.process)==="[object process]"?function(z){process.nextTick(function(){u(z)})}:(function(){if(o.postMessage&&!o.importScripts){var z=!0,j=o.onmessage;return o.onmessage=function(){z=!1},o.postMessage("","*"),o.onmessage=j,z}})()?(w="setImmediate$"+Math.random()+"$",o.addEventListener?o.addEventListener("message",N,!1):o.attachEvent("onmessage",N),function(z){o.postMessage(w+z,"*")}):o.MessageChannel?((k=new MessageChannel).port1.onmessage=function(z){u(z.data)},function(z){k.port2.postMessage(z)}):n&&"onreadystatechange"in n.createElement("script")?(_=n.documentElement,function(z){var j=n.createElement("script");j.onreadystatechange=function(){u(z),j.onreadystatechange=null,_.removeChild(j),j=null},_.appendChild(j)}):function(z){setTimeout(u,0,z)},f.setImmediate=function(z){typeof z!="function"&&(z=new Function(""+z));for(var j=new Array(arguments.length-1),T=0;T<j.length;T++)j[T]=arguments[T+1];var D={callback:z,args:j};return a[p]=D,i(p),p++},f.clearImmediate=c}function c(z){delete a[z]}function u(z){if(b)setTimeout(u,0,z);else{var j=a[z];if(j){b=!0;try{(function(T){var D=T.callback,M=T.args;switch(M.length){case 0:D();break;case 1:D(M[0]);break;case 2:D(M[0],M[1]);break;case 3:D(M[0],M[1],M[2]);break;default:D.apply(s,M)}})(j)}finally{c(z),b=!1}}}}function N(z){z.source===o&&typeof z.data=="string"&&z.data.indexOf(w)===0&&u(+z.data.slice(w.length))}})(typeof self>"u"?l===void 0?this:l:self)}).call(this,typeof Me<"u"?Me:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Xe)),Xe.exports}var hr=ur();const mr=At(hr),qe={CHAVEIROS:["CHAVEIRO","KEYRING","MOSQUETAO","MOSQUETÃO","ARGOLA"],CANETAS:["CANETA","PEN","ESFERO"],KITS:["KIT","CONJUNTO","COMBO"],CHURRASCO:["CHURRASCO","GRELHA","ESPETO","TABUA","TÁBUA"],COZINHA:["COZINHA","COPO","TAÇA","JARRA","FACA","GARFO","COLHER"],ESCRITORIO:["ESCRITORIO","ESCRITÓRIO","CADERNO","BLOCO","AGENDA","POST-IT"],ECOLOGICOS:["ECO","BAMBU","SUSTENTAVEL","SUSTENTÁVEL"],TECNOLOGIA:["TECH","TECNOLOGIA","USB","PEN DRIVE","CARREGADOR","CABO"],MOCHILAS:["MOCHILA","BOLSA","SACO","SACOLA","BAG"],VESTUARIO:["CAMISETA","BONÉ","BONE","COLETE","JAQUETA","MOLETOM"],COPOS_E_GARRAFAS:["COPO","COPO S","COPO DE","COPOS","GARRAFA","GARRAFAS","SQUEEZE","GARRAFA TERMICA","TUMBLER","TAÇA","MUG","CANUDO","VIDRO","BAMBU","INOX","ACRILICO","ACRÍLICO","PLASTICO","PLÁSTICO"]},Ve=I=>I.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toUpperCase();function ye(I){return Ve(I).toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")}function jt(I){return I?I.replace(/[-_]+/g," ").trim().toUpperCase():""}function Ge(I,$=[]){const d=new Map;return $.forEach(C=>{if(!C)return;const x=ye(C);d.has(x)||d.set(x,C)}),Object.entries(I).forEach(([C,x])=>{C.toLowerCase()!=="geral"&&x?.length&&(d.has(C)||d.set(C,jt(C)))}),Array.from(d.values())}function fr(I,$){const d=Ve(`${I.nome||""} ${I.descricao||""}`),C={};return $.forEach(l=>{const o=Ve(l),s=o.replace(/\s+/g,""),i=o.replace(/\s+/g,"_"),_=qe[o]||qe[i]||qe[s]||qe[s.replace(/_/g,"")]||[];let k=0;_.forEach(w=>{const p=Ve(w);d.includes(p)&&(k+=2)}),k>0&&(C[l]=k)}),{categorias:Object.entries(C).filter(([,l])=>l>=2).sort((l,o)=>o[1]-l[1]).slice(0,3).map(([l])=>l),categoryScores:C}}function pr(I){const $=I.colors||[];if(!$.length)return;const d=$.map(x=>({label:x,slug:ye(x)})),C=d.find(x=>x.slug.includes("preto"));return C?C.slug:d[0]?.slug}function gr(I){const $=I.selectedByColor||{},d=new Set;I.coverPath&&d.add(I.coverPath),Object.entries(I.imagesByColor).forEach(([i,_])=>{const k=Array.isArray(_)?_:[],w=$[i]||k[0]?.path;w&&d.add(w)});const C={};Object.entries(I.imagesByColor).forEach(([i,_])=>{const k=Array.isArray(_)?_:[],w=k.filter(a=>d.has(a.path));k.filter(a=>!d.has(a.path)).forEach(a=>URL.revokeObjectURL(a.previewUrl)),w.length&&(C[i]=w)});const x={};Object.entries($).forEach(([i,_])=>{d.has(_)&&(x[i]=_)}),Object.entries(C).forEach(([i,_])=>{!x[i]&&_[0]&&(x[i]=_[0].path)});let l=I.coverPath&&d.has(I.coverPath)?I.coverPath:void 0;if(!l){const i=Array.from(d)[0];i&&(l=i)}const o=Ge(C,I.colors),s=I.mainColor||pr(I);return{...I,imagesByColor:C,selectedByColor:Object.keys(x).length?x:void 0,coverPath:l,colors:o,mainColor:s}}function we(I){const $=[],d=[],C=Object.values(I.imagesByColor).flat();C.length||$.push("Sem imagens");const x=I.colors||[],l=I.selectedByColor||{};return x.forEach(s=>{const i=ye(s),_=Array.isArray(I.imagesByColor[i])?I.imagesByColor[i]:[],k=l[i],w=k&&_.some(p=>p.path===k);(!_.length||!w)&&$.push(`Cor sem imagem (${s})`)}),I.coverPath&&C.some(s=>s.path===I.coverPath)||$.push("Sem capa"),(!I.nome||I.nome.trim().length<3)&&$.push("Nome curto"),I.categorias?.length||d.push("Sem categorias"),(!I.descricao||I.descricao.trim().length<20)&&d.push("Descrição curta"),{critical:Array.from(new Set($)),warnings:Array.from(new Set(d))}}function mt(I,$){const d={...I};if(!d.categorias||d.categorias.length===0){const{categorias:x,categoryScores:l}=fr(d,$);d.categorias=x,d.categoryScores=l}const C=we(d);return{...d,validation:C,errors:[...C.critical,...C.warnings]}}function xr(I){I&&URL.revokeObjectURL(I)}function br(I){return{path:`local:${typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():Date.now()}`,file:I,previewUrl:URL.createObjectURL(I)}}function yr({draft:I,onClose:$,onSave:d}){const[C,x]=J.useState(I),[l,o]=J.useState(""),[s,i]=J.useState(""),[_,k]=J.useState(null),{data:w=[]}=Ue();J.useEffect(()=>{x(I),o(""),i(""),k(null)},[I]);const p=J.useMemo(()=>C?(C.colors||[]).map(y=>({label:y,slug:ye(y)})):[],[C]),a=J.useMemo(()=>{if(!C)return[];const y=new Set;return p.forEach(B=>y.add(B.slug)),Object.keys(C.imagesByColor||{}).forEach(B=>{B!=="geral"&&y.add(B)}),Array.from(y)},[C,p]),b=J.useMemo(()=>C?we(C):{critical:[],warnings:[]},[C]);if(!I||!C)return null;const n=y=>p.find(B=>B.slug===y)?.label||y.replace(/[-_]+/g," ").toUpperCase(),f=(y,B)=>B&&y.some(K=>ye(K)===B)?B:y[0]?ye(y[0]):void 0,c=y=>{x(B=>{if(!B)return B;const h=B.categorias.includes(y)?B.categorias.filter(A=>A!==y):[...B.categorias,y];return{...B,categorias:h}})},u=()=>{if(!C)return;const y=l.trim();if(!y)return;const B=y.toUpperCase(),K=ye(B),h=a.includes(K);if(!K||h){i("Cor jÃ¡ existe ou invÃ¡lida");return}i(""),x(A=>{if(!A)return A;const r={...A.imagesByColor};r[K]=r[K]||[];const F=[...A.colors,B],ee=f(F,A.mainColor);return{...A,colors:F,imagesByColor:r,selectedByColor:{...A.selectedByColor||{}},mainColor:ee}}),o("")},N=(y,B)=>{y.preventDefault();const K=Array.from(y.dataTransfer.files||[]).filter(h=>h.type.startsWith("image/"));if(K.length){const h=K.map(br);x(A=>{if(!A)return A;const r=A.imagesByColor[B]||[],F=[...r,...h],ee={...A.imagesByColor,[B]:F},S={...A.selectedByColor||{}};!S[B]&&F[0]&&(S[B]=F[0].path);const R=A.coverPath||h[0]?.path||(A.coverPath&&r.some(O=>O.path===A.coverPath)?A.coverPath:void 0),E=B==="geral"?A.colors:Ge(ee,A.colors),Z=f(E,A.mainColor);return{...A,imagesByColor:ee,selectedByColor:Object.keys(S).length?S:void 0,coverPath:R,colors:E,mainColor:Z}})}else _&&_.fromColor!==B&&z(_.path,_.fromColor,B);k(null)},z=(y,B,K)=>{x(h=>{if(!h)return h;const A=h.imagesByColor[B]||[],r=A.find(E=>E.path===y);if(!r)return h;const F=A.filter(E=>E.path!==y),ee=h.imagesByColor[K]||[],S={...h.imagesByColor,[B]:F,[K]:[...ee,r]};F.length||delete S[B];const R={...h.selectedByColor||{}};return R[B]===y&&(F[0]?R[B]=F[0].path:delete R[B]),R[K]||(R[K]=y),{...h,imagesByColor:S,selectedByColor:Object.keys(R).length?R:void 0}})},j=(y,B)=>{x(K=>{if(!K)return K;const h=K.imagesByColor[y]||[],A=h.find(O=>O.path===B),r=h.filter(O=>O.path!==B),F={...K.imagesByColor};r.length?F[y]=r:delete F[y];const ee={...K.selectedByColor||{}};ee[y]===B&&(r[0]?ee[y]=r[0].path:delete ee[y]);const S=Object.values(F).flat(),R=K.coverPath&&K.coverPath!==B?K.coverPath:S[0]?.path||void 0,E=Ge(F,K.colors),Z=f(E,K.mainColor);return xr(A?.previewUrl),{...K,imagesByColor:F,selectedByColor:Object.keys(ee).length?ee:void 0,coverPath:R,colors:E,mainColor:Z}})},T=(y,B)=>{x(K=>{if(!K)return K;const h={...K.selectedByColor||{}};return h[y]=B,{...K,selectedByColor:h}})},D=(y,B)=>{x(K=>{if(!K)return K;const h=y!=="geral"?y:K.mainColor;return{...K,coverPath:B,mainColor:h}})},M=()=>{if(!C)return;const y=Ge(C.imagesByColor,C.colors),B=f(y,C.mainColor),K={...C,colors:y,mainColor:B},h=gr(K),A=we(h);d({...h,status:"draft",validation:A,errors:[...A.critical,...A.warnings]})};return e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-5xl w-full max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b sticky top-0 bg-white z-10",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Revisar produto importado"}),e.jsx("h2",{className:"text-xl font-title font-bold",children:C.nome||C.id})]}),e.jsx("button",{onClick:()=>{$()},className:"p-2 rounded-full hover:bg-gray-100","aria-label":"Fechar",children:e.jsx(ve,{size:20})})]}),e.jsxs("div",{className:"overflow-y-auto max-h-[80vh] p-6 space-y-6",children:[(b.critical.length>0||b.warnings.length>0)&&e.jsxs("div",{className:"flex flex-wrap gap-2 items-center text-sm",children:[e.jsx(bt,{className:"text-amber-500",size:18}),b.critical.map(y=>e.jsx("span",{className:"px-3 py-1 rounded-full bg-red-50 text-red-700 border border-red-200",children:y},`c-${y}`)),b.warnings.map(y=>e.jsx("span",{className:"px-3 py-1 rounded-full bg-amber-50 text-amber-700 border border-amber-200",children:y},`w-${y}`))]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Nome"}),e.jsx("input",{type:"text",value:C.nome,onChange:y=>x(B=>B&&{...B,nome:y.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"ID/SKU"}),e.jsx("input",{type:"text",value:C.id,disabled:!0,className:"w-full px-4 py-2 border border-gray-200 rounded-lg bg-gray-50 text-gray-500 cursor-not-allowed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"DescriÃ§Ã£o"}),e.jsx("textarea",{value:C.descricao,onChange:y=>x(B=>B&&{...B,descricao:y.target.value}),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Categorias"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:w.map(y=>e.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100 border border-gray-200",children:[e.jsx("input",{type:"checkbox",checked:C.categorias.includes(y.nome),onChange:()=>c(y.nome),className:"rounded"}),e.jsx("span",{className:"text-sm",children:y.nome})]},y.id))}),C.categoryScores&&e.jsxs("div",{className:"mt-2 text-xs text-gray-600 space-y-1 bg-gray-50 border border-gray-200 rounded-lg p-3",children:[e.jsx("p",{className:"font-semibold text-gray-700",children:"Motivo da categoria"}),Object.entries(C.categoryScores).filter(([,y])=>y>0).sort((y,B)=>B[1]-y[1]).map(([y,B])=>e.jsxs("p",{children:[y,": score ",B]},y))]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:C.destaque,onChange:y=>x(B=>B&&{...B,destaque:y.target.checked}),className:"rounded"}),e.jsx("span",{className:"text-sm font-semibold",children:"Produto em destaque"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-semibold",children:"Cor principal"}),e.jsxs("select",{value:C.mainColor||"",onChange:y=>x(B=>B&&{...B,mainColor:y.target.value||void 0}),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-primary",children:[e.jsx("option",{value:"",children:"Usar imagem geral"}),p.map(y=>e.jsx("option",{value:y.slug,children:y.label},y.slug))]})]})]}),e.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-semibold",children:"Cores"}),s&&e.jsx("span",{className:"text-xs text-red-500",children:s})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("input",{type:"text",value:l,onChange:y=>o(y.target.value),placeholder:"Nova cor (ex: VERMELHO)",className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-primary"}),e.jsxs("button",{type:"button",onClick:u,className:"px-3 py-2 rounded-lg bg-primary text-white text-sm font-semibold flex items-center gap-2 hover:opacity-90",children:[e.jsx(st,{size:16}),"Adicionar cor"]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",onDragOver:y=>y.preventDefault(),onDrop:y=>N(y,"geral"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm font-semibold",children:"Imagens gerais"}),C.coverPath&&C.imagesByColor.geral?.some(y=>y.path===C.coverPath)&&e.jsx("span",{className:"text-xs bg-primary text-white px-2 py-1 rounded-full",children:"Capa"})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:(C.imagesByColor.geral||[]).map((y,B)=>e.jsxs("div",{draggable:!0,onDragStart:()=>k({path:y.path,fromColor:"geral"}),onDragEnd:()=>k(null),className:"relative aspect-square bg-gray-50 rounded-lg overflow-hidden border",children:[e.jsx("img",{src:y.previewUrl,alt:`geral-${B}`,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 flex flex-col justify-between p-2 pointer-events-none",children:C.coverPath===y.path&&e.jsx("span",{className:"self-start text-[11px] bg-primary text-white px-2 py-1 rounded-full",children:"Capa"})}),e.jsxs("div",{className:"absolute bottom-2 left-2 right-2 flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>D("geral",y.path),className:"flex-1 bg-white/80 hover:bg-white text-xs rounded px-2 py-1",children:"Definir como capa"}),e.jsx("button",{type:"button",onClick:()=>j("geral",y.path),className:"bg-white/80 hover:bg-white text-red-600 p-1 rounded","aria-label":"Remover imagem",children:e.jsx(Pe,{size:14})})]})]},`${y.path}-${B}`))}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Solte imagens aqui para adicionar ao geral."})]}),a.map(y=>{const B=C.imagesByColor[y]||[],K=C.selectedByColor?.[y],h=n(y),A=C.mainColor===y;return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",onDragOver:r=>r.preventDefault(),onDrop:r=>N(r,y),children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-sm font-semibold capitalize",children:`Cor: ${h}`}),A&&e.jsx("span",{className:"text-xs bg-primary text-white px-2 py-1 rounded-full",children:"Principal"}),C.coverPath&&B.some(r=>r.path===C.coverPath)&&e.jsx("span",{className:"text-xs bg-primary text-white px-2 py-1 rounded-full",children:"Capa"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer",children:[e.jsx("input",{type:"radio",name:"main-color",checked:C.mainColor===y,onChange:()=>x(r=>r&&{...r,mainColor:y})}),"Usar como principal"]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:[B.map((r,F)=>e.jsxs("div",{draggable:!0,onDragStart:()=>k({path:r.path,fromColor:y}),onDragEnd:()=>k(null),className:`relative aspect-square bg-gray-50 rounded-lg overflow-hidden border ${K===r.path?"border-primary":""}`,children:[e.jsx("img",{src:r.previewUrl,alt:`${y}-${F}`,className:"w-full h-full object-cover"}),e.jsxs("div",{className:"absolute inset-0 flex flex-col justify-between p-2 pointer-events-none",children:[K===r.path&&e.jsx("span",{className:"self-start text-[11px] bg-primary text-white px-2 py-1 rounded-full",children:"Usada na cor"}),C.coverPath===r.path&&e.jsx("span",{className:"self-end text-[11px] bg-primary text-white px-2 py-1 rounded-full",children:"Capa"})]}),e.jsxs("div",{className:"absolute bottom-2 left-2 right-2 flex flex-col gap-1",children:[e.jsx("button",{type:"button",onClick:()=>T(y,r.path),className:"bg-white/80 hover:bg-white text-xs rounded px-2 py-1",children:"Usar para esta cor"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>D(y,r.path),className:"flex-1 bg-white/80 hover:bg-white text-xs rounded px-2 py-1",children:"Definir como capa"}),e.jsx("button",{type:"button",onClick:()=>j(y,r.path),className:"bg-white/80 hover:bg-white text-red-600 p-1 rounded","aria-label":"Remover imagem",children:e.jsx(Pe,{size:14})})]})]})]},`${r.path}-${F}`)),!B.length&&e.jsx("div",{className:"col-span-full text-xs text-gray-500",children:"Solte imagens aqui para esta cor."})]})]},y)})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 px-6 py-4 border-t bg-gray-50",children:[e.jsx("button",{onClick:$,className:"px-4 py-2 rounded-lg border border-gray-300 hover:bg-white",type:"button",children:"Cancelar"}),e.jsx("button",{onClick:M,className:"px-4 py-2 rounded-lg bg-primary text-white font-semibold hover:opacity-90",type:"button",children:"Salvar alteraÃ§Ãµes"})]})]})})}const vr={jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",webp:"image/webp"};async function wr(I){const $=await I.async("blob"),d=I.name.split(".").pop()?.toLowerCase()||"jpg",C=I.name.split("/").pop()||`image.${d}`,x=vr[d]||$.type||"image/jpeg",l=new File([$],C,{type:x});return{path:I.name,file:l,previewUrl:URL.createObjectURL(l)}}function De(I,$){if($)for(const d of Object.values(I.imagesByColor)){const C=d?.find(x=>x.path===$);if(C)return C}}function _r(I){const $=De(I,I.coverPath);if($)return $.previewUrl;const d=I.imagesByColor.geral?.[0]?.previewUrl;if(d)return d;const C=Object.keys(I.imagesByColor).find(x=>x!=="geral");if(C)return I.imagesByColor[C]?.[0]?.previewUrl}function Je(I){Object.values(I.imagesByColor).forEach($=>{$?.forEach(d=>{URL.revokeObjectURL(d.previewUrl)})})}function Ie(I){const $=we(I);return{...I,validation:$,errors:[...$.critical,...$.warnings]}}function jr(I){return/^[A-Za-z0-9_ -]+$/.test(I)&&!I.includes(".")}function kr(){const[I,$]=J.useState([]),[d,C]=J.useState(null),[x,l]=J.useState(!1),[o,s]=J.useState(""),[i,_]=J.useState(!1),[k,w]=J.useState({current:0,total:0}),[p,a]=J.useState([]),[b,n]=J.useState(!1),[f,c]=J.useState({processed:0,pending:0}),[u,N]=J.useState(!1),[z,j]=J.useState([]),T=pt(),{data:D=[]}=Ue(),M=J.useMemo(()=>D.map(m=>m.nome),[D]),y=async m=>{if(m){l(!0),s(""),I.forEach(Je),$([]),C(null),a([]),n(!1);try{const V=await mr.loadAsync(m),G=new Set;V.forEach(ce=>{if(!ce.includes("/"))return;const[t]=ce.split("/");!t||t.startsWith("__MACOSX")||jr(t)&&G.add(t)});const W=[],ne=new Set,se=[];for(const ce of Array.from(G)){const t=ce.toUpperCase();if(ne.has(t)){W.push({id:t,reason:"duplicate_in_zip"});continue}ne.add(t),se.push({raw:ce,normalized:t})}const ae=await Promise.all(se.map(({normalized:ce})=>Be(ge(fe,"produtos",ce)))),oe=new Set;ae.forEach((ce,t)=>{if(ce.exists()){const q=se[t].normalized;oe.add(q),W.push({id:q,reason:"already_exists"})}});const ue=[];for(const{raw:ce,normalized:t}of se){if(oe.has(t))continue;const q=V.file(`${ce}/meta.json`);let L={};if(q)try{const re=await q.async("string");L=JSON.parse(re)}catch(re){console.warn(`N�o foi poss�vel ler meta.json de ${t}`,re)}const v={},g=V.file(new RegExp(`^${ce}/images/[^/]+/[^/]+\\.(jpe?g|png|webp)$`,"i"));for(const re of g){const le=re.name.split("/"),ie=le[le.length-2]||"",xe=ie?ye(ie):"geral",Se=xe==="geral";if(ie.startsWith("_"))continue;const _e=Se?"geral":xe,me=await wr(re);v[_e]||(v[_e]=[]),v[_e].push(me)}const P=L.colors||L.cores||[],H=Object.keys(v).filter(re=>re!=="geral"),Y=P.length>0?P:H.map(re=>jt(re)),U={};H.forEach(re=>{const le=v[re]?.[0];le&&(U[re]=le.path)});const X=v.geral?.[0]?.path||Object.values(U)[0]||Object.values(v).flat()[0]?.path,te=L.mainColor?ye(L.mainColor):H.find(re=>re.includes("preto"))||H[0],Q={id:t,nome:L.name??L.nome??t,descricao:L.description??L.descricao??"",categorias:Array.isArray(L.categorias)?L.categorias:[],destaque:!!L.destaque,colors:Y,imagesByColor:v,selectedByColor:Object.keys(U).length?U:void 0,coverPath:X,mainColor:H.length?te:void 0,status:"draft"};ue.push(Ie(Q))}const pe=(u&&M.length?ue.map(ce=>mt(ce,M)):ue).map(Ie);$(pe),a(W),c({processed:u?pe.length:0,pending:u?pe.filter(ce=>ce.validation?.critical.length).length:0}),pe.length||s("Nenhum produto encontrado no ZIP.")}catch(V){console.error(V),s("N�o foi poss�vel ler o ZIP. Confira o formato e tente novamente.")}finally{l(!1)}}},B=()=>{I.forEach(Je),$([]),C(null),s(""),w({current:0,total:0}),a([]),n(!1),c({processed:0,pending:0})},K=(m,V)=>{$(G=>G.map(W=>{if(W.id!==m)return W;const ne=new Set(W.categorias||[]);ne.has(V)?ne.delete(V):ne.add(V);const se=Array.from(ne);return Ie({...W,categorias:se,status:W.status==="saved"?"draft":W.status})}))},h=m=>{j(V=>{const G=new Set(V);return G.has(m)?G.delete(m):G.add(m),Array.from(G)})},A=m=>{const V=m.validation?m:Ie(m);$(G=>G.map(W=>W.id===m.id?{...V}:W)),C(null)},r=m=>{const V=I.find(G=>G.id===m);V&&Je(V),$(G=>G.filter(W=>W.id!==m))},F=()=>{z.length&&$(m=>m.map(V=>{const G=Array.from(new Set([...V.categorias||[],...z]));return Ie({...V,categorias:G,status:V.status==="saved"?"draft":V.status})}))},ee=()=>{let m=0,V=0;$(G=>G.map(W=>{if(W.status!=="draft")return W;m+=1;const ne=mt(W,M),se=Ie(ne);return se.validation?.critical.length&&(V+=1),se})),c({processed:m,pending:V})},S=J.useCallback(async m=>{const V=we(m);if(V.critical.length)throw new Error(V.critical.join(" | "));const G=new Map,W=async(t,q)=>{if(G.has(t.path))return G.get(t.path);const L=await Ce(t.file,q);return G.set(t.path,L),L},ne=t=>{const q=m.selectedByColor?.[t];if(q){const v=De(m,q);if(v)return v}return m.imagesByColor[t]?.[0]},se=(m.colors||[]).map(t=>({label:t,slug:ye(t)})),ae=De(m,m.coverPath)||De(m,m.imagesByColor.geral?.[0]?.path)||De(m,ne(se[0]?.slug)?.path);if(!ae)throw new Error("Nenhuma imagem dispon�vel para usar como capa.");const oe=[],ue=[],de=await W(ae,{folder:`produtos/${m.id}`,productId:m.id,type:"main"});oe.push(de);for(const{label:t,slug:q}of se){const L=ne(q);if(!L)continue;const v=await W(L,{folder:`produtos/${m.id}/variacoes`,productId:m.id,variation:q,type:"variation"});ue.push({cor:t,imagem_url:v,thumb_url:v}),oe.push(v)}const pe=Array.from(new Set(oe)),ce={id:m.id,nome:m.nome,descricao:m.descricao,categorias:m.categorias,destaque:m.destaque,variacoes:ue,imagem_url:de,thumb_url:de,imagens_urls:pe,thumbs_urls:pe,createdAt:ft()};await ze(ge(Oe(fe,"produtos"),m.id),ce)},[]),R=async m=>{const V=we(m);$(G=>G.map(W=>W.id===m.id?{...W,status:"saving",validation:V,errors:[...V.critical,...V.warnings]}:W));try{await S(m),$(G=>G.map(W=>W.id===m.id?{...W,status:"saved",errors:[],validation:{critical:[],warnings:[]}}:W)),await T.invalidateQueries({queryKey:["admin-products"]})}catch(G){const W=G instanceof Error?G.message:"Erro ao salvar produto";throw $(ne=>ne.map(se=>se.id===m.id?{...se,status:"error",errors:[W]}:se)),G}},E=async()=>{const m=I.filter(V=>((V.validation||we(V)).critical?.length??0)===0);if(m.length){_(!0),w({current:0,total:m.length});for(let V=0;V<m.length;V++){const G=m[V];try{await R(G)}catch{}finally{w({current:V+1,total:m.length})}}_(!1)}},Z=J.useMemo(()=>I.filter(m=>((m.validation||we(m)).critical?.length??0)===0).length,[I]),O={onDragOver:m=>m.preventDefault(),onDrop:m=>{m.preventDefault();const V=m.dataTransfer.files?.[0];V&&V.name.toLowerCase().endsWith(".zip")&&y(V)}};return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 space-y-5",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Importar lote via ZIP"}),e.jsx("h2",{className:"text-xl font-title font-bold",children:"Product ZIP Importer"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Formato esperado: ","{ID}/meta.json",", imagens em geral/ e ","{cor}","/."]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{type:"button",onClick:B,className:"px-3 py-2 rounded-lg border border-gray-300 text-sm flex items-center gap-2 hover:bg-gray-50",children:[e.jsx(dt,{size:16}),"Limpar importa��o"]}),e.jsxs("label",{className:"px-3 py-2 rounded-lg bg-primary text-white text-sm font-semibold flex items-center gap-2 cursor-pointer hover:opacity-90",children:[e.jsx(Kt,{size:16}),"Selecionar ZIP",e.jsx("input",{type:"file",accept:".zip",className:"hidden",onChange:m=>y(m.target.files?.[0]||null)})]})]})]}),e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 bg-gray-50 text-center hover:border-primary transition-colors",...O,children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(Ft,{className:"text-gray-400",size:32}),e.jsx("p",{className:"text-sm text-gray-600",children:'Arraste um arquivo .zip aqui ou clique em "Selecionar ZIP"'}),x&&e.jsxs("div",{className:"flex items-center gap-2 text-primary text-sm",children:[e.jsx(ke,{className:"animate-spin",size:16}),"Lendo ZIP..."]})]})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm text-gray-700",children:[e.jsxs("span",{className:"font-semibold",children:[I.length," produtos carregados"]}),e.jsxs("span",{children:[p.length," ignorados"]}),p.length>0&&e.jsx("button",{type:"button",onClick:()=>n(m=>!m),className:"text-primary underline underline-offset-2",children:b?"Ocultar ignorados":"Ver ignorados"})]}),b&&p.length>0&&e.jsx("div",{className:"border border-amber-200 bg-amber-50 rounded-lg p-3 text-sm text-amber-800 space-y-2",children:p.map(m=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-semibold",children:m.id}),e.jsx("span",{className:"text-xs uppercase tracking-wide",children:m.reason==="duplicate_in_zip"?"duplicate_in_zip":"already_exists"})]},`${m.id}-${m.reason}`))}),o&&e.jsx("p",{className:"text-sm text-red-600",children:o}),I.length>0&&e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(lt,{size:16}),Z," prontos � ",I.length," carregados",f.processed>0&&e.jsxs("span",{className:"text-xs text-gray-500",children:["Auto-preenchidos: ",f.processed," (pendentes: ",f.pending,")"]})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap items-center",children:[e.jsxs("button",{type:"button",onClick:ee,title:"Seleciona categorias, capa, cor principal e 1 foto por cor automaticamente",className:"px-3 py-2 rounded-lg bg-blue-600 text-white text-sm font-semibold flex items-center gap-2 hover:opacity-90",children:[e.jsx(dt,{size:16}),"Auto-preencher tudo"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:u,onChange:m=>N(m.target.checked),className:"rounded"}),"Modo turbo (auto ap�s import)"]}),e.jsxs("button",{type:"button",onClick:E,disabled:i||Z===0,className:"px-3 py-2 rounded-lg bg-green-600 text-white text-sm font-semibold flex items-center gap-2 disabled:opacity-50 hover:opacity-90",children:[i?e.jsx(ke,{className:"animate-spin",size:16}):e.jsx(Ke,{size:16}),"Salvar todos v�lidos",i&&e.jsxs("span",{className:"text-xs bg-white/20 rounded px-2 py-1",children:[k.current,"/",k.total]})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-3 text-sm text-gray-700",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"font-semibold",children:"Aplicar categorias a todos:"}),e.jsx("div",{className:"flex flex-wrap gap-2 max-h-28 overflow-auto border border-gray-200 rounded p-2 bg-white",children:M.map(m=>{const V=z.includes(m);return e.jsxs("label",{className:`flex items-center gap-1 text-[11px] px-2 py-1 rounded border ${V?"border-primary bg-primary/5 text-primary":"border-gray-200 text-gray-700 bg-white"}`,children:[e.jsx("input",{type:"checkbox",checked:V,onChange:()=>h(m),className:"rounded"}),m]},m)})})]}),e.jsxs("button",{type:"button",onClick:F,disabled:!z.length,className:"px-3 py-2 rounded-lg bg-indigo-600 text-white text-sm font-semibold flex items-center gap-2 disabled:opacity-50 hover:opacity-90",children:[e.jsx(lt,{size:16}),"Aplicar categorias em massa"]})]}),e.jsx("div",{className:"grid md:grid-cols-2 xl:grid-cols-3 gap-4",children:I.map(m=>{const V=_r(m),G=m.validation||we(m),W=(G.critical?.length??0)>0,ne=(G.warnings?.length??0)>0;return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 flex flex-col gap-3 bg-gray-50",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-20 h-20 bg-white rounded-lg border flex items-center justify-center overflow-hidden",children:V?e.jsx("img",{src:V,alt:m.nome,className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-xs text-gray-400 text-center px-2",children:"Sem imagem"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:m.nome||m.id}),m.status==="saved"&&e.jsxs("span",{className:"flex items-center gap-1 text-xs text-green-700 bg-green-50 border border-green-200 px-2 py-1 rounded-full",children:[e.jsx(it,{size:14}),"Salvo"]}),m.status==="saving"&&e.jsxs("span",{className:"flex items-center gap-1 text-xs text-blue-700 bg-blue-50 border border-blue-200 px-2 py-1 rounded-full",children:[e.jsx(ke,{className:"animate-spin",size:14}),"Salvando..."]}),m.status==="error"&&e.jsxs("span",{className:"flex items-center gap-1 text-xs text-red-700 bg-red-50 border border-red-200 px-2 py-1 rounded-full",children:[e.jsx(bt,{size:14}),"Erro"]}),!W&&m.status==="draft"&&e.jsxs("span",{className:"flex items-center gap-1 text-xs text-green-700 bg-green-50 border border-green-200 px-2 py-1 rounded-full",children:[e.jsx(it,{size:14}),"Pronto"]})]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["SKU: ",m.id]}),e.jsx("div",{className:"flex gap-2 flex-wrap mt-1",children:(m.colors||[]).map(se=>{const ae=ye(se);return e.jsx("span",{className:`text-[11px] px-2 py-1 rounded-full border ${m.mainColor===ae?"border-primary text-primary bg-primary/5":"border-gray-200 text-gray-600 bg-white"}`,children:se},se)})}),m.categorias?.length?e.jsx("div",{className:"flex gap-2 flex-wrap mt-1",children:m.categorias.map(se=>e.jsx("span",{className:"text-[11px] px-2 py-1 rounded-full border border-gray-200 text-gray-700 bg-white",children:se},se))}):null,M.length>0&&e.jsxs("div",{className:"flex flex-col gap-2 mt-2 text-xs",children:[e.jsx("p",{className:"text-gray-600",children:"Categorias (selecione quantas precisar):"}),e.jsx("div",{className:"flex flex-wrap gap-2 max-h-28 overflow-auto border border-gray-200 rounded p-2 bg-white",children:M.map(se=>{const ae=(m.categorias||[]).includes(se);return e.jsxs("label",{className:`flex items-center gap-1 text-[11px] px-2 py-1 rounded border ${ae?"border-primary bg-primary/5 text-primary":"border-gray-200 text-gray-700 bg-white"}`,children:[e.jsx("input",{type:"checkbox",checked:ae,onChange:()=>K(m.id,se),className:"rounded"}),se]},se)})})]})]})]}),(W||ne)&&e.jsxs("div",{className:"flex flex-wrap gap-1",children:[G.critical?.map(se=>e.jsx("span",{className:"text-[11px] px-2 py-1 bg-red-50 border border-red-200 text-red-700 rounded-full",children:se},`c-${se}`)),G.warnings?.map(se=>e.jsx("span",{className:"text-[11px] px-2 py-1 bg-amber-50 border border-amber-200 text-amber-700 rounded-full",children:se},`w-${se}`))]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>C(m),className:"px-3 py-2 rounded-lg border border-gray-300 text-sm flex items-center gap-2 hover:bg-white",children:[e.jsx(vt,{size:16}),"Editar"]}),e.jsxs("button",{type:"button",onClick:()=>R(m),disabled:m.status==="saving",className:"px-3 py-2 rounded-lg bg-primary text-white text-sm font-semibold flex items-center gap-2 disabled:opacity-50 hover:opacity-90",children:[m.status==="saving"?e.jsx(ke,{className:"animate-spin",size:16}):e.jsx(Ke,{size:16}),"Salvar"]}),e.jsxs("button",{type:"button",onClick:()=>r(m.id),className:"px-3 py-2 rounded-lg border border-red-200 text-red-600 text-sm flex items-center gap-2 hover:bg-red-50",children:[e.jsx(Pe,{size:16}),"Remover"]})]})]},m.id)})})]}),d&&e.jsx(yr,{draft:d,onClose:()=>C(null),onSave:m=>{const V=we(m);A({...m,validation:V,errors:[...V.critical,...V.warnings],status:"draft"})}})]})}function Pr(){const[I,$]=J.useState("products"),[d,C]=J.useState(!1),x=async()=>{await Et(zt)},l=[{id:"products",label:"Produtos",icon:We},{id:"categories",label:"Categorias",icon:Dt},{id:"landing",label:"Página Inicial",icon:Zt},{id:"config",label:"Configurações",icon:wt}];return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-40",children:e.jsxs("div",{className:"container mx-auto px-4 py-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-title font-bold",children:"Painel Admin"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>C(!d),className:"lg:hidden p-2 hover:bg-gray-100 rounded-lg",children:d?e.jsx(ve,{size:24}):e.jsx(Vt,{size:24})}),e.jsxs("button",{onClick:x,className:"hidden sm:flex items-center gap-2 bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg font-semibold transition-colors",children:[e.jsx(ct,{size:18}),e.jsx("span",{className:"hidden sm:inline",children:"Sair"})]}),e.jsx("button",{onClick:x,className:"sm:hidden p-2 text-red-500 hover:bg-red-50 rounded-lg",children:e.jsx(ct,{size:20})})]})]}),e.jsx("nav",{className:`${d?"block":"hidden"} lg:block mt-4 lg:mt-0`,children:e.jsx("div",{className:"flex flex-col lg:flex-row gap-2 lg:gap-4 lg:mt-4",children:l.map(o=>{const s=o.icon;return e.jsxs("button",{onClick:()=>{$(o.id),C(!1)},className:`flex items-center gap-3 px-4 py-3 lg:py-2 rounded-lg font-semibold transition-all ${I===o.id?"bg-primary text-white shadow-md":"bg-white text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(s,{size:20}),e.jsx("span",{children:o.label})]},o.id)})})})]})}),e.jsxs("main",{className:"container mx-auto px-4 py-6 lg:py-8",children:[I==="products"&&e.jsxs("div",{className:"space-y-6 lg:space-y-8",children:[e.jsx(kr,{}),e.jsx(rr,{}),e.jsx(ar,{})]}),I==="categories"&&e.jsx(ir,{}),I==="landing"&&e.jsx(cr,{}),I==="config"&&e.jsx(lr,{})]})]})}export{Pr as default};
